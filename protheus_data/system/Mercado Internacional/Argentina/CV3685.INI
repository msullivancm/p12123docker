?{"Nombre del archivo INI","CV3685.INI"}
?{"Descripcion Completa del Archivo Magnetico","Archivo utilizado la interface con el aplicativo de Régimen de información"}
?{"Comentarios","Compras y ventas según RG 3685-14"} 
 
[XXX Inicializacao]
(PRE) _aTotal[01] := MV_PAR01
(PRE) _aTotal[02] := MV_PAR02
(PRE) _aTotal[03] := {}
(PRE) _aTotal[04] := {}
(PRE) _aTotal[05] := .F.
(PRE) _aTotal[06] := {}
(PRE) _aTotal[07] := .T.
(PRE) _aTotal[08] := MV_PAR06

[XXX Creación del CFP Utilizado por la rutina - PRINCIPAL]
(PRE) aAdd(_aTotal[03],"Compras y ventas según RG 3685-14")
(PRE) aAdd(_aTotal[03],"")
(PRE) aAdd(_aTotal[03],"Llene correctamente las informaciones solicitadas.")
(PRE) aAdd(_aTotal[03],"Informaciones necesarias para la generacion del archivo magnetico Compras y Ventas.")

[XXX Painel  - Configuraciones Generales]
(PRE) aAdd(_aTotal[04],{})
(PRE) aAdd(_aTotal[04][1],"Compras y Ventas")
(PRE) aAdd(_aTotal[04][1],"Configuraciones generales:")
(PRE) aAdd(_aTotal[04][1],{})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"¿Secuencia?:",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,"XX",1,,,,2})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1, "¿Genera Archivo?",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{3,,,,,{"V-Ventas","C-Compras","T-Todos"},,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1, "¿Se consolida Sucursales?: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{3,,,,,{"1-SI","2-NO"},,})


[XXX Chamada do Wizard]
(PRE) _aTotal[05] := xMagWizard(_aTotal[03],_aTotal[04],"CV3685")
(PRE) Iif(_aTotal[05],xMagLeWiz("CV3685",@_aTotal[06],.T.),Nil)
(PRE) lAbtMT950 := !_aTotal[05]

[XXX Registro CV3865]
(PRE) _aTotal[99] := Loc3865(DTOS(_aTotal[01]),DTOS(_aTotal[02]),_aTotal[06])
(POS)

[RGENCA Cabecera de Ventas/Compras]
(ARQ) &("REGINFO_CV_CABECERA_" + Alltrim(SM0->M0_CGC) + "_" + ALLTRIM(STR(YEAR(dDataIni))) + STRZERO(MONTH(dDataIni),2) + ".TXT")
(PRE) RGENCA->(dbGoTop())
CUIT       C 011 0 aFISFILL(RGENCA->ENC_CUIT  ,11)
PERIOD     C 006 0 aFISFILL(RGENCA->ENC_PERIOD,06)
SECUEN     C 002 0 aFISFILL(RGENCA->ENC_SECUEN,02)
SINMOV     C 001 0 aFISFILL(RGENCA->ENC_SINMOV,01)
PRORRA     C 001 0 aFISFILL(RGENCA->ENC_PRORRA,01)
CREFIS     C 001 0 aFISFILL(RGENCA->ENC_CREFIS,01)
IMPCGF     C 015 0 aFISFILL(RGENCA->ENC_IMPCGF,15)
IMPCAD     C 015 0 aFISFILL(RGENCA->ENC_IMPCAD,15)
IMPCDP     C 015 0 aFISFILL(RGENCA->ENC_IMPCDP,15)
IMPCNG     C 015 0 aFISFILL(RGENCA->ENC_IMPCNG,15)
IMPSSO     C 015 0 aFISFILL(RGENCA->ENC_IMPSSO,15)
IMPCSO     C 015 0 aFISFILL(RGENCA->ENC_IMPCSO,15)
(POS)

[DETVTA Detalle Ventas]
(ARQ) &("REGINFO_CV_VENTAS_CBTE_" + Alltrim(SM0->M0_CGC) + "_" + ALLTRIM(STR(YEAR(dDataIni))) + STRZERO(MONTH(dDataIni),2) + ".TXT")
(PRE) DETVTA->(dbGoTop())
FCHCOM     C 008 0 aFISFILL(DETVTA->DET_FCHCOM,08)
TIPCOM     C 003 0 aFISFILL(DETVTA->DET_TIPCOM,03)
PUNVEN     C 005 0 aFISFILL(DETVTA->DET_PUNVEN,05)
NUMCOM     C 020 0 aFISFILL(DETVTA->DET_NUMCOM,20)
NCHAST     C 020 0 aFISFILL(DETVTA->DET_NCHAST,20)
CODCOM     C 002 0 aFISFILL(DETVTA->DET_CODCOM,02)
CUIT       C 020 0 aFISFILL(DETVTA->DET_CUIT,20)
NOMBRE     C 030 0 aFISFILL(DETVTA->DET_NOMBRE,30)
IMPTOT     C 015 0 aFISFILL(DETVTA->DET_IMPTOT,15)
IMCNGR     C 015 0 aFISFILL(DETVTA->DET_IMCNGR,15)
PERNCT     C 015 0 aFISFILL(DETVTA->DET_PERNCT,15)
IMPOEX     C 015 0 aFISFILL(DETVTA->DET_IMPOEX,15)
IPPINA     C 015 0 aFISFILL(DETVTA->DET_IPPINA,15)
IPERIB     C 015 0 aFISFILL(DETVTA->DET_IPERIB,15)
IPEIMN     C 015 0 aFISFILL(DETVTA->DET_IPEIMN,15)
IMPINT     C 015 0 aFISFILL(DETVTA->DET_IMPINT,15)
CODMON     C 003 0 aFISFILL(DETVTA->DET_CODMON,03)
TPCAMB     C 010 0 aFISFILL(DETVTA->DET_TPCAMB,10)
CANALQ     C 001 0 aFISFILL(DETVTA->DET_CANALQ,01)
CODOPE     C 001 0 aFISFILL(DETVTA->DET_CODOPE,01)
OTRTRI     C 015 0 aFISFILL(DETVTA->DET_OTRTRI,15)
FCHVEN     C 008 0 aFISFILL("00000000",08)
(POS)

[DETVALQ Ventas Alicuotas]
(ARQ) &("REGINFO_CV_VENTAS_ALICUOTAS_" + Alltrim(SM0->M0_CGC) + "_" + ALLTRIM(STR(YEAR(dDataIni))) + STRZERO(MONTH(dDataIni),2) + ".TXT")
(PRE) DETVALQ->(dbGoTop())
TIPCOM     C 003 0 aFISFILL(DETVALQ->DGR_TIPCOM,03)
PUNVEN     C 005 0 aFISFILL(DETVALQ->DGR_PUNVEN,05)
NUMCOM     C 020 0 aFISFILL(DETVALQ->DGR_NUMCOM,20)
IMPNGR     C 015 0 aFISFILL(DETVALQ->DGR_IMPNGR,15)
ALQIVA     C 004 0 aFISFILL(DETVALQ->DGR_ALQIVA,04)
IMPLIQ     C 015 0 aFISFILL(DETVALQ->DGR_IMPLIQ,15)
(POS)

[DETCOM Detalle Compras]
(ARQ) &("REGINFO_CV_COMPRAS_CBTE_" + Alltrim(SM0->M0_CGC) + "_" + ALLTRIM(STR(YEAR(dDataIni))) + STRZERO(MONTH(dDataIni),2) + ".TXT")
(PRE) DETCOM->(dbGoTop())
FCHCOM     C 008 0 aFISFILL(DETCOM->DET_FCHCOM,08)
TIPCOM     C 003 0 aFISFILL(DETCOM->DET_TIPCOM,03)
PUNVEN     C 005 0 aFISFILL(DETCOM->DET_PUNVEN,05)
NUMCOM     C 020 0 aFISFILL(DETCOM->DET_NUMCOM,20)
DESPIM     C 016 0 aFISFILL(DETCOM->DET_DESPIM,16)
CODVEN     C 002 0 aFISFILL(DETCOM->DET_CODVEN,02)
NIDVEN     C 020 0 aFISFILL(DETCOM->DET_NIDVEN,20)
NOMBRE     C 030 0 aFISFILL(DETCOM->DET_NOMBRE,30)
IMPTOT     C 015 0 aFISFILL(DETCOM->DET_IMPTOT,15)
IMCNGR     C 015 0 aFISFILL(DETCOM->DET_IMCNGR,15)
IMPOEX     C 015 0 aFISFILL(DETCOM->DET_IMPOEX,15)
IMPIVA     C 015 0 aFISFILL(DETCOM->DET_IMPIVA,15)
IPPINA     C 015 0 aFISFILL(DETCOM->DET_IPPINA,15)
IPERIB     C 015 0 aFISFILL(DETCOM->DET_IPERIB,15)
IPEIMN     C 015 0 aFISFILL(DETCOM->DET_IPEIMN,15)
IMPINT     C 015 0 aFISFILL(DETCOM->DET_IMPINT,15)
CODMON     C 003 0 aFISFILL(DETCOM->DET_CODMON,03)
TPCAMB     C 010 0 aFISFILL(DETCOM->DET_TPCAMB,10)
CANALQ     C 001 0 aFISFILL(DETCOM->DET_CANALQ,01)
CODOPE     C 001 0 aFISFILL(DETCOM->DET_CODOPE,01)
CRFCOM     C 015 0 aFISFILL(DETCOM->DET_CRFCOM,15)
OTRTRI     C 015 0 aFISFILL(DETCOM->DET_OTRTRI,15)
CUIT       C 011 0 aFISFILL(DETCOM->DET_CUIT,11)
DENOMI     C 030 0 aFISFILL(DETCOM->DET_DENOMI,30)
IVACOM     C 015 0 aFISFILL(DETCOM->DET_IVACOM,15)
(POS)

[DETCALQ Compras Alicuotas]
(ARQ) &("REGINFO_CV_COMPRAS_ALICUOTAS_" + Alltrim(SM0->M0_CGC) + "_" + ALLTRIM(STR(YEAR(dDataIni))) + STRZERO(MONTH(dDataIni),2) + ".TXT")
(PRE) DETCALQ->(dbGoTop())
TIPCOM     C 003 0 aFISFILL(DETCALQ->CAL_TIPCOM,03)
PUNVEN     C 005 0 aFISFILL(DETCALQ->CAL_PUNVEN,05)
NUMCOM     C 020 0 aFISFILL(DETCALQ->CAL_NUMCOM,20)
CODVEN     C 002 0 aFISFILL(DETCALQ->CAL_CODVEN,02)
NIDVEN     C 020 0 aFISFILL(DETCALQ->CAL_NIDVEN,20)
IMPNGR     C 015 0 aFISFILL(DETCALQ->CAL_IMPNGR,15)
ALQIVA     C 004 0 aFISFILL(DETCALQ->CAL_ALQIVA,04)
IMPLIQ     C 015 0 aFISFILL(DETCALQ->CAL_IMPLIQ,15)
(POS)

[DCOMIM Compras Importaciones]
(ARQ) &("REGINFO_CV_COMPRAS_IMPORTACIONES_" + Alltrim(SM0->M0_CGC) + "_" + ALLTRIM(STR(YEAR(dDataIni))) + STRZERO(MONTH(dDataIni),2) + ".TXT")
(PRE) DCOMIM->(dbGoTop())
DESPIM     C 016 0 aFISFILL(DCOMIM->IMP_DESPIM,16)
IMPNGR     C 015 0 aFISFILL(DCOMIM->IMP_IMPNGR,15)
ALQIVA     C 004 0 aFISFILL(DCOMIM->IMP_ALQIVA,04)
IMPLIQ     C 015 0 aFISFILL(DCOMIM->IMP_IMPLIQ,15)
(POS)

[DIMOFI Credito Fiscal]
(ARQ) &("REGINFO_CV_CREDITO_FISCAL_IMP_SERVICIOS_" + Alltrim(SM0->M0_CGC) + "_" + ALLTRIM(STR(YEAR(dDataIni))) + STRZERO(MONTH(dDataIni),2) + ".TXT")
(PRE) DIMOFI->(dbGoTop())
TIPCOM     C 001 0 aFISFILL(DIMOFI->CFI_TIPCOM,01)
DESCOM     C 020 0 aFISFILL(DIMOFI->CFI_DESCOM,20)
IDCOMP     C 020 0 aFISFILL(DIMOFI->CFI_IDCOMP,20)
FCHOPE     C 008 0 aFISFILL(DIMOFI->CFI_FCHOPE,08)
MONMOR     C 015 0 aFISFILL(DIMOFI->CFI_MONMOR,15)
CODMON     C 003 0 aFISFILL(DIMOFI->CFI_CODMON,03)
TPCAMB     C 010 0 aFISFILL(DIMOFI->CFI_TPCAMB,10)
CUITPR     C 011 0 aFISFILL(DIMOFI->CFI_CUITPR,11)
NIFPRE     C 020 0 aFISFILL(DIMOFI->CFI_NIFPRE,20)
NOMBRE     C 030 0 aFISFILL(DIMOFI->CFI_NOMBRE,30)
ALIQAP     C 004 0 aFISFILL(DIMOFI->CFI_ALIQAP,04)
FCHING     C 008 0 aFISFILL(DIMOFI->CFI_FCHING,08)
MONING     C 015 0 aFISFILL(DIMOFI->CFI_MONING,15)
IMPCOM     C 015 0 aFISFILL(DIMOFI->CFI_IMPCOM,15)
IDPLCO     C 020 0 aFISFILL(DIMOFI->CFI_IDPLCO,20)
CUITEP     C 011 0 aFISFILL(DIMOFI->CFI_CUITEP,11)
(POS)

[XXX Cerrar Temporales]
(PRE) AMArgPos("",_aTotal[99])

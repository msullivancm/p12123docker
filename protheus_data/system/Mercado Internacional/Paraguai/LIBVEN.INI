?{"Nombre do archivo INI","LIBVEN.INI"}
?{"Descripciono completa del archivo magnetico","Archivo utilizado no procesamiento del libro de ventas ."}
[XXX Inicializacao]
(PRE) _aTotal[01] := FirstDate(MV_PAR01)              
(PRE) _aTotal[02] := LastDate(MV_PAR02)
(PRE) _aTotal[03] := {}
(PRE) _aTotal[04] := {}
(PRE) _aTotal[05] := .F.
(PRE) _aTotal[06] := {}
[XXX Montagem do CFP Utilizado pela rotina - PRINCIPAL]
(PRE) aAdd(_aTotal[03],"Libro de Vendas")
(PRE) aAdd(_aTotal[03],"")
(PRE) aAdd(_aTotal[03],"Llene correctamente las informacioness solicitadas.")
(PRE) aAdd(_aTotal[03],"Informaciones necesarias para  generar el archivo magnetico del Libro de Ventas.")
[XXX Painel 1 - Configuraciones Gerais]
(PRE) aAdd(_aTotal[04],{})
(PRE) aAdd(_aTotal[04][1],"Libro de ventas")
(PRE) aAdd(_aTotal[04][1],"Configuraciones del encabezado:")
(PRE) aAdd(_aTotal[04][1],{})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1, "Tipo del informe?",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{3,,,,,{"1-Original","2-Rectificacion"},,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"RUC Agente de Informacion: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,"XXXXXXXXXXXXXXX",1,,,,15})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"DV Agente de Informacion: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,"X",1,,,,1})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Informaciones o nombre del agente: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,"",1,,,,80})

[XXX Painel 2 - Configuracoes Gerais]
(PRE) aAdd(_aTotal[04],{})
(PRE) aAdd(_aTotal[04][2],"Libro de Ventas")
(PRE) aAdd(_aTotal[04][2],"Configuraciones Encabezado:")
(PRE) aAdd(_aTotal[04][2],{})
(PRE) aAdd(_aTotal[04][2][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][2][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][2][3],{1,"RUC representante legal: ",,,,,,})
(PRE) aAdd(_aTotal[04][2][3],{2,,"XXXXXXXXXXXXXXX",1,,,,15})
(PRE) aAdd(_aTotal[04][2][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][2][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][2][3],{1,"DV representante Legal: ",,,,,,})
(PRE) aAdd(_aTotal[04][2][3],{2,,"X",1,,,,1})
(PRE) aAdd(_aTotal[04][2][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][2][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][2][3],{1,"Nombre completo representante legal: ",,,,,,})
(PRE) aAdd(_aTotal[04][2][3],{2,,"",1,,,,80})
(PRE) aAdd(_aTotal[04][2][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][2][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][2][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][2][3],{0,"",,,,,,})
[XXX Chamada do Wizard]
(PRE) _aTotal[05] := xMagWizard(_aTotal[03],_aTotal[04],"LIBVEN")
(PRE) Iif(_aTotal[05],xMagLeWiz("LIBVEN",@_aTotal[06],.T.),Nil)
[XXX Registro VEN - Libro de Venda]
(PRE) _aTotal[99] := LocPar("VEN",DTOS(_aTotal[01]),DTOS(_aTotal[02]),_aTotal[06])
(PRE) CAB->(dbGotop())
(PRE) VEN->(dbGotop())
[CAB Registro CAB - Cabecalho]
TIPO       C 001 0 aFISFILL(CAB_TIPO,1)
PERIODO    C 006 0 aFISFILL(Substr(DTOS(MV_PAR01),1,6),6)
TIPREP     C 001 0 aFISFILL(CAB_TIPREP,1)
TIPINF     C 003 0 aFISFILL(CAB_TIPINF,3)
CODFORM    C 003 0 aFISFILL(CAB_CDFORM,3)
RUCAGIN    C 015 0 aFISFILL(CAB_RUCAGI,15)
DVAGIN     C 001 0 aFISFILL(CAB_DVAGIN,1)
NOMAGIN    C 080 0 aFISFILL(CAB_NOMAGI,80)
RUCREPL    C 015 0 aFISFILL(CAB_RUCREP,15)
DVREPL     C 001 0 aFISFILL(CAB_DVREPL,1)
NOMREPL    C 080 0 aFISFILL(CAB_NOMREP,80)
QTDREG     C 005 0 aFISFILL(CAB_NUMREG,5)
VLRTOT     C 020 0 aFISFILL(CAB_VLRTOT,20)
(POS)
[VEN Registro VEN - Libro de Vendas]    
TIPREG     C 001 0 aFISFILL(VEN_TIPREG,1)
RUC        C 015 0 aFISFILL(VEN_RUC,15)
DV         C 001 0 aFISFILL(VEN_DV,1)
NOMFOR     C 080 0 aFISFILL(VEN_NOMCLI,80)
TIPDOC     C 002 0 aFISFILL(VEN_TIPDOC,2)
NUMDOC     C 020 0 aFISFILL(VEN_NUMDOC,20)
EMISSA     C 010 0 aFISFILL(VEN_EMISSA,10)
BAS010     C 020 0 aFISFILL(VEN_BAS010,20)
VLR010     C 020 0 aFISFILL(VEN_VLR010,20)
BAS005     C 020 0 aFISFILL(VEN_BAS005,20)
VLR005     C 020 0 aFISFILL(VEN_VLR005,20)
VLREXE     C 020 0 aFISFILL(VEN_VLREXE,20)
VLRINS     C 020 0 aFISFILL(VEN_VLRING,20)
[XXX Gerando relatorio]
(PRE) IMPLOCPAR(_aTotal[99])
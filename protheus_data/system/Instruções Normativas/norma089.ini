?{"Nome do Arquivo INI","NORMA089.INI"}
?{"Descricao Completa do Arquivo Magnetico","Instrucao Normativa SRF n.89 - Referente ao Imposto de Renda."}
?{"A Quem se Destina","As pessoas juridicas que utilizarem sistemas de processamento eletronico de dados para registrar negocios e atividades economicas ou financeiras, escriturar livros ou elaborar documentos de natureza contabil ou fiscal."}
?{"Objetivo","Dispoe sobre informacoes, formas e prazos para apresentacao dos arquivos digitais e sistemas utilizados por pessoas juridicas."}
?{"Prazo de Entrega","Vinte dias a partir da intimacao dos Auditores-Fiscais da Receita Federal."}
?{"Aplicativo Disponibilizado pelo Fisco","Não há."}
?{"Versao do Aplicativo Contemplada pela Microsiga","Não há."}
?{"Comentarios","As empresas optantes pelo Sistema Integrado de Pagamento de Impostos e Contribuicoes das Microempresas e Empresas de Pequeno Porte (Simples), de que trata a Lei n. 9.317, de 5 de dezembro de 1996, ficam dispensadas do cumprimento da obrigacao."}
?{"Nomenclaturas dos Arquivos",""}
?{"411LANCSI2.TXT - Lançamentos Contábeis - SIGACON"}
?{"411LANCCT2.TXT - Lançamentos Contábeis - SIGACTB"}
?{"412SALSI1.TXT - Saldos Mensais - SIGACON"}
?{"412SALCT1.TXT - Saldos Mensais - SIGACTB"}
?{"421CONTSE1.TXT - Fornecedores / Clientes - Contas a Receber"}
?{"421CONTSE2.TXT - Fornecedores / Clientes - Contas a Pagar"}
?{"421MOVRSE5.TXT - Fornecedores / Clientes - Movimentação Bancária Clientes"}
?{"421MOVPSE5.TXT - Fornecedores / Clientes - Movimentação Bancária Fornecedores"}
?{"431MESTRESA.TXT - Mestre das Notas Fiscais de Saída Emitidas pela Empresa"}
?{"431MESTREEM.TXT - Mestre das Notas Fiscais de Entrada Emitidas pela Empresa"}
?{"432ITENSSAI.TXT - Itens das Notas Fiscais de Saída Emitidas pela Empresa"}
?{"432ITENSENTR.TXT - Itens das Notas Fiscais de Entrada Emitidas pela Empresa"}
?{"433SERVENTR.TXT - Mestre das Notas Fiscais de Entrada Emitidas por Terceiros"}
?{"434ITENSERV.TXT - Itens das Notas Fiscais de Entrada Emitidas por Terceiros"}
?{"435NFSERV.TXT - Mestre das Notas Fiscais de Serviço Emitidas pela Empresa"}
?{"436ITESERVE.TXT - Itens das Notas Fiscais de Serviço Emitidas pela Empresa"}
?{"437NFSERVTER.TXT - Mestre das Notas Fiscais de Serviço Emitidas por Terceiros"}
?{"441EXPORTAC.TXT - Exportação"}
?{"442IMPORTAC.TXT - Importação"}
?{"451RESTOQU1.TXT - Controle de Estoque"}
?{"451RESTOQU2.TXT - Controle de Estoque"}
?{"451RESTOQU3.TXT - Controle de Estoque"}
?{"452INVENTAR.TXT - Registro de Inventário"}
?{"461INSUMOS.TXT - Insumos Relacionados"}
?{"471ATIVO.TXT - Cadastro de Bens"}
?{"481FLMESTRE.TXT - Mestre da Folha de Pagamento"}
?{"482ITENSFOL.TXT - Itens da Folha de Pagamento"}
?{"491TRABALHA.TXT - Cadastro de Trabalhadores"}
?{"492CLIENTES.TXT - Cadastro de Pessoas Jurídicas e Físicas"}
?{"492FORNECED.TXT - Cadastro de Pessoas Jurídicas e Físicas"}
?{"493PLANO.TXT - Plano de Contas - SIGACON"}
?{"493PLANO2.TXT - Plano de Contas - SIGACTB"}
?{"494CENTRO.TXT - Centro de Custo/Despesa"}
?{"495CFOP.TXT - Natureza de Operação"}
?{"496PRODUTO.TXT - Mercadorias / Serviços"}
?{"496SERVICO.TXT - Mercadorias / Serviços"}
?{"497PROVDESC.TXT - Proventos / Descontos"}

[XXX Inicializacao]
(PRE) _aTotal[006] := {}
(PRE) _aTotal[007] := {}
(PRE) _aTotal[008] := .T.
(PRE) _aTotal[009] := {}

[XXX Montagem do CFP Utilizado pela rotina - PRINCIPAL]
(PRE) aAdd (_aTotal[006], "Processamento da Norma 089")
(PRE) aAdd (_aTotal[006], "")
(PRE) aAdd (_aTotal[006], "Preencha corretamente as informações solicitadas.")
(PRE) aAdd (_aTotal[006], "Informações necessárias para o preenchimento automático da Norma 089      Instrução Normativa 089.")

[XXX Montagem do CFP Utilizado pela rotina - COMPLEMENTAR]
(PRE) aAdd (_aTotal[007], {})
(PRE) aAdd (_aTotal[007][1], "Processamento da NORMA 089")
(PRE) aAdd (_aTotal[007][1], "Passo: 1/1 - Selecao das Filiais.")
(PRE) aAdd (_aTotal[007][1], {})
(PRE) aAdd (_aTotal[007][1][3], {1, "Filial De",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "Filial Até",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {2,,"XX", 1,,,,2})
(PRE) aAdd (_aTotal[007][1][3], {2,,"XX", 1,,,,2})

[XXX Chamada do Wizard]
(PRE) _atotal[008] := xMagWizard( _aTotal[006] , _aTotal[007] , "MANAD" )
(PRE) Iif( _atotal[008] , xMagLeWiz( "MANAD" , @_aTotal[009] , .T. ) , Nil )
(PRE) lAbtMT950	:= !_atotal[008]  

[SM0 Montagem de Arquivo ATI      ]
(PRE) _aTotal[01] := {}
(PRE) _aTotal[01] := DadosCTB()
(PRE) _aTotal[77] := {"INV",""}
(PRE) FsEstInv (_aTotal[77], 1, .T., .F., SuperGetMv("MV_ULMES"))

[ATI Lancamentos Contabeis - 411LANCSI2.TXT]
(ARQ) 411LANCSI2.TXT
(IMP) {.T.,1,1,"Data_Lanca"}
(CMP) {{"Data_Lanca","Data"},{"Conta_Anal","Conta Analitica"},{"CCusto","Centro Custo"},{"Contra_Par","Contra Partida"},{"IndicaDC","S"},{"Valor_Lanc","Valor Lancado"},{"Numero Lanc","Lancamento"}}
(PRE) _aTotal[1] := VerCod("62")
(PRE) ATI->(DBGOTOP())
(PREREG) (ATI->DtLanca >= MV_PAR01 .and. ATI->DtLanca <= MV_PAR02)
Data_Lanca C 008 0 FormatDate(ATI->DtLanca)
Conta_Anal C 028 0 ATI->CtaAnal
CCusto     C 028 0 ATI->CCusto
Contra_Par C 028 0 ATI->ContPar
Valor_Lanc N 017 2 ATI->ValLanc
IndicaDc   C 001 0 ATI->IndicaDc
Numero Arq C 012 0 ATI->NumArq
Numero LancC 012 0 ATI->NumLanc
Hist_Compl C 150 0 ATI->HstCompl

[AT2 Lancamentos Contabeis - 411LANCCT2.TXT]
(ARQ) 411LANCCT2.TXT    
(IMP) {.T.,1,1,"Data_Lanca"} 
(CMP) {{"Data_Lanca","Data"},{"Conta_Anal","Conta Analitica"},{"CCusto","Centro Custo"},{"Contra_Par","Contra Partida"},{"IndicaDC","S"},{"Valor_Lanc","Valor Lancado"},{"Numero Lanc","Lancamento"}}
(PRE) AT2->(DBGOTOP())
(PREREG) (AT2->DtLanca >= MV_PAR01 .and. AT2->DtLanca <= MV_PAR02)
Data_Lanca C 008 0 AT2->DtLanca
Conta_Anal C 028 0 AT2->CtaAnal
CCusto     C 028 0 AT2->CCusto
Contra_Par C 028 0 AT2->ContPar
Valor_Lanc N 017 2 AT2->ValLanc
IndicaDc   C 001 0 AT2->IndicaDc
Numero Arq C 012 0 AT2->NumArq
Numero LancC 012 0 AT2->NumLanc
Hist_Compl C 150 0 AT2->HstCompl
(POS) DadosCTB(,,,,,,,_aTotal[01])

[SI1 Saldos Mensais - 412SALSI1.TXT]
(ARQ) 412SALSI1.TXT 
(IMP) {.T.,1,1,"DtaSaldoIn"} 
(CMP) {{"DtaSaldoIn","Data"},{"Conta_Anal","Conta Analitica"},{"VlrSldIni","Saldo Inicial"},{"Ind Inicio","I"},{"VlrTotDeb","Debito"},{"VlrTotCred","Credito"},{"VlrSldFina","Saldo Final"},{"Ind Final","F"}}
(LEG) "Coluna(s): I = Situacao Inicial (Debito (D) ou Credito) / F = Situacao Final (Debito (D) ou Credito (C))"
(PRE) SI1->(MsSeek(xFilial()))
DtaSaldoIn C 008 0 DataInt(mv_par01)
Conta_Anal C 028 0 SI1->I1_CODIGO
VlrSldIni  N 017 2 Abs(CalcSaldo(Month(mv_par01)-1))
Ind Inicio C 001 0 DouC(CalcSaldo(Month(mv_par01)-1))
VlrTotDeb  N 017 2 TotDebitos(Month(mv_par01),Month(mv_par02))
VlrTotCred N 017 2 TotCreditos(Month(mv_par01),Month(mv_par02))
VlrSldFina N 017 2 Abs(CalcSaldo(Month(mv_par02)))
Ind Final  C 001 0 DouC(CalcSaldo(Month(mv_par02)))

[CT1 Saldos Mensais - 412SALCT1.TXT]
(ARQ) 412SALCT1.TXT
(IMP) {.T.,1,1,"DtaSaldoIn"} 
(CMP) {{"DtaSaldoIn","Data"},{"Conta_Anal","Conta Analitica"},{"VlrSldIni","Saldo Inicial"},{"Ind Inicio","I"},{"VlrTotDeb","Debito"},{"VlrTotCred","Credito"},{"VlrSldFina","Saldo Final"},{"Ind Final","F"}}
(LEG) "Coluna(s): I = Situacao Inicial (Debito (D) ou Credito) / F = Situacao Final (Debito (D) ou Credito (C) Inicial)"
(PRE) CT1->(MsSeek(xFilial()))
DtaSaldoIn C 008 0 DataInt(mv_par01)
Conta_Anal C 028 0 CT1->CT1_CONTA
VlrSldIni  N 017 2 Abs(SaldoConta(CT1->CT1_CONTA ,mv_par01,"01","1",6))
Ind Inicio C 001 0 DouC(SaldoConta(CT1->CT1_CONTA ,mv_par01,"01","1",6))
VlrTotDeb  N 017 2 MovConta(CT1->CT1_CONTA,mv_par01,mv_par02,"01","1",1)
VlrTotCred N 017 2 MovConta(CT1->CT1_CONTA,mv_par01,mv_par02,"01","1",2)
VlrSldFina N 017 2 Abs(SaldoConta(CT1->CT1_CONTA ,mv_par02,"01","1",1))
Ind Final  C 001 0 DouC(SaldoConta(CT1->CT1_CONTA ,mv_par02,"01","1",1))

[SE1 Clientes - Contas a Receber - 421CONTSE1.TXT]
(ARQ) 421CONTSE1.TXT
(IMP) {.T.,1,1,"Cta_Conta"} 
(CMP) {{"Cta_Conta","Conta"},{"Participa","Participante"},{"Data_Lanca","Data"},{"Hist_Nature","Historico"},{"Valor_Oper","Valor Operacao"},{"Numero Lcto","Lancamento"}}
(PRE) DadosAdm("SE1")
(PRE) SA1->(dbSetOrder(1))
(PREREG) SA1->(dbSeek(xFilial("SA1")+SE1->E1_CLIENTE+SE1->E1_LOJA))
Cta_Conta  C 028 0 SA1->A1_CONTA
Participa  C 014 0 Space(14-len(alltrim(SA1->A1_CGC)))+alltrim(SA1->A1_CGC)
Data_Lanca C 008 0 DataInt(SE1->E1_EMIS1)
Hist_NatureC 050 0 SE1->E1_HIST
Valor_Oper N 017 2 xMoeda(SE1->E1_VALOR,SE1->E1_MOEDA,1,SE1->E1_EMISSAO)
TipoOper   C 001 0 "C"
TipoDoc    C 003 0 SE1->E1_TIPO
NumDocSe1  C 012 0 SE1->E1_PREFIXO+(RetNf(SE1->E1_NUM,6,"C")+Space((6-Len(RetNf(SE1->E1_NUM,6,"C")))))+SE1->E1_PARCELA
Valor_Orig N 017 2 SE1->E1_VLCRUZ
DtEmissao  C 008 0 DataInt(SE1->E1_EMISSAO)
Data_Venc  C 008 0 DataInt(SE1->E1_VENCREA)
Numero LctoC 012 0 SE1->E1_NUM
(POS) CloseAdm("SE1")

[SE2 Fornecedores - Contas a Pagar - 421CONTSE2.TXT]
(ARQ) 421CONTSE2.TXT
(IMP) {.T.,1,1,"Cta_Conta"} 
(CMP) {{"Cta_Conta","Conta"},{"Participa","Participante"},{"Data_Lanca","Data"},{"Hist_Nature","Historico"},{"Valor_Oper","Valor Operacao"},{"Numero Lcto","Lancamento"}}
(PRE) DadosAdm("SE2")
(PRE) SA2->(dbSetOrder(1))
(PREREG) SA2->(dbSeek(xFilial("SA2")+SE2->E2_FORNECE+SE2->E2_LOJA))    
Cta_Conta  C 028 0 SA2->A2_CONTA
Participa  C 014 0 Space(14-len(alltrim(SA2->A2_CGC)))+alltrim(SA2->A2_CGC)
Data_Lanca C 008 0 DataInt(SE2->E2_EMIS1)
Hist_NatureC 050 0 SE2->E2_HIST
Valor_Oper N 017 2 xMoeda(SE2->E2_VALOR,SE2->E2_MOEDA,1,SE2->E2_EMISSAO)
TipoOper   C 001 0 "C"
TipoDoc    C 003 0 SE2->E2_TIPO
NumDocSe2  C 012 0 SE2->E2_PREFIXO+(RetNf(SE2->E2_NUM,6,"C")+Space((6-Len(RetNf(SE2->E2_NUM,6,"C")))))+SE2->E2_PARCELA
Valor_orig N 017 2 SE2->E2_VLCRUZ
DtEmissao  C 008 0 DataInt(SE2->E2_EMISSAO)
Data_Venc  C 008 0 DataInt(SE2->E2_VENCREA)
Numero LctoC 012 0 SE2->E2_NUM
(POS) CloseAdm("SE2")

[SM0 Montagem de Arquivo SE5 ]
(PRE) DadosAdm("SE5","BBR")
[BBR Clientes - Movimentacao Bancaria - 421MOVRSE5.TXT]
(ARQ) 421MOVRSE5.TXT 
(IMP) {.T.,1,1,"Cta_Conta"} 
(CMP) {{"Cta_Conta","Conta"},{"Participa","Cliente/Fornecedor"},{"Data_Lanca","Data"},{"Hist_Nature","Historico"},{"Valor_Oper","Valor Operacao"},{"Numero Lcto","Lancamento"}}
(PRE) SA1->(dbSetOrder(1))
(PRE) SE1->(dbSetOrder(2))
(PREREG) SelAdm("SE5","BBR")
Cta_Conta  C 028 0 SA1->A1_CONTA
Participa  C 014 0 Space(14-len(alltrim(SA1->A1_CGC)))+alltrim(SA1->A1_CGC)
Data_Lanca C 008 0 DataInt(SE5->E5_DTDIGIT)
Hist_NatureC 050 0 SE5->E5_HISTOR
Valor_Oper N 017 2 ValOpera(SE5->E5_FILIAL,SE5->E5_PREFIXO,SE5->E5_NUMERO,SE5->E5_PARCELA,SE5->E5_TIPO,SE5->E5_CLIFOR,SE5->E5_LOJA,SE5->E5_SEQ,SE5->E5_RECPAG)
TipoOper   C 001 0 SE5->E5_RECPAG
TipoDoc    C 003 0 SE5->E5_TIPO
NumDocSe5  C 012 0 SE5->E5_PREFIXO+(RetNf(SE5->E5_NUMERO,6,"C")+Space((6-Len(RetNf(SE5->E5_NUMERO,6,"C")))))+SE5->E5_PARCELA
Valor_orig N 017 2 SE1->E1_VLCRUZ
DtEmissao  C 008 0 DataInt(SE1->E1_EMISSAO)
Data_Venc  C 008 0 DataInt(SE1->E1_VENCREA)
Numero LctoC 012 0 SE5->E5_NUMERO

[SM0 Montagem de Arquivo SE5      ]
(PRE) DadosAdm("SE5","BBP")
[BBP Fornecedores  - Movimentacao Bancaria - 421MOVPSE5.TXT]
(ARQ) 421MOVPSE5.TXT
(IMP) {.T.,1,1,"Cta_Conta"} 
(CMP) {{"Cta_Conta","Conta"},{"Participa","Cliente/Fornecedor"},{"Data_Lanca","Data"},{"Hist_Nature","Historico"},{"Valor_Oper","Valor Operacao"},{"Numero Lcto","Lancamento"}}
(PRE) SA2->(dbSetOrder(1))
(PRE) SE2->(dbSetOrder(6))
(PREREG) SelAdm("SE5","BBP")
Cta_Conta  C 028 0 SA2->A2_CONTA                                                 
Participa  C 014 0 Space(14-len(alltrim(SA2->A2_CGC)))+alltrim(SA2->A2_CGC)
Data_Lanca C 008 0 DataInt(SE5->E5_DTDIGIT)                                      
Hist_NatureC 050 0 SE5->E5_HISTOR                                                
Valor_Oper N 017 2 ValOpera(SE5->E5_FILIAL,SE5->E5_PREFIXO,SE5->E5_NUMERO,SE5->E5_PARCELA,SE5->E5_TIPO,SE5->E5_CLIFOR,SE5->E5_LOJA,SE5->E5_SEQ,SE5->E5_RECPAG)
TipoOper   C 001 0 SE5->E5_RECPAG                                                
TipoDoc    C 003 0 SE5->E5_TIPO                                                  
NumDocSe5  C 012 0 SE5->E5_PREFIXO+(RetNf(SE5->E5_NUMERO,6,"C")+Space((6-Len(RetNf(SE5->E5_NUMERO,6,"C")))))+SE5->E5_PARCELA
Valor_orig N 017 2 SE2->E2_VLCRUZ                                                
DtEmissao  C 008 0 DataInt(SE2->E2_EMISSAO)                                      
Data_Venc  C 008 0 DataInt(SE2->E2_VENCREA)                                      
Numero LctoC 012 0 SE5->E5_NUMERO                                                

[SF3 Mestre Mercadorias/Servicos - Saidas - 431MESTRESA.TXT]
(ARQ) 431MESTRESA.TXT
(IMP) {.T.,1,1,"Indica_Mov"} 
(CMP) {{"Numero_Doc","Docto."},{"Modelo_Doc","Md"},{"SerSub_Doc","Serie"},{"Data_Saida","Saida"},{"ValTotMerc","Valor Mercadoria"}}
(LEG) "Coluna(s): Md = Modelo do Documento"
(PRE) SF3->(dbSetOrder(1))
(PRE) SF2->(dbSetOrder(2))
(PRE) SA1->(dbSetOrder(1))
(PRE) SA2->(dbSetOrder(1))
(PRE) SA4->(dbSetOrder(1))   
(PRE) SE4->(MsSeek(xFilial("SE4")))
(PRE) _aTotal[90] := {"SF3",""}
(PRE) _aTotal[91] := "F3_FILIAL='"+xFilial("SF3")+"' And F3_ENTRADA>='"+ DTOS(MV_PAR01) +"' And F3_ENTRADA<='"+ DTOS(MV_PAR02) +"' AND (F3_CFO LIKE '5%' OR F3_CFO LIKE '6%') AND F3_TIPO<>'S'"
(PRE) _aTotal[92] := GETNEWPAR("MV_SUBTRIB", "")
(PRE) _aTotal[98] := "F3_FILIAL+F3_CLIEFOR+F3_LOJA+F3_NFISCAL+F3_SERIE"
(PRE) _aTotal[99] := "F3_FILIAL=='"+ xFilial("SF3") +"' .and. DTOS(F3_ENTRADA)>='"+ DTOS(MV_PAR01) +"' .and. DTOS(F3_ENTRADA)<='"+ DTOS(MV_PAR02) +"' .And. SUBS(SF3->F3_CFO,1,1)>='5' .And. SUBS(SF3->F3_CFO,1,1)<='6' .And. SF3->F3_TIPO<>'S'"
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) DbGoTop()
(PRE) _aTotal[89] := ""
(PREREG) _aTotal[89] <> xFilial("SF3")+SF3->F3_CLIEFOR+SF3->F3_LOJA+SF3->F3_NFISCAL+SF3->F3_SERIE
(PREREG) SF2->(MsSeek(xFilial("SF2")+SF3->F3_CLIEFOR+SF3->F3_LOJA+SF3->F3_NFISCAL+SF3->F3_SERIE))
(PREREG) IiF(SF3->F3_TIPO$"DB",SA2->(MsSeek(xFilial("SA2")+SF3->F3_CLIEFOR+SF3->F3_LOJA)),SA1->(MsSeek(xFilial("SA1")+SF3->F3_CLIEFOR+SF3->F3_LOJA)))
(PREREG) (SA4->(MsSeek(xFilial("SA4")+SF2->F2_TRANSP)),.T.)
(PREREG) (SE4->(MsSeek(xFilial("SE4")+SF2->F2_COND)),.T.)
(PREREG) _aTotal[93] := AT(SF3->F3_ESTADO,_aTotal[92]) 
Indica_Mov C 001 0 "S"
Modelo_Doc C 002 0 AModNot(SF3->F3_ESPECIE)
SerSub_Doc C 005 0 SerieNfId("SF3",2,"F3_SERIE")
Numero_Doc C 006 0 RetNf(SF3->F3_NFISCAL,6,"C")
Dt_Emi_Doc C 008 0 DataInt(SF3->F3_EMISSAO)
Cod_Partic C 014 0 If(SF3->F3_TIPO$"DB",SPACE(14-LEN(ALLTRIM(SA2->A2_CGC)))+ALLTRIM(SA2->A2_CGC),SPACE(14-LEN(alltrim(SA1->A1_CGC)))+ALLTRIM(SA1->A1_CGC))
Data_Saida C 008 0 DataInt(SF3->F3_ENTRADA)
ValTotMerc N 017 2 SF2->F2_VALMERC
ValTotDesc N 017 2 SF2->F2_DESCONT
ValTotFret N 017 2 SF2->F2_FRETE
ValTotSegu N 017 2 SF2->F2_SEGURO
ValTotOutr N 017 2 SF2->F2_DESPESA
ValTotIPI  N 017 2 SF2->F2_VALIPI
Val_Icm_St N 017 2 SF2->F2_ICMSRET
Val_Tot_Nf N 017 2 SF2->F2_VALBRUT
Ins_Est_St C 014 0 If(!EMPTY(SUBS(_aTotal[92], _aTotal[93]+2, AT("/",SUBS(_aTotal[92],_aTotal[93],Len(_aTotal[92])))-3)),SUBS(_ATOTAL[92], _ATOTAL[93], AT("/",SUBS(_ATOTAL[92],_ATOTAL[93],Len(_ATOTAL[92])))-1),If(SF3->F3_TIPO$"DB" .AND. SF2->F2_ICMSRET>0 ,SA2->A2_INSCR,SA1->A1_INSCR))
Via_Transp C 015 0 SA4->A4_VIA
Cod_Transp C 014 0 SA4->A4_CGC
Qtd_Volume N 017 0 SF2->F2_VOLUME1
EspecieVol C 010 0 SF2->F2_ESPECI1
Peso_Bruto N 017 3 SF2->F2_PBRUTO
Peso_Liqui N 017 3 SF2->F2_PLIQUI
Mod_Frete  C 003 0 IIF(SF2->F2_FRETE>0,"CIF","FOB")
Ident_Veic C 015 0 SPACE(15)
Ind_Sit_Ca C 001 0 If(!Empty(SF3->F3_DTCANC),"S","N")
Tip_Fatura C 001 0 If(Alltrim(SE4->E4_COND)=="0","1","2")
Observacao C 045 0 SUBS(SF3->F3_OBSERV,1,45)
(POSREG) _aTotal[89] := xFilial("SF3")+SF3->F3_CLIEFOR+SF3->F3_LOJA+SF3->F3_NFISCAL+SF3->F3_SERIE
(POS) FsQuery(_aTotal[90],2,_aTotal[91],_aTotal[99],_aTotal[98])

[SF1 Mestre Mercadorias/Servicos - Entradas com Formulario Proprio - 431MESTREEM.TXT]
(ARQ) 431MESTREEM.TXT
(IMP) {.T.,1,1,"Indica_Mov"} 
(CMP) {{"Numero_Doc","Docto."},{"Modelo_Doc","Md"},{"SerSub_Doc","Serie"},{"Data_Saida","Saida"},{"ValTotMerc","Valor Mercadoria"}}
(LEG) "Coluna(s): Md = Modelo do Documento"
(PRE) SF3->(dbSetOrder(1))
(PRE) SF1->(dbSetOrder(2))
(PRE) SA1->(dbSetOrder(1))
(PRE) SA2->(dbSetOrder(1))
(PRE) _aTotal[96] := CriaTrab(nil,.f.)
(PRE) _aTotal[98] := "F3_FILIAL+F3_CLIEFOR+F3_LOJA+F3_NFISCAL+F3_SERIE"
(PRE) _aTotal[90] := {"SF3",""}
(PRE) _aTotal[92] := GETNEWPAR("MV_SUBTRIB", "")
(PRE) _aTotal[91] := "F3_FILIAL='"+ xFilial("SF3") +"' AND F3_ENTRADA>='"+ DTOS(MV_PAR01) +"' AND F3_ENTRADA<='"+ DTOS(MV_PAR02) +"' AND (F3_CFO LIKE '1%' OR F3_CFO LIKE '2%') AND F3_FORMUL='S' AND F3_TIPO<>'S'"
(PRE) _aTotal[99] := "F3_FILIAL=='"+ xFilial("SF3") +"' .and. DTOS(F3_ENTRADA)>='"+ DTOS(MV_PAR01) +"' .And. DTOS(F3_ENTRADA)<='"+ DTOS(MV_PAR02) +"' .and. SUBS(F3_CFO,1,1)>='1' .and. SUBS(F3_CFO,1,1)<='2' .And. F3_FORMUL=='S' .And. F3_TIPO<>'S'"
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) DbGoTop()
(PRE) _aTotal[89] := ""
(PREREG) (_aTotal[89] <> xFilial("SF3")+SF3->F3_CLIEFOR+SF3->F3_LOJA+SF3->F3_NFISCAL+SF3->F3_SERIE,.T.)
(PREREG) SF1->(MsSeek(xFilial("SF1")+SF3->F3_CLIEFOR+SF3->F3_LOJA+SF3->F3_NFISCAL+SF3->F3_SERIE))
(PREREG) IiF(!SF3->F3_TIPO$"DB",SA2->(MsSeek(xFilial("SA2")+SF3->F3_CLIEFOR+SF3->F3_LOJA)),SA1->(MsSeek(xFilial("SA1")+SF3->F3_CLIEFOR+SF3->F3_LOJA)))
(PREREG) (SE4->(MsSeek(xFilial("SE4")+SF1->F1_COND)),.T.)
(PREREG) _aTotal[93] := AT(SF3->F3_ESTADO,_aTotal[92]) 
Indica_Mov C 001 0 "E"
Modelo_Doc C 002 0 AModNot(SF1->F1_ESPECIE)
SerSub_Doc C 005 0 SerieNfId("SF1",2,"F1_SERIE")
Numero_Doc C 006 0 RetNf(SF1->F1_DOC,6,"C")
Dt_Emi_Doc C 008 0 DataInt(SF1->F1_EMISSAO)
Cod_Partic C 014 0 If(SF3->F3_TIPO$"DB",SPACE(14-LEN(ALLTRIM(SA1->A1_CGC)))+ALLTRIM(SA1->A1_CGC),SPACE(14-LEN(ALLTRIM(SA2->A2_CGC)))+ALLTRIM(SA2->A2_CGC))
Data_Saida C 008 0 DataInt(SF3->F3_ENTRADA)
ValTotMerc N 017 2 SF1->F1_VALMERC
ValTotDesc N 017 2 SF1->F1_DESCONT
ValTotFret N 017 2 SF1->F1_FRETE
ValTotSegu N 017 2 SF1->F1_SEGURO
ValTotOutr N 017 2 SF1->F1_DESPESA
ValTotIPI  N 017 2 SF1->F1_VALIPI
Val_Icm_St N 017 2 SF1->F1_ICMSRET
Val_Tot_Nf N 017 2 SF1->F1_VALBRUT
Ins_Est_St C 014 0 If(!EMPTY(SUBS(_aTotal[92], _aTotal[93]+2, AT("/",SUBS(_aTotal[92],_aTotal[93],Len(_aTotal[92])))-3)),SUBS(_ATOTAL[92], _ATOTAL[93], AT("/",SUBS(_ATOTAL[92],_ATOTAL[93],Len(_ATOTAL[92])))-1),If(SF3->F3_TIPO$"DB" .AND. SF2->F2_ICMSRET>0 ,SA2->A2_INSCR,SA1->A1_INSCR))
Via_Transp C 015 0 SPACE(15)
Cod_Transp C 014 0 SPACE(14)
Qtd_Volume N 017 0 0
EspecieVol C 010 0 SPACE(10)
Peso_Bruto N 017 3 0
Peso_Liqui N 017 3 SF1->F1_PESOL
Mod_Frete  C 003 0 IIF(SF1->F1_FRETE>0,"CIF","FOB")
Ident_Veic C 015 0 SPACE(15)
Ind_Sit_Ca C 001 0 If(!Empty(SF3->F3_DTCANC),"S","N")
Tip_Fatura C 001 0 If(Alltrim(SE4->E4_COND)=="0","1","2")
Observacao C 045 0 SUBS(SF3->F3_OBSERV,1,45)
(POSREG) _aTotal[89] := xFilial("SF3")+SF3->F3_CLIEFOR+SF3->F3_LOJA+SF3->F3_NFISCAL+SF3->F3_SERIE
(POS) FsQuery(_aTotal[90],2,_aTotal[91],_aTotal[99],_aTotal[98])

[SD2 Itens Mercadorias/Servicos - Saida - 432ITENSSAI.TXT]
(ARQ) 432ITENSSAI.TXT
(IMP) {.T.,1,1,"Indica_Mov"} 
(CMP) {{"Cod_d_Merc","Mercadoria/Servico"},{"Numero_Doc","Docto."},{"SerSub_Doc","Serie"},{"Modelo_Doc","Md"},{"Cod_CFOP","CFOP"},{"Vl_Total","Total"}}
(LEG) "Coluna(s): Md = Modelo do Documento"
(PRE) SB1->(dbSetOrder(1))
(PRE) SF2->(dbSetOrder(1))
(PRE) SF4->(dbSetOrder(1))
(PRE) SA1->(dbSetOrder(1))
(PRE) SA2->(dbSetOrder(1))
(PRE) _aTotal[98] := SD2->(IndexKey())		                         
(PRE) _aTotal[90] := {"SD2",""}
(PRE) _aTotal[91] := "D2_FILIAL='"+ xFilial("SD2") +"' AND D2_EMISSAO>='"+DTOS(MV_PAR01)+"' AND D2_EMISSAO<='"+DTOS(MV_PAR02)+"'"
(PRE) _aTotal[99] := "D2_FILIAL=='"+ xFilial("SD2") +"' .And. DTOS(D2_EMISSAO)>='"+ DTOS(MV_PAR01) +"' .And. DTOS(D2_EMISSAO)<='"+ DTOS(MV_PAR02) +"'"
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) DbGoTop()
(PREREG) !SUBS(ALLTRIM(SD2->D2_CF),1,1)$"3/7"
(PREREG) SF4->(MsSeek(xFilial("SF4")+SD2->D2_TES))
(PREREG) SF4->F4_ISS <> "S"
(PREREG) SB1->(MsSeek(xFilial("SB1")+SD2->D2_COD))
(PREREG) SF2->(MsSeek(xFilial("SF2")+SD2->D2_DOC+SD2->D2_SERIE+SD2->D2_CLIENTE+SD2->D2_LOJA))
(PREREG) IIF(SD2->D2_TIPO$"DB",SA2->(MsSeek(xFilial("SA2")+SF2->F2_CLIENTE+SF2->F2_LOJA)),SA1->(MsSeek(xFilial("SA1")+SF2->F2_CLIENTE+SF2->F2_LOJA)))
Indica_Mov C 001 0 "S"
Modelo_Doc C 002 0 AModNot(SF2->F2_ESPECIE)
SerSub_Doc C 005 0 SerieNfId("SD2",2,"D2_SERIE")
Numero_Doc C 006 0 RetNf(SD2->D2_DOC,6,"C")
Dt_Emi_Doc C 008 0 DataInt(SD2->D2_EMISSAO)
Numero_Ite C 003 0 SD2->D2_ITEM
Cod_d_Merc C 020 0 SD2->D2_COD
Desc_Compl C 045 0 SB1->B1_DESC
Cod_CFOP   C 003 0 SUBS(SD2->D2_CF,1,3)
Cod_Nat_Op C 006 0 SD2->D2_CF
Cod_ClaFis C 008 0 SB1->B1_POSIPI
Quantidade N 017 3 SD2->D2_QUANT
Unidade    C 003 0 Subs(SD2->D2_UM,1,3)
Vl_Unitari N 017 4 SD2->D2_PRCVEN
Vl_Total   N 017 2 SD2->D2_TOTAL
Vl_DescIte N 017 2 SD2->D2_DESCON
Indica_Ipi C 001 0 If(SF4->F4_LFIPI=="T",1,If(SF4->F4_LFIPI$"IN",2,3))
Aliquo_Ipi N 005 2 SD2->D2_IPI
BaseCalIpi N 017 2 If(SD2->D2_IPI>0,SD2->D2_VALIPI/(SD2->D2_IPI/100),0)
Vl_Ipi     N 017 2 SD2->D2_VALIPI
Sit_TrEst  C 003 0 SD2->D2_CLASFIS
Ind_T_Icms C 001 0 If(SF4->F4_LFICM=="T",1,If(SF4->F4_LFICM$"IN",2,3))
Aliq_Icms  N 005 2 SD2->D2_PICM
Vl_Bas_Icm N 017 2 SD2->D2_BASEICM
Vl_Icms_Pr N 017 2 SD2->D2_VALICM
Vl_Bas_Sub N 017 2 SD2->D2_BRICMS
Vl_Icm_Sub N 017 2 SD2->D2_ICMSRET
Ind_M_Fisi C 001 0 SF4->F4_ESTOQUE
(POS) FsQuery(_aTotal[90],2,_aTotal[91],_aTotal[99],_aTotal[98])

[SD1 Itens Mercadorias/Servicos - Entradas com Formulario Proprio - 432ITENSENTR.TXT]
(ARQ) 432ITENSENTR.TXT
(IMP) {.T.,1,1,"Indica_Mov"} 
(CMP) {{"Cod_d_Merc","Mercadoria/Servico"},{"Numero_Doc","Docto."},{"SerSub_Doc","Serie"},{"Modelo_Doc","Md"},{"Cod_CFOP","CFOP"},{"Vl_Total","Total"}}
(LEG) "Coluna(s): Md = Modelo do Documento"
(PRE) SB1->(dbSetOrder(1))
(PRE) SF1->(dbSetOrder(1))
(PRE) SF4->(dbSetOrder(1))
(PRE) SA1->(dbSetOrder(1))
(PRE) SA2->(dbSetOrder(1))
(PRE) _aTotal[90] := {"SD1",""}
(PRE) _aTotal[98] := SD1->(IndexKey())
(PRE) _aTotal[91] := "D1_FILIAL='"+xFilial("SD1")+"' AND D1_DTDIGIT>='"+ DTOS(MV_PAR01) +"' AND D1_DTDIGIT<='"+ DTOS(MV_PAR02) +"' AND D1_FORMUL='S'"
(PRE) _aTotal[99] := "D1_FILIAL=='"+xFilial("SD1")+"' .And. DTOS(D1_DTDIGIT)>='"+ DTOS(MV_PAR01) +"' .And. DTOS(D1_DTDIGIT)<='"+ DTOS(MV_PAR02) +"' .And. D1_FORMUL=='S'"
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) DbGoTop()
(PREREG) !SUBS(ALLTRIM(SD1->D1_CF),1,1)$"3/7"
(PREREG) SD1->D1_FORMUL=="S"
(PREREG) SF4->(MsSeek(xFilial("SF4")+SD1->D1_TES))
(PREREG) SF4->F4_ISS <> "S"
(PREREG) SB1->(MsSeek(xFilial("SB1")+SD1->D1_COD))
(PREREG) SF1->(MsSeek(xFilial("SF1")+SD1->D1_DOC+SD1->D1_SERIE+SD1->D1_FORNECE+SD1->D1_LOJA))
(PREREG) IIF(!SD1->D1_TIPO$"DB",SA2->(MsSeek(xFilial("SA2")+SD1->D1_FORNECE+SD1->D1_LOJA)),SA1->(MsSeek(xFilial("SA1")+SD1->D1_FORNECE+SD1->D1_LOJA)))
Indica_Mov C 001 0 "E"
Modelo_Doc C 002 0 AModNot(SF1->F1_ESPECIE)
SerSub_Doc C 005 0 SerieNfId("SD1",2,"D1_SERIE")
Numero_Doc C 006 0 RetNf(SD1->D1_DOC,6,"C")
Dt_Emi_Doc C 008 0 DataInt(SD1->D1_EMISSAO)
Numero_Ite C 003 0 SUBS(SD1->D1_ITEM,2,4)
Cod_d_Merc C 020 0 SD1->D1_COD
Desc_Compl C 045 0 SB1->B1_DESC
Cod_CFOP   C 003 0 SUBS(SD1->D1_CF,1,3)
Cod_Nat_Op C 006 0 SD1->D1_CF
Cod_ClaFis C 008 0 SB1->B1_POSIPI
Quantidade N 017 3 SD1->D1_QUANT
Unidade    C 003 0 Subs(SD1->D1_UM,1,3)
Vl_Unitari N 017 4 (SD1->D1_TOTAL-SD1->D1_VALDESC)/SD1->D1_QUANT
Vl_Total   N 017 2 (SD1->D1_TOTAL-SD1->D1_VALDESC)
Vl_DescIte N 017 2 SD1->D1_VALDESC
Indica_Ipi C 001 0 If(SF4->F4_LFIPI=="T",1,If(SF4->F4_LFIPI$"IN",2,3))
Aliquo_Ipi N 005 2 SD1->D1_IPI
BaseCalIpi N 017 2 If(SD1->D1_IPI>0,SD1->D1_VALIPI/(SD1->D1_IPI/100),0)
Vl_Ipi     N 017 2 SD1->D1_VALIPI
Sit_TrEst  C 003 0 SD1->D1_CLASFIS
Ind_T_Icms C 001 0 If(SF4->F4_LFICM=="T",1,If(SF4->F4_LFICM$"IN",2,3))
Aliq_Icms  N 005 2 SD1->D1_PICM
Vl_Bas_Icm N 017 2 SD1->D1_BASEICM
Vl_Icms_Pr N 017 2 SD1->D1_VALICM                                                
Vl_Bas_Sub N 017 2 SD1->D1_BRICMS                                                
Vl_Icm_Sub N 017 2 SD1->D1_ICMSRET                                        
Ind_M_Fisi C 001 0 SF4->F4_ESTOQUE
(POS) FsQuery(_aTotal[90],2,_aTotal[91],_aTotal[99],_aTotal[98])

[SF1 Mercadorias/Servicos - Entradas de Terceiros - 433SERVENTR.TXT]
(ARQ) 433SERVENTR.TXT   
(IMP) {.T.,1,1,"Modelo_Doc"} 
(CMP) {{"Numero_Doc","Docto."},{"Serie_Sub","Serie"},{"Modelo_Doc","Md"},{"Dt_Entrada","Entrada"},{"Vl_Tot_NF","Total NF"}}
(LEG) "Coluna(s): Md = Modelo do Documento"
(PRE) SA1->(dbSetOrder(1))
(PRE) SA2->(dbSetOrder(1))
(PRE) SF3->(dbSetOrder(1))
(PRE) _aTotal[90] := {"SF1",""}
(PRE) _aTotal[98] := SF1->(IndexKey())
(PRE) _aTotal[91] := "F1_FILIAL='"+xFilial("SF1")+"' AND F1_DTDIGIT>='"+ DTOS(MV_PAR01) +"' AND F1_DTDIGIT<='"+ DTOS(MV_PAR02) +"' AND F1_FORMUL<>'S' AND F1_ISS=0"
(PRE) _aTotal[99] := "F1_FILIAL=='"+xFilial("SF1")+"' .And. DTOS(F1_DTDIGIT)>='"+ DTOS(MV_PAR01) +"' .And. DTOS(F1_DTDIGIT)<='"+ DTOS(MV_PAR02) +"'.AND.F1_FORMUL<>'S' .And. Empty(F1_ISS)"
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) DbGoTop()
(PREREG) IIF(!SF1->F1_TIPO$"DB",SA2->(MsSeek(xFilial("SA2")+SF1->F1_FORNECE+SF1->F1_LOJA)),SA1->(MsSeek(xFilial("SA1")+SF1->F1_FORNECE+SF1->F1_LOJA)))
(PREREG) (SE4->(MsSeek(xFilial("SE4")+SF1->F1_COND)),.T.)
(PREREG) SF3->(MsSeek(xFilial("SF1")+DTOS(SF1->F1_DTDIGIT)+SF1->F1_DOC+SF1->F1_SERIE+SF1->F1_FORNECE+SF1->F1_LOJA))
(PREREG) !SUBS(ALLTRIM(SF3->F3_CFO),1,1)$"3/7"
Modelo_Doc C 002 0 AModNot(SF1->F1_ESPECIE)
Serie_Sub  C 005 0 SerieNfId("SF1",2,"F1_SERIE")
Numero_Doc C 006 0 RetNf(SF1->F1_DOC,6,"C")
Dt_Emi_Doc C 008 0 DataInt(SF1->F1_EMISSAO)
Cod_Partic C 014 0 If(SF1->F1_TIPO$"DB",SPACE(14-LEN(ALLTRIM(SA1->A1_CGC)))+ALLTRIM(SA1->A1_CGC),SPACE(14-LEN(ALLTRIM(SA2->A2_CGC)))+ALLTRIM(SA2->A2_CGC))
Dt_Entrada C 008 0 DataInt(SF1->F1_DTDIGIT)
Vl_TotMerc N 017 2 SF1->F1_VALMERC
Vl_TotDesc N 017 2 SF1->F1_DESCONT
Vl_TotFret N 017 2 SF1->F1_FRETE
Vl_TotSegu N 017 2 SF1->F1_SEGURO
Vl_TotOutr N 017 2 SF1->F1_DESPESA
Vl_TotIPI  N 017 2 SF1->F1_VALIPI
Vl_Icm_Sub N 017 2 SF1->F1_ICMSRET
Vl_Tot_NF  N 017 2 SF1->F1_VALBRUT
InscEstSub C 014 0 If(SF1->F1_TIPO$"DB" .AND. SF1->F1_ICMSRET>0 ,SA1->A1_INSCR,SA2->A2_INSCR)
Tipo_Fatur C 001 0 If(Alltrim(SE4->E4_COND)=="0","1","2")
Observacao C 045 0 SPACE(45)
(POS) FsQuery(_aTotal[90],2,_aTotal[91],_aTotal[99],_aTotal[98])

[SD1 Itens Mercadorias/Servicos - Entradas de Terceiros - 434ITENSERV.TXT]
(ARQ) 434ITENSERV.TXT     
(IMP) {.T.,1,1,"Modelo_Doc"} 
(CMP) {{"Numero_Doc","Docto."},{"SerSub_Doc","Serie"},{"Modelo_Doc","Md"},{"Dt_Emi_Doc","Emissao"},{"Cod_d_Merc","Mercadoria/Servico"},{"Quantidade","Quantidade"},{"Unidade","UM"},{"Vl_Total","Valor Total"}}      
(LEG) "Coluna(s): Md = Modelo do Documento / UM = Unidade de Medida"
(PRE) SF4->(dbSetOrder(1))
(PRE) SB1->(dbSetOrder(1))
(PRE) SF1->(dbSetOrder(1))
(PRE) SA1->(dbSetOrder(1))
(PRE) SA2->(dbSetOrder(1))
(PRE) _aTotal[90] := {"SD1",""}
(PRE) _aTotal[98] := SD1->(IndexKey())		                         
(PRE) _aTotal[91] := "D1_FILIAL='"+xFilial("SD1")+"' AND D1_DTDIGIT>='"+ DTOS(MV_PAR01) +"' AND D1_DTDIGIT<='"+ DTOS(MV_PAR02) +"' AND D1_FORMUL<>'S'"
(PRE) _aTotal[99] := "D1_FILIAL=='"+xFilial("SD1")+"' .And. DTOS(D1_DTDIGIT)>='"+ DTOS(MV_PAR01) +"' .And. DTOS(D1_DTDIGIT)<='"+ DTOS(MV_PAR02) +"' .And. D1_FORMUL<>'S'"
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) DbGoTop()
(PREREG) !SUBS(ALLTRIM(SD1->D1_CF),1,1)$"3/7"
(PREREG) SF4->(MsSeek(xFilial("SF4")+SD1->D1_TES))
(PREREG) SF4->F4_ISS <> "S"
(PREREG) SB1->(MsSeek(xFilial("SB1")+SD1->D1_COD))
(PREREG) SF1->(MsSeek(xFilial("SF1")+SD1->D1_DOC+SD1->D1_SERIE+SD1->D1_FORNECE+SD1->D1_LOJA))
(PREREG) IIF(!SD1->D1_TIPO$"DB",SA2->(MsSeek(xFilial("SA2")+SD1->D1_FORNECE+SD1->D1_LOJA)),SA1->(MsSeek(xFilial("SA1")+SD1->D1_FORNECE+SD1->D1_LOJA)))
(PREREG) SF1->F1_ISS == 0 .Or. Empty(SF1->F1_ISS)
Modelo_Doc C 002 0 AModNot(SF1->F1_ESPECIE)
SerSub_Doc C 005 0 SerieNfId("SD1",2,"D1_SERIE")
Numero_Doc C 006 0 RetNf(SD1->D1_DOC,6,"C")
Dt_Emi_Doc C 008 0 DataInt(SD1->D1_EMISSAO)
Cod_Partic C 014 0 If(SD1->D1_TIPO$"DB",SPACE(14-LEN(ALLTRIM(SA1->A1_CGC)))+ALLTRIM(SA1->A1_CGC),SPACE(14-LEN(ALLTRIM(SA2->A2_CGC)))+ALLTRIM(SA2->A2_CGC))
Numero_Ite C 003 0 SD1->D1_ITEM
Cod_d_Merc C 020 0 SD1->D1_COD
Desc_Compl C 045 0 SB1->B1_DESC
Cod_CFOP   C 003 0 SUBS(SD1->D1_CF,1,3)
Cod_Nat_Op C 006 0 SD1->D1_CF
Cod_ClaFis C 008 0 SB1->B1_POSIPI
Quantidade N 017 3 SD1->D1_QUANT
Unidade    C 003 0 Subs(SD1->D1_UM,1,3)
Vl_Unitari N 017 4 (SD1->D1_TOTAL-SD1->D1_VALDESC)/SD1->D1_QUANT
Vl_Total   N 017 2 SD1->D1_TOTAL-SD1->D1_VALDESC
Vl_DescIte N 017 2 SD1->D1_VALDESC
Indica_Ipi C 001 0 If(SF4->F4_LFIPI=="T",1,If(SF4->F4_LFIPI$"IN",2,3))
Aliquo_Ipi N 005 2 SD1->D1_IPI
BaseCalIpi N 017 2 If(SD1->D1_IPI>0,SD1->D1_VALIPI/(SD1->D1_IPI/100),0)
Vl_Ipi     N 017 2 SD1->D1_VALIPI
Sit_TrEst  C 003 0 SD1->D1_CLASFIS
Ind_T_Icms C 001 0 If(SF4->F4_LFICM=="T",1,If(SF4->F4_LFICM$"IN",2,3))
Aliq_Icms  N 005 2 SD1->D1_PICM
Vl_Bas_Icm N 017 2 SD1->D1_BASEICM
Vl_Icms_Pr N 017 2 SD1->D1_VALICM                                                
Vl_Bas_Sub N 017 2 SD1->D1_BRICMS                                                
Vl_Icm_Sub N 017 2 SD1->D1_ICMSRET                                        
Ind_M_Fisi C 001 0 SF4->F4_ESTOQUE
(POS) FsQuery(_aTotal[90],2,_aTotal[91],_aTotal[99],_aTotal[98])

[SF3 Mestre de Servicos Emitidos - 435NFSERV.TXT]
(ARQ) 435NFSERV.TXT
(IMP) {.T.,1,1,"Serie_Sub"} 
(CMP) {{"Numero_Doc","Docto."},{"Serie_Sub","Serie"},{"Dt_Emi_Doc","Emissao"},{"Vl_TotServ","Valor Servico"},{"Vl_TotDesc","Desconto"}}
(PRE) SF3->(dbSetOrder(1))
(PRE) SF2->(dbSetOrder(2))
(PRE) SA1->(dbSetOrder(1))
(PRE) _aTotal[90] := {"SF3",""}
(PRE) _aTotal[98] := SF3->(IndexKey())		                         
(PRE) _aTotal[91] := "F3_FILIAL='"+xFilial("SF3")+"' AND F3_ENTRADA>='"+ DTOS(MV_PAR01) +"' AND F3_ENTRADA<='"+ DTOS(MV_PAR02) +"' AND F3_TIPO='S' AND (F3_CFO LIKE '5%' OR F3_CFO LIKE '6%')" 
(PRE) _aTotal[99] := "F3_FILIAL=='"+xFilial("SF3")+"' .And. DTOS(F3_ENTRADA)>='"+ DTOS(MV_PAR01) +"' .And. DTOS(F3_ENTRADA)<='"+ DTOS(MV_PAR02) +"' .And. F3_TIPO=='S' .And. SUBS(F3_CFO,1,1)>='5' .And. SUBS(F3_CFO,1,1)<='6'"
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) DbGoTop()
(PREREG) !SUBS(ALLTRIM(SF3->F3_CFO),1,1)$"3/7"
(PREREG) SF2->(MsSeek(xFilial("SF2")+SF3->F3_CLIEFOR+SF3->F3_LOJA+SF3->F3_NFISCAL+SF3->F3_SERIE))
(PREREG) IiF(SF3->F3_TIPO$"DB",SA2->(MsSeek(xFilial("SA2")+SF3->F3_CLIEFOR+SF3->F3_LOJA)),SA1->(MsSeek(xFilial("SA1")+SF3->F3_CLIEFOR+SF3->F3_LOJA)))
Serie_Sub  C 005 0 SerieNfId("SF3",2,"F3_SERIE")
Numero_Doc C 006 0 RetNf(SF3->F3_NFISCAL,6,"C")
Dt_Emi_Doc C 008 0 DataInt(SF3->F3_ENTRADA)
Cod_Partic C 014 0 space(14-len(alltrim(SA1->A1_CGC)))+alltrim(SA1->A1_CGC)
Vl_TotServ N 017 2 SF2->F2_VALMERC
Vl_TotDesc N 017 2 SF2->F2_DESCONT
Aliq_IRRF  N 005 2 0
BaseC_IRRF N 017 2 0
Vl_IRRF    N 017 2 SF2->F2_VALIRRF
BaseC_INSS N 017 2 SF2->F2_BASEINS
Vl_INSS    N 017 2 SF2->F2_VALINSS
Ind_Cancel C 001 0 If(!Empty(SF3->F3_DTCANC),"S","N")
(POS) FsQuery(_aTotal[90],2,_aTotal[91],_aTotal[99],_aTotal[98])

[SD2 Itens das NFs de Servico Emitidas - 436ITESERVE.TXT]
(ARQ) 436ITESERVE.TXT
(IMP) {.T.,1,1,"Serie_Sub"} 
(CMP) {{"Numero_Doc","Docto."},{"Serie_Sub","Serie"},{"Dt_Emi_Doc","Emissao"},{"Vl_Servico","Valor Servico"},{"Vl_Descont","Desconto"}}
(PRE) SA1->(dbSetOrder(1))
(PRE) SF4->(dbSetOrder(1))
(PRE) _aTotal[90] := {"SD2",""}
(PRE) _aTotal[98] := SD2->(IndexKey())
(PRE) _aTotal[91] := "D2_FILIAL='"+xFilial("SD2")+"' AND D2_EMISSAO>='"+DTOS(MV_PAR01)+"' AND D2_EMISSAO<='"+DTOS(MV_PAR02)+"' AND (D2_CF LIKE '5%' OR D2_CF LIKE '6%') "
(PRE) _aTotal[99] := "D2_FILIAL=='"+ xFilial("SD2") +"'.And.DTOS(D2_EMISSAO)>='"+DTOS(MV_PAR01)+"'.And.DTOS(D2_EMISSAO)<='"+ DTOS(MV_PAR02) +"' .And. SUBS(D2_CF,1,1)>='5' .And. SUBS(D2_CF,1,1)<='6'"
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) DbGoTop()
(PREREG) !SUBS(ALLTRIM(SD2->D2_CF),1,1)$"3/7"
(PREREG) SF4->(MsSeek(xFilial("SF4")+SD2->D2_TES))
(PREREG) SF4->F4_ISS == "S"
Serie_Sub  C 005 0 SerieNfId("SD2",2,"D2_SERIE")
Numero_Doc C 006 0 RetNf(SD2->D2_DOC,6,"C")
Dt_Emi_Doc C 008 0 DataInt(SD2->D2_EMISSAO)
Numero_Ite C 003 0 SD2->D2_ITEM
Cod_Servic C 020 0 SD2->D2_CODISS
Desc_Compl C 045 0 SPACE(45)
Vl_Servico N 017 2 SD2->D2_TOTAL
Vl_Descont N 017 2 SD2->D2_DESCON
Aliq_ISS   N 005 2 Iif (SD2->D2_ALIQISS==0, SD2->D2_PICM, SD2->D2_ALIQISS)
BaseC_ISS  N 017 2 Iif (SD2->D2_BASEISS==0, SD2->D2_BASEICM, SD2->D2_BASEISS)
Vl_ISS     N 017 2 Iif (SD2->D2_VALISS==0, SD2->D2_VALICM, SD2->D2_VALISS)
(POS) FsQuery(_aTotal[90],2,_aTotal[91],_aTotal[99],_aTotal[98])

[SF3 Notas Fiscais de Servico Emitidas por Terceiros - 437NFSERVTER.TXT]
(ARQ) 437NFSERVTER.TXT
(IMP) {.T.,1,1,"Cod_Conta"} 
(CMP) {{"Numero_Doc","Docto."},{"Dt_Emi_Doc","Emissao"},{"Vl_Total","Total"},{"Cod_Serv","Servico"},{"Vl_Servico","Vl. Servico"}}
(PRE) SF3->(dbSetOrder(1))
(PRE) SF1->(dbSetOrder(2))
(PRE) SA1->(dbSetOrder(1))
(PRE) SA2->(dbSetOrder(1))
(PRE) _aTotal[90] := {"SF3",""}
(PRE) _aTotal[98] := SF3->(IndexKey())		                         
(PRE) _aTotal[91] := "F3_FILIAL='"+xFilial("SF3")+"' AND F3_ENTRADA>='"+ DTOS(MV_PAR01) +"' AND F3_ENTRADA<='"+ DTOS(MV_PAR02) +"' AND F3_TIPO='S' AND (F3_CFO LIKE '1%' OR F3_CFO LIKE '2%') AND F3_FORMUL<>'S'"
(PRE) _aTotal[99] := "F3_FILIAL=='"+xFilial("SF3")+"' .And. DTOS(F3_ENTRADA)>='"+ DTOS(MV_PAR01) +"' .And. DTOS(F3_ENTRADA)<='"+ DTOS(MV_PAR02) +"' .And. F3_TIPO=='S' .And. SUBSTR(F3_CFO,1,1)$'12' .And. F3_FORMUL<>'S'"
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) SF3->(DbGoTop())
(PREREG) SF1->(MsSeek(xFilial("SF1")+SF3->F3_CLIEFOR+SF3->F3_LOJA+SF3->F3_NFISCAL))
(PREREG) IiF(!SF3->F3_TIPO$"DB",SA2->(MsSeek(xFilial("SA2")+SF3->F3_CLIEFOR+SF3->F3_LOJA)),SA1->(MsSeek(xFilial("SA1")+SF3->F3_CLIEFOR+SF3->F3_LOJA)))
Cod_Conta  C 028 0 Iif(!SF3->F3_TIPO$"DB",SA2->A2_CONTA,SA1->A1_CONTA)
Cod_Partic C 014 0 Iif(!SF3->F3_TIPO$"DB",Space(14-Len(Alltrim(SA2->A2_CGC)))+Alltrim(SA2->A2_CGC),Space(14-Len(Alltrim(SA1->A1_CGC)))+Alltrim(SA1->A1_CGC))
Tipo_Doc   C 003 0 "NF"
Numero_Doc C 012 0 SF3->F3_NFISCAL
Dt_Emi_Doc C 008 0 DataInt(SF3->F3_ENTRADA)
Vl_Total   N 017 2 SF1->F1_VALBRUT - SF1->F1_DESCONT
Cod_Serv   C 020 0 F3_CODISS
Desc_Compl C 045 0 Iif(Empty(F3_CODISS),"SERVICO GERAL","")
Vl_Servico N 017 2 SF3->F3_VALCONT
Vl_Equipto N 017 2 Max(SF1->F1_VALMERC - SF3->F3_VALCONT,0)
Base_INSS  N 017 2 SF1->F1_BASEINS
Val_INSS   N 017 2 SF1->F1_INSS
(POS) FsQuery(_aTotal[90],2,_aTotal[91],_aTotal[99],_aTotal[98])

[SF3 Exportacoes - 441EXPORTAC.TXT]
(ARQ) 441EXPORTAC.TXT
(IMP) {.T.,1,1,"Modelo_Doc"} 
(CMP) {{"Modelo_Doc","Modelo"},{"Serie_Sub","Serie"},{"Numero_Doc","Numero"},{"Dt_Emi_Doc","Emissao"}}
(PRE) _aTotal[98] := SF3->(IndexKey())
(PRE) _aTotal[91] := "F3_FILIAL='"+ xFilial("SF3") +"' And F3_ENTRADA>='"+ DTOS(MV_PAR01) +"' And F3_ENTRADA<='"+ DTOS(MV_PAR02) +"' AND SUBSTRING(F3_CFO,1,1)='7' AND F3_DTCANC='"+Space(8)+"'"
(PRE) _aTotal[99] := "F3_FILIAL=='"+ xFilial("SF3") +"' .and. DTOS(F3_ENTRADA)>='"+ DTOS(MV_PAR01) +"' .and. DTOS(F3_ENTRADA)<='"+ DTOS(MV_PAR02) +"' .And. SUBS(SF3->F3_CFO,1,1)=='7'.AND.DTOS(F3_DTCANC)=='"+Space(8)+"'"
(PRE) _aTotal[90] := {"SF3",""}
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) DbGoTop()
Modelo_Doc C 002 0 AModNot(SF3->F3_ESPECIE)
Serie_Sub  C 005 0 SerieNfId("SF3",2,"F3_SERIE")
Numero_Doc C 006 0 RetNf(SF3->F3_NFISCAL,6,"C")
Dt_Emi_Doc C 008 0 DataInt(SF3->F3_EMISSAO)
Numero_RE  N 011 0 0
Numero_DDE N 012 0 0
(POS) FsQuery(_aTotal[90],2,_aTotal[91],_aTotal[99],_aTotal[98])

[SF3 Importacoes - 442IMPORTAC.TXT]
(ARQ) 442IMPORTAC.TXT
(IMP) {.T.,1,1,"Modelo_Doc"} 
(CMP) {{"Modelo_Doc","Modelo"},{"Serie_Sub","Serie"},{"Numero_Doc","Numero"},{"Dt_Emi_Doc","Emissao"}}
(PRE) _aTotal[90] := {"SF3",""}
(PRE) _aTotal[91] := "F3_FILIAL='"+ xFilial("SF3") +"' And F3_ENTRADA>='"+ DTOS(MV_PAR01) +"' And F3_ENTRADA<='"+ DTOS(MV_PAR02) +"' AND SUBSTRING(F3_CFO,1,1)='3' AND F3_DTCANC='"+Space(8)+"'"
(PRE) _aTotal[98] := SF3->(IndexKey())
(PRE) _aTotal[99] := "F3_FILIAL=='"+ xFilial("SF3") +"' .and. DTOS(F3_ENTRADA)>='"+ DTOS(MV_PAR01) +"' .and. DTOS(F3_ENTRADA)<='"+ DTOS(MV_PAR02) +"' .And. SUBS(SF3->F3_CFO,1,1)=='3'.AND.DTOS(F3_DTCANC)=='"+Space(8)+"'"
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) DbGoTop()
Modelo_Doc C 002 0 AModNot(SF3->F3_ESPECIE)
Serie_Sub  C 005 0 SerieNfId("SF3",2,"F3_SERIE")
Numero_Doc C 006 0 RetNf(SF3->F3_NFISCAL,6,"C")
Dt_Emi_Doc C 008 0 DataInt(SF3->F3_EMISSAO)
Numero_DI  N 010 0 0
(POS) FsQuery(_aTotal[90],2,_aTotal[91],_aTotal[99],_aTotal[98])

[SD1 Registro de Estoque - 451RESTOQU1.TXT]
(ARQ) 451RESTOQU1.TXT
(IMP) {.T.,1,1,"Cod_Merc"} 
(CMP) {{"Cod_Merc","Mercadoria/Servico"},{"Unidade","UM"},{"NumDoc","Documento"},{"Dt_Movto","Data"},{"Quantidade","Quantidade"},{"ValorTotal","Valor Total"}}
(LEG) "Coluna(s): UM = Unidade de Medida"
(PRE) _aTotal[94] := CriaTrab(nil,.f.)
(PRE) SF1->(dbSetOrder(1))
(PRE) SF4->(dbsetorder(1))
(PRE) SB1->(dbSetOrder(1))
(PRE) _aTotal[90] := {"SD1",""}
(PRE) _aTotal[98] := SD1->(IndexKey())		                         
(PRE) _aTotal[91] := "D1_FILIAL='"+xFilial("SD1")+"' AND D1_DTDIGIT>='"+ DTOS(MV_PAR01) +"' AND D1_DTDIGIT<='"+ DTOS(MV_PAR02) +"'"
(PRE) _aTotal[99] := "D1_FILIAL=='"+xFilial("SD1")+"' .And. DTOS(D1_DTDIGIT)>='"+ DTOS(MV_PAR01) +"' .And. DTOS(D1_DTDIGIT)<='"+ DTOS(MV_PAR02) +"'"
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) DbGoTop()
(PREREG) !SUBS(ALLTRIM(SD1->D1_CF),1,1)$"3/7"
(PREREG) SD1->D1_ORIGLAN <> "LF" .AND. !SD1->D1_TIPO$"ICP"
(PREREG) SB1->(MsSeek(xFilial("SB1")+SD1->D1_COD))
(PREREG) SF1->(MsSeek(xFilial("SF1")+SD1->D1_DOC+SD1->D1_SERIE+SD1->D1_FORNECE+SD1->D1_LOJA))
(PREREG) SF4->(MsSeek(xFilial("SF4")+SD1->D1_TES))
(PREREG) SF4->F4_ESTOQUE == "S"
Cod_Merc   C 020 0 SD1->D1_COD
Natur_Doc  C 001 0 "F"
TipoDoc    C 003 0 SF1->F1_ESPECIE
Serie      C 005 0 SerieNfId("SD1",2,"D1_SERIE")
NumDoc     C 012 0 SD1->D1_DOC
Dt_Movto   C 008 0 DataInt(SD1->D1_DTDIGIT)
Historico  C 050 0 SPACE(50)
Unidade    C 003 0 SB1->B1_UM
Quantidade N 017 3 SD1->D1_QUANT
Tipo_Mov   C 001 0 "E"
Custo_Unit N 017 3 SD1->D1_CUSTO/SD1->D1_QUANT
ValorTotal N 017 2 (SD1->D1_TOTAL-SD1->D1_VALDESC)
(POS) FsQuery(_aTotal[90],2)

[SD2 Registro de Estoque - 451RESTOQU2.TXT]
(ARQ) 451RESTOQU2.TXT
(IMP) {.T.,1,1,"Cod_Merc"} 
(CMP) {{"Cod_Merc","Mercadoria/Servico"},{"NumDoc","Documento"},{"Dt_Movto","Data"},{"Unidade","UM"},{"Quantidade","Quantidade"},{"ValorTotal","Valor Total"}}
(LEG) "Codigo(s): UM = Unidade de Medida"
(PRE) SF2->(dbSetOrder(1))
(PRE) SF4->(dbsetorder(1))
(PRE) SB1->(dbSetOrder(1))
(PRE) _aTotal[98] := SD2->(IndexKey())		                         
(PRE) _aTotal[90] := {"SD2",""}
(PRE) _aTotal[91] := "D2_FILIAL='"+ xFilial("SD2") +"' AND D2_EMISSAO>='"+DTOS(MV_PAR01)+"' AND D2_EMISSAO<='"+DTOS(MV_PAR02)+"'"
(PRE) _aTotal[99] := "D2_FILIAL=='"+ xFilial("SD2") +"' .And. DTOS(D2_EMISSAO)>='"+ DTOS(MV_PAR01) +"' .And. DTOS(D2_EMISSAO)<='"+ DTOS(MV_PAR02) +"'"
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) DbGoTop()
(PREREG) !SUBS(ALLTRIM(SD2->D2_CF),1,1)$"3/7"
(PREREG) SD2->D2_ORIGLAN <> "LF" .AND. !(SD2->D2_TIPO$"CPI") 
(PREREG) SF2->(MsSeek(xFilial("SF2")+SD2->D2_DOC+SD2->D2_SERIE+SD2->D2_CLIENTE+SD2->D2_LOJA))
(PREREG) SF4->(MsSeek(xFilial("SF4")+SD2->D2_TES))
(PREREG) SB1->(MsSeek(xFilial("SB1")+SD2->D2_COD))
(PREREG) SF4->F4_ESTOQUE == "S"
Cod_Merc   C 020 0 SD2->D2_COD
Natur_Doc  C 001 0 "F"
TipoDoc    C 003 0 SF2->F2_ESPECIE
Serie      C 005 SerieNfId("SD2",2,"D2_SERIE")
NumDoc     C 012 0 SD2->D2_DOC
Dt_Movto   C 008 0 DataInt(SD2->D2_EMISSAO)
Historico  C 050 0 SPACE(50)
Unidade    C 003 0 SB1->B1_UM
Quantidade N 017 2 SD2->D2_QUANT
Tipo_Mov   C 001 0 "S"
Custo_Unit N 017 3 SD2->D2_CUSTO1/SD2->D2_QUANT
ValorTotal N 017 2 SD2->D2_TOTAL
(POS) FsQuery(_aTotal[90],2)

[SD3 Registro de Estoque - 451RESTOQU3.TXT]
(ARQ) 451RESTOQU3.TXT
(IMP) {.T.,1,1,"Cod_Merc"} 
(CMP) {{"Cod_Merc","Mercadoria/Servico"},{"NumDoc","Documento"},{"Dt_Movto","Data"},{"Unidade","UM"},{"Quantidade","Quantidade"},{"ValorTotal","Valor Total"}}
(LEG) "Codigo(s): UM = Unidade de Medida"
(PRE) SB1->(dbSetOrder(1))
(PRE) _aTotal[98] := SD3->(IndexKey())		                         
(PRE) _aTotal[90] := {"SD3",""}
(PRE) _aTotal[91] := "D3_FILIAL='"+ xFilial("SD3") +"' AND D3_EMISSAO>='"+DTOS(MV_PAR01)+"' AND D3_EMISSAO<='"+DTOS(MV_PAR02)+"'"
(PRE) _aTotal[99] := "D3_FILIAL=='"+ xFilial("SD3") +"' .And. DTOS(D3_EMISSAO)>='"+ DTOS(MV_PAR01) +"' .And. DTOS(D3_EMISSAO)<='"+ DTOS(MV_PAR02) +"'"
(PRE) FsQuery(_aTotal[90],1,_aTotal[91],_aTotal[99],_aTotal[98])
(PRE) DbGoTop()
(PREREG) SB1->(MsSeek(xFilial("SB1")+SD3->D3_COD))
Cod_Merc   C 020 0 SD3->D3_COD
Natur_Doc  C 001 0 "I"
TipoDoc    C 003 0 "NF "
Serie      C 005 0 SPACE(05)
NumDoc     C 012 0 SD3->D3_DOC
Dt_Movto   C 008 0 DataInt(SD3->D3_EMISSAO)
Historico  C 050 0 SPACE(50)
Unidade    C 003 0 SB1->B1_UM
Quantidade N 017 2 SD3->D3_QUANT
Tipo_Mov   C 001 0 IF(Val(SD3->D3_TM) > 500,"S","E")
Custo_Unit N 017 3 SD3->D3_CUSTO1/SD3->D3_QUANT
ValorTotal N 017 2 SD3->D3_CUSTO1
(POS) FsQuery(_aTotal[90],2)

[INV Registro de Inventario - 452INVENTAR.TXT]
(ARQ) 452INVENTAR.TXT
(IMP) {.T.,1,1,"Dt_Invent"} 
(CMP) {{"Dt_Invent","Data"},{"Cod_Merc","Mercadoria/Servico"},{"Unidade","UM"},{"Quantidade","Quantidade"},{"Vl_Total","Total"}}
(LEG) "Codigo(s): UM = Unidade de Medida"
(PRE) dbGoTop()
Dt_Invent  C 008 0 DataInt(SuperGetMv ("MV_ULMES"))
Sit_Estoq  C 001 0 AFISFill(INV->SITUACA,1)
Cod_Merc   C 020 0 AFISFill(INV->CODIGO,20)
Unidade    C 003 0 SubStr (INV->UM, 1, 3)
Quantidade N 017 3 INV->QUANT                  
Vl_Total   N 017 2 INV->CUSTO
(POS) FsEstInv (_aTotal[77],2)

[SG1 Relacao Insumos / Produto - 461INSUMOS.TXT]
(ARQ) 461INSUMOS.TXT      
(IMP) {.T.,1,1,"CodProduto"} 
(CMP) {{"CodProduto","Codigo"},{"Unidade","UM"},{"Cod_Insumo","Insumo"},{"Quantidade","Quantidade"}}
(LEG) "Codigo(s): UM = Unidade de Medida"
(PRE) SB1->(dbSetOrder(1))
(PRE) _aTotal[057] := ""
(PREREG) SB1->(MsSeek(xFilial("SB1")+SG1->G1_COD))
(PREREG) (_aTotal[057] := SB1->B1_UM, .T.)
(PREREG) SB1->(MsSeek(xFilial("SB1")+SG1->G1_COMP))
CodProduto C 020 0 SG1->G1_COD
Unidade    C 003 0 Subs(_aTotal[057],1,3)
Cod_Insumo C 020 0 SG1->G1_COMP
Quantidade N 017 3 SG1->G1_QUANT
PerclPerd  N 005 2 SG1->G1_PERDA
Unidade2   C 003 0 Subs(SB1->B1_UM,1,3)
Dt_Inicial C 008 0 DataInt(SG1->G1_INI)
Dt_Final   C 008 0 DataInt(SG1->G1_FIM)

[SN3 Ativo Fixo - 471ATIVO.TXT]
(ARQ) 471ATIVO.TXT
(IMP) {.T.,1,1,"NumCadBens"} 
(CMP) {{"NumCadBens","Cadastro"},{"IdentBem","Descricao"},{"CtaBem","Conta"},{"CtaDeprAcu","Conta Deprec."},{"TxDeprec","Taxa Deprec."},{"DtaBaixa","Baixa"}}
(PRE) SN1->(dbSetOrder(1))
(PREREG) SN1->(MsSeek(xFilial("SN1")+SN3->N3_CBASE+SN3->N3_ITEM))
NumCadBens C 020 0 SN3->N3_CBASE+SN3->N3_ITEM
NatBem     C 001 0 "1"
NumBemPrin C 020 0 SPACE(20)
IdentBem   C 045 0 SN1->N1_DESCRIC
CtaBem     C 028 0 SN3->N3_CCONTAB
CtaDeprAcu C 028 0 SN3->N3_CCDEPR
DtaAquis   C 008 0 DataInt(SN3->N3_AQUISIC)
Tipo_Doc   C 003 0 "NF "
Num_Serie  C 005 0 SerieNfId("SN1",2,"N1_NSERIE") 
Ndoc_Aquis C 012 0 SN1->N1_NFISCAL
Val_Aquis  N 017 2 SN3->N3_VORIG1
Val_Reais  N 017 2 SN3->N3_VORIG1
Identifica C 012 0 SN1->N1_CHAPA
DtaIniDepr C 008 0 DataInt(SN3->N3_DINDEPR)
TxDeprec   N 005 2 SN3->N3_TXDEPR1
Vl_depracm N 017 2 SN3->N3_VRDACM1
Vl_deprper N 017 2 SN3->N3_VRDBAL1
DtaBaixa   C 008 0 DataInt(SN3->N3_DTBAIXA)

[SRA Cadastro de Empregados - 491TRABALHA.TXT]
(ARQ) 491TRABALHA.TXT
(IMP) {.T.,1,1,"DtaAtuali"} 
(CMP) {{"NumRegEmpr","Matricula"},{"Cpf","CPF"},{"NomeComp","Nome"},{"DtaAdmis","Admissao"},{"DtaDemis","Demissao"}}
(PRE) SRA->(dbGoTop())
(PRE) SRJ->(dbSetOrder(1))
(PRE) _aTotal[059] := CriaSRDTemp(1)
(PRE) _aTotal[060] := If( substr(MesAno(MV_PAR02),5,2)=="12",Substr(MesAno(MV_PAR02),1,4)+"13",MesAno(MV_PAR02) )
(PRE) _aTotal[067] := "!!"
(PRE) FsQuery({"SRA",""},1,"RA_FILIAL>='"+_aTotal[009][1][1]+"' AND RA_FILIAL<='"+ _aTotal[009][1][2]	+"'","RA_FILIAL>='"+_aTotal[009][1][1]+"' .AND. RA_FILIAL<='"+ _aTotal[009][1][2]	+"'","RA_FILIAL+RA_MAT")
(PREREG) If( SRA->RA_FILIAL # _ATOTAL[67], FP_CODFOL (@_aTotal[13], SRA->RA_FILIAL),.T.)
(PREREG) SRJ->(MsSeek(xFilial("SRJ")+SRA->RA_CODFUNC))
(PREREG) If((_aTotal[03] := fBuscaACM(_aTotal[13,18,1],,mv_par01,mv_par02))>0,.T.,.T.)
(PREREG) _aTotal[062] := "RD_FILIAL='"+SRA->RA_FILIAL+"'AND RD_MAT ='"+SRA->RA_MAT	+"' AND RD_DATARQ >='"+MesAno(MV_PAR01)+"' AND RD_DATARQ<='"+ _aTotal[060]+"' AND RD_EMPRESA='"+ SPACE(02)+"'"
(PREREG) _aTotal[063] := "RD_FILIAL='"+SRA->RA_FILIAL+"'.AND. RD_MAT ='"+SRA->RA_MAT	+"' .AND. RD_DATARQ	>='"+MesAno(MV_PAR01)+"' .AND. RD_DATARQ<='"+ _aTotal[060]+"' .AND. RD_EMPRESA='"+ SPACE(02)+"'"
(PREREG) _aTotal[064] := "RD_FILIAL+RD_MAT+RD_DATARQ+RD_PD+RD_SEMANA+RD_SEQ+RD_CC"
(PREREG) _aTotal[065] := "('"+_aTotal[13,15,1]+"','"+_aTotal[13, 27,1]+"','"+_aTotal[13, 16,1]+"','"+_aTotal[13, 28,1]+"','"+_aTotal[13,151,1]+"','"+_aTotal[13,152,1]+"',"
(PREREG) _aTotal[065] := _aTotal[065]+"'"+ _aTotal[13, 13,1]+"','"+_aTotal[13,14,1]+"','"+_aTotal[13,221,1]+"','"+_aTotal[13,225, 1]+"','"+_aTotal[13,126, 1]+"','"+_aTotal[13, 29, 1]+	"',"
(PREREG) _aTotal[065] := _aTotal[065]+"'"+ _aTotal[13, 19,1]+"','"+_aTotal[13,20,1]+"','"+_aTotal[13, 18, 1]+"','"+_aTotal[13, 21, 1]+"','"+_aTotal[13, 47, 1]+"','"+_aTotal[13, 45, 1]+"')"
(PREREG) _aTotal[066] := {"RD_PD",_aTotal[065]}
(PREREG) _aTotal[065] := ""
(PREREG) FsQuery({"SRD",""},1,_aTotal[62],_aTotal[63],_aTotal[64],_aTotal[66])
(PREREG) MontaTMP(MesAno(MV_PAR01),_aTotal[060],.T.)
DtaAtuali  C 008 0 DataInt(SRA->RA_ADMISSA)
NumRegEmpr C 012 0 SRA->RA_MAT
Cpf        C 014 0 SRA->RA_CIC
PIS        C 011 0 strzero(val(SRA->RA_PIS),11)
Categ      C 002 0 fCateg(_aTotal[03])
NomeComp   C 070 0 SRA->RA_NOME
DtaNasc    C 008 0 DataInt(SRA->RA_NASC)
DtaAdmis   C 008 0 DataInt(SRA->RA_ADMISSA)
DtaDemis   C 008 0 DataInt(SRA->RA_DEMISSA)
(POSREG) _aTotal[003]:= 0
(POSREG) _aTotal[067] := SRA->RA_FILIAL
(POSREG) FsQuery({"SRD",""},2,_aTotal[62],_aTotal[63],_aTotal[64])
(POS) FsQuery({"SRA",""},2,"RA_FILIAL>='"+_aTotal[009][1][1]+"' AND RA_FILIAL<='"+ _aTotal[009][1][2]	+"'","RA_FILIAL>='"+_aTotal[009][1][1]+"' .AND. RA_FILIAL<='"+ _aTotal[009][1][2]	+"'","RD_FILIAL+RD_MAT")
(POS) SA1->(MsSeek(xFilial("SA1")))

[TMP Mestre Folha de Pagamento - 481FLMESTRE.TXT]
(ARQ) 481FLMESTRE.TXT
(IMP) {.T.,1,1,"TipoFolha"} 
(CMP) {{"TipoFolha","Tipo"},{"NumRegEmpr","Matricula"},{"DtaCompet","Compet."},{"nBaseIRRF","Base IR"},{"nBaseINSS","Base INSS"}}
(LEG) "Coluna(s): Compet. = Competencia"
(PRE) TMP->(dbGoTop())
(PREREG) Val(TMP->TMP_BS_IR) > 0 .or. val(TMP->TMP_BS_PS) >0
TipoFolha  C 001 0 TMP->TMP_INDFL
NumRegEmpr C 012 0 TMP->TMP_MAT
DtaCompet  C 008 0 "01"+If(SUBSTR(TMP->TMP_COMP,5,2)="13","12",SUBSTR(TMP->TMP_COMP,5,2))+ SUBSTR(TMP->TMP_COMP,1,4)
DtaPagto   C 008 0 TMP->TMP_PGTO
cCBO       C 007 0 TMP->TMP_CBO
nDepIR     C 003 0 TMP->TMP_DEP_IR
nDepSF     C 003 0 TMP->TMP_DEP_SF
nBaseIRRF  C 017 0 STRZERO(VAL(SUBSTR( TMP->TMP_BS_IR,1, At(",",TMP->TMP_BS_IR)-1) + SUBSTR( TMP->TMP_BS_IR, At(",",TMP->TMP_BS_IR)+1)),17)
nBaseINSS  C 017 0 STRZERO(VAL(SUBSTR( TMP->TMP_BS_PS,1, At(",",TMP->TMP_BS_PS)-1) + SUBSTR( TMP->TMP_BS_PS, At(",",TMP->TMP_BS_PS)+1)),17)
(POS) CriaSRDTemp(2)

[SRD Itens Folha de Pagamento - 482ItensFol.TXT]
(ARQ) 482ItensFol.TXT
(IMP) {.T.,1,1,"TipoFolha"} 
(CMP) {{"TipoFolha","Tipo"},{"NumRegEmpr","Matricula"},{"CodProv","CV"},{"ValProv","Valor"},{"IndIncIRR","IR"},{"IndIncINS","INSS"}}
(LEG) "Coluna(s): CV = Codigo da Verba"
(PRE) _aTotal[060] := If( substr(MesAno(MV_PAR02),5,2)=="12",Substr(MesAno(MV_PAR02),1,4)+"13",MesAno(MV_PAR02) )
(PRE) SRD->(dbGoTop())
(PRE) SRV->(dbSetOrder(1))
(PRE) _aTotal[62] := "RD_FILIAL>='"+_aTotal[009][1][1]	+"' AND RD_FILIAL<='"+ _aTotal[009][1][2]+"'  AND RD_DATARQ   >='"+MesAno(MV_PAR01)+"' AND RD_DATARQ<= '"+ _aTotal[060]   +"' AND RD_EMPRESA='"+ SPACE(02)+"'"
(PRE) _aTotal[63] := "RD_FILIAL>='"+_aTotal[009][1][1]	+"' .AND. RD_FILIAL<='"+ _aTotal[009][1][2]+"' .AND. RD_DATARQ	 >='"+MesAno(MV_PAR01)+"' .AND. RD_DATARQ<='"+ _aTotal[060] +"' .AND. RD_EMPRESA='"+ SPACE(02)+"'"
(PRE) _aTotal[64] := "RD_FILIAL+RD_MAT+RD_DATARQ+RD_PD+RD_SEMANA+RD_SEQ+RD_CC"
(PRE) FsQuery({"SRD",""},1,_aTotal[62],_aTotal[63],_aTotal[64])
(PREREG) SRV->(MsSeek(xFilial("SRV")+SRD->RD_PD))
(PREREG) SRV->RV_TIPOCOD # "3"
TipoFolha  C 001 0 fTp_Folha(SRD->RD_PD)
NumRegEmpr C 012 0 SRD->RD_MAT
DtaCompet  C 008 0 "01"+If(SUBSTR((SRD->RD_DATARQ),5,2)=="13","12",SUBSTR((SRD->RD_DATARQ),5,2))+ SUBSTR((SRD->RD_DATARQ),1,4)
CodProv    C 003 0 SRD->RD_PD
ValProv    N 017 2 SRD->RD_VALOR
IndProv    C 001 0 VERPD(SRD->RD_PD)
IndIncIRR  C 001 0 If(empty(SRV->RV_IR),"N",SRV->RV_IR)
IndIncINS  C 001 0 If(empty(SRV->RV_INSS),"N",SRV->RV_INSS)
(POS) FsQuery({"SRD",""},2,_aTotal[62],_aTotal[63],_aTotal[64])

[SA1 Cadastro de Clientes - 492CLIENTES.TXT]
(ARQ) 492CLIENTES.TXT
(IMP) {.T.,1,1,"DtaAtuali"} 
(CMP) {{"Data","U.Compra"},{"Participa","Participante"},{"Cnpj/Cpf","CNPJ/CPF"},{"Nome/Razao","Razao"}}
(LEG) "Coluna(s): U.Compra = Data da Ultima Compra"
Data       C 008 0 DataInt(SA1->A1_ULTCOM)
Participa  C 014 0 space(14-len(alltrim(SA1->A1_CGC)))+alltrim(SA1->A1_CGC)
Cnpj/Cpf   C 014 0 space(14-len(alltrim(SA1->A1_CGC)))+alltrim(SA1->A1_CGC)
INSS-CEI   C 012 0 space(12)
Inscricao  C 014 0 StrTran(StrTran(SA1->A1_INSCR,".",""),"-","")
Municipal  C 014 0 SA1->A1_INSCRM
Nome/Razao C 070 0 SA1->A1_NOME
Endereco   C 060 0 SA1->A1_END
Bairro     C 020 0 SA1->A1_BAIRRO
Municipio  C 020 0 SA1->A1_MUN
Estado     C 002 0 SA1->A1_EST
Pais       C 020 0 SA1->A1_PAIS
Cep        C 008 0 SA1->A1_CEP
(POS) SA2->(MsSeek(xFilial("SA2")))

[SA2 Cadastro de Fornecedores - 492FORNECED.TXT]
(ARQ) 492FORNECED.TXT
(IMP) {.T.,1,1,"DtaAtuali"} 
(CMP) {{"DtaAtuli","U.Compra"},{"Participa","Participante"},{"Cgc/Cpf","CNPJ/CPF"},{"NomRazSoc","Razao"}}
(LEG) "Coluna(s): U.Compra = Data da Ultima Compra"
DtaAtuli   C 008 0 DataInt(SA2->A2_ULTCOM)
Participa  C 014 0 space(14-len(alltrim(SA2->A2_CGC)))+alltrim(SA2->A2_CGC)
Cgc/Cpf    C 014 0 space(14-len(alltrim(SA2->A2_CGC)))+alltrim(SA2->A2_CGC)
INSS-CEI   C 012 0 space(12)
InscrEst   C 014 0 StrTran(StrTran(SA2->A2_INSCR,".",""),"-","")
InscrMun   C 014 0 SA2->A2_INSCRM
NomRazSoc  C 070 0 SA2->A2_NOME
NomLogra   C 060 0 SA2->A2_END
Bairro     C 020 0 SA2->A2_BAIRRO
Municipio  C 020 0 SA2->A2_MUN
Estado     C 002 0 SA2->A2_EST
Pais       C 020 0 SA2->A2_PAIS
Cep        C 008 0 SA2->A2_CEP

[SI1 Tabela Plano de Contas - 493PLANO.TXT]
(ARQ) 493PLANO.TXT
(IMP) {.T.,1,1,"DtaAtuali"} 
(CMP) {{"Cod_Conta","Codigo Conta"},{"Tip_Conta","T"},{"CodCta_Tot","Conta Superior"},{"Desc_Conta","Descricao"}}
(LEG) "Coluna(s): T = Tipo da Conta (A - Analitica / S - Sintetica)"
(PRE) SI1->(MsSeek(xFilial()))
Dt_Atualiz C 008 0 DataInt(dDataBase)
Cod_Conta  C 028 0 SI1->I1_CODIGO
Tip_Conta  C 001 0 SI1->I1_CLASSE
CodCta_Tot C 028 0 SI1->I1_CTASUP
Desc_Conta C 045 0 SI1->I1_DESC

[CT1 Tabela Plano de Contas - 493PLANO2.TXT]
(ARQ) 493PLANO2.TXT
(IMP) {.T.,1,1,"Data"} 
(CMP) {{"Conta","Codigo Conta"},{"TipoConta","T"},{"Conta","Conta Superior"},{"Descricao","Descricao"}}
(LEG) "Coluna(s): T = Tipo da Conta (A - Analitica / S - Sintetica)"
(PRE) CT1->(MsSeek(xFilial()))
Data       C 008 0 DataInt(dDataBase)
Conta      C 028 0 CT1->CT1_CONTA
TipoConta  C 001 0 If(CT1->CT1_CLASSE="1", "S", "A")
Conta      C 028 0 CT1->CT1_CTASUP
Descricao  C 045 0 CT1->CT1_DESC01

[SI3 Tabela Centro de Custo - 494CENTRO.TXT]
(ARQ) 494CENTRO.TXT
(IMP) {.T.,1,1,"Dt_Atualiz"} 
(CMP) {{"Cod_CCusto","Codigo"},{"Descricao","Descricao"}}
(PRE) SI3->(MsSeek(xFilial()))
Dt_Atualiz C 008 0 DataInt(dDataBase)
Cod_CCusto C 028 0 SI3->I3_CUSTO
Descricao  C 045 0 SI3->I3_DESC
             
[SX5 Tabela CFOP - 495CFOP.TXT]
(ARQ) 495CFOP.TXT
(IMP) {.T.,1,1,"Dt_Atualiz"} 
(CMP) {{"Cod_Nat_Op","CFOP"},{"Descricao","Descricao"}}
(PRE) SX5->(dbSetOrder(1))
(PRE) SX5->(dbSeek(xFilial("SX5")+"13"))
(PREREG) SX5->X5_TABELA=="13"
Dt_Atualiz C 008 0 DataInt(dDataBase)
Cod_Nat_Op C 006 0 SX5->X5_CHAVE
Descricao  C 045 0 SX5->X5_DESCRI

[SB1 Tabela Mercadorias/Servicos - 496PRODUTO.TXT]
(ARQ) 496PRODUTO.TXT
(PRE) SB1->(dbSetOrder(1)) 
(PRE) SB1->(MsSeek(xFilial("SB1")))
(IMP) {.T.,1,1,"Dt_Atualiz"} 
(CMP) {{"Cod_MeInSe","Mercadoria/Servico"},{"Descricao","Descricao"}}
Dt_Atualiz C 008 0 DataInt(dDataBase)
Cod_MeInSe C 020 0 SUBS(SB1->B1_COD,1,20)
Descricao  C 045 0 SUBS(SB1->B1_DESC,1,45)

[SX5 Tabela Mercadorias/Servicos - 496SERVICO.TXT]
(ARQ) 496SERVICO.TXT
(IMP) {.T.,1,1,"Dt_Atualiz"} 
(CMP) {{"Cod_MeInSe","Mercadoria/Servico"},{"Descricao","Descricao"}}
(PRE) SX5->(dbSetOrder(1))
(PRE) SX5->(dbSeek(xFilial("SX5")+"60"))
(PREREG) SX5->X5_TABELA=="60"
Dt_Atualiz C 008 0 DataInt(dDataBase)
Cod_MeInSe C 020 0 SX5->X5_CHAVE
Descricao  C 045 0 SUBS(SX5->X5_DESCRI,1,45)

[SRV Tabela Provento/Desconto - 497PROVDESC.TXT]
(ARQ) 497PROVDESC.TXT
(IMP) {.T.,1,1,"Dt_Atualiz"} 
(CMP) {{"Cod_ProDes","PD"},{"Descricao","Descricao"}}
(LEG) "Coluna(s): PD = Provento/Desconto"
(PRE) SRV->(dbGoTop())
(PREREG) If( !empty(SRV->RV_FILIAL),SRV->RV_FILIAL>=_aTotal[009][1][1] .and. SRV->RV_FILIAL<=_aTotal[009][1][2] .and. SRV->RV_FILIAL==SM0->M0_CODFIL,.T.)
Dt_Atualiz C 008 0 DataInt(dDataBase)
Cod_ProDes C 003 0 SRV->RV_Cod
Descricao  C 045 0 SRV->RV_DESC


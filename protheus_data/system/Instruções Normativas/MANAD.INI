?{"Nome do Arquivo INI","MANAD.INI"}
?{"Descricao Completa do Arquivo Magnetico","Manual Normativo de Arquivos Digitais"}
?{"A Quem se Destina","Às empresas que utilizam sistema de processamento eletrônico de dados para registrar seus negócios e atividades econômicas, escrituração de livros ou produção de documentos de natureza contábil, fiscal, trabalhista e previdenciária."}
?{"Objetivo","Permitir que as empresas intimadas apresentem dados relativos aos seus negócios e atividades econômicas."}
?{"Prazo de Entrega","As informações serão apresentadas pelas pessoas jurídicas quando solicitadas por Auditor Fiscal da Previdência Social - AFPS - no curso de Ação Fiscal devidamente autorizada."}
?{"Aplicativo Disponibilizado pelo Fisco","SVA - Validação e Autenticação de Arquivos Digitais"}
?{"Versao do Aplicativo Contemplada pela Microsiga","1.0.0.2"}
?{"Comentarios",""}
@MASKVLR="@E 99999999999999.99"
[XXX Inicializacao]
(PRE) _aTotal[001] := MV_PAR01
(PRE) _aTotal[002] := MV_PAR02
(PRE) _aTotal[003] := MV_PAR03
(PRE) _aTotal[004] := MV_PAR04
(PRE) _aTotal[005] := MV_PAR05
(PRE) _aTotal[006] := {}
(PRE) _aTotal[007] := {}
(PRE) _aTotal[008] := .T.
(PRE) _aTotal[009] := {}
(PRE) _aTotal[010] := ""
(PRE) _aTotal[011] := ""
(PRE) _aTotal[012] := {0,0,0,0,0}
(PRE) _aTotal[013] := ""
(PRE) _aTotal[014] := ""
(PRE) _aTotal[015] := {0,0,0,0,0,0,0,0,0} 
(PRE) _aTotal[016] := 0
(PRE) _aTotal[017] := 0
(PRE) _aTotal[018] := 0
(PRE) _aTotal[020] := {0,0,0}
(PRE) _aTotal[050] := {}
(PRE) _aTotal[051] := ""
(PRE) _aTotal[052] := ""
(PRE) _aTotal[053] := ""
(PRE) _aTotal[054] := ""
(PRE) _aTotal[055] := ""
(PRE) _aTotal[056] := ""
(PRE) _aTotal[057] := ""
(PRE) _aTotal[058] := ""
(PRE) _aTotal[059] := ""
(PRE) _aTotal[060] := ""
(PRE) _aTotal[061] := ""
(PRE) _aTotal[062] := ""
(PRE) _aTotal[063] := ""
(PRE) _aTotal[064] := ""
(PRE) _aTotal[065] := ""
(PRE) _aTotal[066] := ""
(PRE) _aTotal[067] := ""
(PRE) _aTotal[068] := ""
(PRE) _aTotal[069] := 0
(PRE) _aTotal[070] := 0
(PRE) _aTotal[071] := 0
(PRE) _aTotal[072] := 0
(PRE) _aTotal[073] := 0
(PRE) _aTotal[074] := 0
(PRE) _aTotal[075] := 0
(PRE) _aTotal[076] := 0
(PRE) _aTotal[077] := {"",0}
(PRE) _aTotal[078] := ""
(PRE) _aTotal[079] := ""
(PRE) _aTotal[080] := ""
(PRE) _aTotal[081] := .T.
(PRE) _aTotal[082] := 0
(PRE) _aTotal[083] := ""
(PRE) _aTotal[084] := ""
(PRE) _aTotal[085] := ""
(PRE) _aTotal[086] := {"",0}
(PRE) _aTotal[087] := ""
(PRE) _aTotal[088] := ""
(PRE) _aTotal[089] := 0
(PRE) _aTotal[090] := {{},{}}
(PRE) _aTotal[091] := ""
(PRE) _aTotal[092] := ""   
(PRE) _aTotal[093] := 0

[XXX Montagem do CFP Utilizado pela rotina - PRINCIPAL]
(PRE) aAdd (_aTotal[006], "Processamento da MANAD")
(PRE) aAdd (_aTotal[006], "")
(PRE) aAdd (_aTotal[006], "Preencha corretamente as informações solicitadas.")
(PRE) aAdd (_aTotal[006], "Informações necessárias para o preenchimento automático da MANAD          Manual Normativo de Arquivos Digitais.")

[XXX Montagem do CFP Utilizado pela rotina - COMPLEMENTAR]
(PRE) aAdd (_aTotal[007], {})
(PRE) aAdd (_aTotal[007][1], "Processamento da MANAD")
(PRE) aAdd (_aTotal[007][1], "Passo: 1/7 - Identificação do estabelecimento do contribuinte.")
(PRE) aAdd (_aTotal[007][1], {})
(PRE) aAdd (_aTotal[007][1][3], {1, "Inscrição Cadastro Especifico INSS",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "Inscrição PIS/PASEP/CI/SUS",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {2,,"@E 999999999999",2,0,,,12})
(PRE) aAdd (_aTotal[007][1][3], {2,,"@E 99999999999",2,0,,,11})
(PRE) aAdd (_aTotal[007][1][3], {1, "Inscrição Municipal",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "Inscrição na SUFRAMA",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {2,,"XXXXXXXXXXXXXX", 1,,,,14})
(PRE) aAdd (_aTotal[007][1][3], {2,,"XXXXXXXXX",1,,,,9})
(PRE) aAdd (_aTotal[007][1][3], {1, "Versão do Layout",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "Centralização de Escrituração",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {3,,,,,{"01-Portaria n.63/2004", "02-Portaria n.58/2005", "03-IN MPS/SRP n.12/2006" },,})
(PRE) aAdd (_aTotal[007][1][3], {3,,,,,{"0-Sem Centralização", "1-Com Centralização"},,})
(PRE) aAdd (_aTotal[007][1][3], {1, "Finalidade do Arquivo",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {3,,,,,{"61-Solicitação do Auditor-Fiscal através de MPF", "62-Mto anual de Órgão Público, conf. intimação", "90-Dados Internos UF"},,})
(PRE) aAdd (_aTotal[007][1][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "Filial De",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "Filial Até",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {2,,Replicate("!", FWSizeFilial()), 1,,,,FWSizeFilial() })
(PRE) aAdd (_aTotal[007][1][3], {2,,Replicate("!", FWSizeFilial()), 1,,,, FWSizeFilial() })
(PRE) aAdd (_aTotal[007][1][3], {1, "Filial Centralizadora de Escrituracao",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {2,,Replicate("!", FWSizeFilial()), 1,,,,FWSizeFilial() })

[XXX Montagem do CFP Utilizado pela rotina - COMPLEMENTAR]
(PRE) aAdd (_aTotal[007], {})
(PRE) aAdd (_aTotal[007][2], "Processamento da MANAD")
(PRE) aAdd (_aTotal[007][2], "Passo: 2/7 - Dados do contabilista.")
(PRE) aAdd (_aTotal[007][2], {})
(PRE) aAdd (_aTotal[007][2][3], {1, "Indicador de Movimento",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {3,,,,,{"0-Com movimento", "1-Sem movimento"},,})
(PRE) aAdd (_aTotal[007][2][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {1, "Nome do contabilista/escritório",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {1, "CNPJ escritório",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {2,,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX", 1,,,,50})
(PRE) aAdd (_aTotal[007][2][3], {2,,"@E 99999999999999",2,0,,,14})
(PRE) aAdd (_aTotal[007][2][3], {1, "CPF contabilista",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {1, "CRC contabilista",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {2,,"XXXXXXXXXXX",1,,,,11})
(PRE) aAdd (_aTotal[007][2][3], {2,,"XXXXXXXXXXX",1,,,,11})
(PRE) aAdd (_aTotal[007][2][3], {1, "Data Inicio prestação serviço",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {1, "Data final prestação serviço",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {2,,,3,,,,})
(PRE) aAdd (_aTotal[007][2][3], {2,,,3,,,,})
(PRE) aAdd (_aTotal[007][2][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {1, "Informações sobre endereço",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {1, "Cep",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {1, "Endereço",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {2,,"@E 99999999",2,0,,,8})
(PRE) aAdd (_aTotal[007][2][3], {2,,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",1,,,,50})
(PRE) aAdd (_aTotal[007][2][3], {1, "Número",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {1, "Complemento",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {2,,"XXXXXX",1,,,,6})
(PRE) aAdd (_aTotal[007][2][3], {2,,"XXXXXXXXXXXXXXXXXXXX",1,,,,20})
(PRE) aAdd (_aTotal[007][2][3], {1, "Bairro",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {1, "Cep caixa postal",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {2,,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",1,,,,50})
(PRE) aAdd (_aTotal[007][2][3], {2,,"@E 99999999",2,0,,,8})
(PRE) aAdd (_aTotal[007][2][3], {1, "Caixa postal",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {1, "Telefone",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {2,,"XXXXXXXXXX",1,,,,10})
(PRE) aAdd (_aTotal[007][2][3], {2,,"XXXXXXXXXXXX",1,,,,12})
(PRE) aAdd (_aTotal[007][2][3], {1, "FAX",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {1, "E-Mail",,,,,,})
(PRE) aAdd (_aTotal[007][2][3], {2,,"XXXXXXXXXXXX",1,,,,12})
(PRE) aAdd (_aTotal[007][2][3], {2,,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",1,,,,50})

[XXX Montagem do CFP Utilizado pela rotina - COMPLEMENTAR]
(PRE) aAdd (_aTotal[007], {})
(PRE) aAdd (_aTotal[007][3], "Processamento da MANAD")
(PRE) aAdd (_aTotal[007][3], "Passo: 3/7 - Dados do técnico/empresa responsável pela geração do arquivo digital.")
(PRE) aAdd (_aTotal[007][3], {})
(PRE) aAdd (_aTotal[007][3][3], {1, "Data Inicio prestação serviço",,,,,,})
(PRE) aAdd (_aTotal[007][3][3], {1, "Data final prestação serviço",,,,,,})
(PRE) aAdd (_aTotal[007][3][3], {2,,,3,,,,})
(PRE) aAdd (_aTotal[007][3][3], {2,,,3,,,,})

[XXX Montagem do CFP Utilizado pela rotina - COMPLEMENTAR]
(PRE) aAdd (_aTotal[007], {})
(PRE) aAdd (_aTotal[007][4], "Processamento da MANAD")
(PRE) aAdd (_aTotal[007][4], "Passo: 4/7 - Identificação da escritura contábil.")
(PRE) aAdd (_aTotal[007][4], {})
(PRE) aAdd (_aTotal[007][4][3], {1, "Indicador de Movimento",,,,,,})
(PRE) aAdd (_aTotal[007][4][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][4][3], {3,,,,,{"0-Com movimento", "1-Sem movimento"},,})
(PRE) aAdd (_aTotal[007][4][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][4][3], {1, "Indicador de tipo de escrituração",,,,,,})
(PRE) aAdd (_aTotal[007][4][3], {1, "Nº Cta Analítica diário do geral",,,,,,})          
(PRE) aAdd (_aTotal[007][4][3], {3,,,,,{"G-Diário geral", "A-Diário/Razão auxiliar"},,})
(PRE) aAdd (_aTotal[007][4][3], {2,,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",1,,,,50})
(PRE) aAdd (_aTotal[007][4][3], {1, "Data da apuracao de resultado",,,,,,})
(PRE) aAdd (_aTotal[007][4][3], {1, "Conta(s) Analítica(s) de resultado",,,,,,})
(PRE) aAdd (_aTotal[007][4][3], {2,,,3,,,,})
(PRE) aAdd (_aTotal[007][4][3], {2,,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",1,,,,150})

[XXX Montagem do CFP Utilizado pela rotina - COMPLEMENTAR]
(PRE) aAdd (_aTotal[007], {})
(PRE) aAdd (_aTotal[007][5], "Processamento da MANAD")
(PRE) aAdd (_aTotal[007][5], "Passo: 5/7 - Informação da Previdência Social.")
(PRE) aAdd (_aTotal[007][5], {})
(PRE) aAdd (_aTotal[007][5][3], {1, "Indicador de Movimento",,,,,,})
(PRE) aAdd (_aTotal[007][5][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][5][3], {3,,,,,{"0-Com movimento", "1-Sem movimento"},,})

[XXX Montagem do CFP Utilizado pela rotina - COMPLEMENTAR]
(PRE) aAdd (_aTotal[007], {})
(PRE) aAdd (_aTotal[007][6], "Processamento da MANAD")
(PRE) aAdd (_aTotal[007][6], "Passo: 6/7 - Sistema Financeiro e orçamentário dos Órgãos Públicos.")
(PRE) aAdd (_aTotal[007][6], {})
(PRE) aAdd (_aTotal[007][6][3], {1, "Indicador de Movimento",,,,,,})
(PRE) aAdd (_aTotal[007][6][3], {1, "Tipo de Empresa",,,,,,})
(PRE) aAdd (_aTotal[007][6][3], {3,,,,,{"0-Com movimento", "1-Sem movimento"},,})
(PRE) aAdd (_aTotal[007][6][3], {3,,,,,{"0-Geral", "1-Órgãos Públicos"},,})


[XXX Montagem do CFP Utilizado pela rotina - COMPLEMENTAR]
(PRE) aAdd (_aTotal[007], {})
(PRE) aAdd (_aTotal[007][7], "Processamento da MANAD")
(PRE) aAdd (_aTotal[007][7], "Passo: 7/7 - Registro Tipo 0100 - Dados do tecnico/empresa responsável pela geração do arquivo digital.")
(PRE) aAdd (_aTotal[007][7], {})
(PRE) aAdd (_aTotal[007][7][3], {1, "Técnico/Responsável",,,,,,})
(PRE) aAdd (_aTotal[007][7][3], {1, "Cargo",,,,,,})
(PRE) aAdd (_aTotal[007][7][3], {2,,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",1,,,,50})
(PRE) aAdd (_aTotal[007][7][3], {2,,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",1,,,,50})
(PRE) aAdd (_aTotal[007][7][3], {1, "CNPJ",,,,,,})
(PRE) aAdd (_aTotal[007][7][3], {1, "CPF",,,,,,})
(PRE) aAdd (_aTotal[007][7][3], {2,,"@E 99999999999999",2,0,,,14})
(PRE) aAdd (_aTotal[007][7][3], {2,,"@E 99999999999",2,0,,,11})
(PRE) aAdd (_aTotal[007][7][3], {1, "Fone",,,,,,})
(PRE) aAdd (_aTotal[007][7][3], {1, "FAX",,,,,,})
(PRE) aAdd (_aTotal[007][7][3], {2,,"XXXXXXXXXXXXXXXXXXXX",1,,,,20})
(PRE) aAdd (_aTotal[007][7][3], {2,,"XXXXXXXXXXXXXXXXXXXX",1,,,,20})
(PRE) aAdd (_aTotal[007][7][3], {1, "E-Mail",,,,,,})
(PRE) aAdd (_aTotal[007][7][3], {0, "",,,,,,})
(PRE) aAdd (_aTotal[007][7][3], {2,,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",1,,,,50})

[XXX Chamada do Wizard]
(PRE) _atotal[008] := xMagWizard( _aTotal[006] , _aTotal[007] , "MANAD" )
(PRE) Iif( _atotal[008] , xMagLeWiz( "MANAD" , @_aTotal[009] , .T. ) , Nil )
(PRE) lAbtMT950	:= !_atotal[008]
                       
[XXX Chamada Contas de Resultado]
//Monta um arquivo temporario com as contas de resultado
(PRE) ManadResult(_aTotal[009][4][5],_aTotal[009][4][4],.F.,_aTotal[009][1][8],_aTotal[009][1][9])

[SM0 Registro Tipo 0000 - Identificação do Contribuinte]
(CONSOLIDADO) {"_aTotal[009][1][8]", "_aTotal[009][1][9]", "CNPJ#CPF#CEI", "REG#NOME#CEI#NIT#UF#IE#COD_MUN#IM#SUFRAMA#IND_CENTR#DT_INI#DT_FIM#COD_VER#COD_FIN#IND_ED#"}
(IMP) {.T.,1,4,"REG"}
(CMP) {{"NOME",""},{"CNPJ",""},{"CPF",""},{"CEI",""},{"NIT",""},{"UF",""},{"IE",""},{"COD_MUN","CDMUN"},{"IM",""},{"SUFRAMA",""},{"IND_CENTR","C"},{"DT_INI",""},{"DT_FIM",""},{"COD_VER","CDV"},{"COD_FIN","CF"},{"IND_ED","E"}}
(DEL)|M
(LEG) "Campo(s): C - Indicador de centralização  de escrituração | E - Indicador de tipo de entrada de dados. | CDV - Código Versão | CF - Finalidade Arquivo" 
(PRE) Iif( "1"$_aTotal[009][1][6] .and. !empty(_aTotal[009][1][10]),If(SM0->(DbSeek(cEmpAnt+_aTotal[009][1][10])),_aTotal[088]:=SM0->M0_CGC,"") ,.T.)
(PRE) Iif("1"$_aTotal[009][1][6], SM0->(DbSeek(cEmpAnt)),)
(PREREG) (FWCodFil() >= _aTotal[009][1][8] .and. FWCodFil() <= _aTotal[009][1][9]) .OR. FWCodFil() == _aTotal[009][1][10]
(PREREG) If( MV_PAR06 == 1, aScan( aFilsCalc, { |x| x[2] == FWCodFil() } ) > 0, .T.)
(PREREG) SM0->M0_CODIGO==cEmpAnt .And. _aTotal[081]
(PREREG) (_aTotal[054] := GetNewPar ("MV_CEI", ""), .T.)
(PREREG) (_aTotal[055] := GetNewPar ("MV_NIT", ""), .T.)
(PREREG) (_aTotal[056] := GetNewPar ("MV_INSCRIM", ""), .T.)
(PREREG) _aTotal[012,2]++
(PREREG) _aTotal[074]++
REG        C 004 0 "0000"
NOME       C 050 0 PadR (SM0->M0_NOMECOM, 50)
CNPJ       C 014 0 SM0->M0_CGC
CPF        C 011 0 Iif (SM0->M0_TPINSC == 3, SM0->M0_CGC, "")
CEI        C 012 0 Iif (Empty(_aTotal[054]),Iif(Empty(Val(_aTotal[009][1][1])),If(SM0->M0_TPINSC == 1,SM0->M0_CGC,""),_aTotal[009][1][1]), _aTotal[054])
NIT        C 011 0 Iif (Empty (_aTotal[055]), Iif(Empty(Val(_aTotal[009][1][2])),"",_aTotal[009][1][2]), _aTotal[055])
UF         C 002 0 SM0->M0_ESTENT
IE         C 014 0 SM0->M0_INSC
COD_MUN    C 005 0 SM0->M0_CODMUN
IM         C 014 0 Iif (Empty (_aTotal[056]), _aTotal[009][1][3], _aTotal[056])
SUFRAMA    C 009 0 SM0->M0_INS_SUF
IND_CENTR  N 001 0 Iif ("0"$_aTotal[009][1][6] .or. empty(_aTotal[009][1][10]),0,Iif (("1"$_aTotal[009][1][6]) .and. ( FWCodFil() == _aTotal[009][1][10]), 1, 2))
DT_INI     C 008 0 StrZero (Day (_aTotal[001]), 2)+StrZero (Month (_aTotal[001]), 2)+StrZero (Year (_aTotal[001]), 4)
DT_FIM     C 008 0 StrZero (Day (_aTotal[002]), 2)+StrZero (Month (_aTotal[002]), 2)+StrZero (Year (_aTotal[002]), 4)
COD_VER    C 003 0 Iif ("01"$_aTotal[009][1][5],"001",If ("02"$_aTotal[009][1][5],"002","003"))
COD_FIN    N 002 0 Iif ("61"$_aTotal[009][1][7], 61, Iif ("62"$_aTotal[009][1][7], 62, 90))
IND_ED     N 001 0 1
(POSREG) _aTotal[081] := Iif("0"$_aTotal[009][1][6], .F., .T.)
(POS) SM0->(DbSeek(cEmpAnt+cFilAnt))
(CONT) _aTotal[082]++
(CONT) _aTotal[012,1]++

[XXX Registro Tipo 0001 - Abertura do bloco 0]
(DEL)|M
(PREREG) _aTotal[012,3]++
REG        C 004 0 "0001"
IND_MOV    N 001 0 0
(CONT) _aTotal[012,1]++

[XXX Registro Tipo 0050 - Dados contabilista]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"NOME",""},{"CNPJ",""},{"CPF",""},{"CRC",""},{"DT_INI_SER",""},{"DT_FIM_SER",""},{"CEP",""},{"END","ENDEREÇO"},{"NUM","NÚMERO"},{"COMPL","COMPLEMENTO"},{"FONE",""},{"FAX",""}}
(DEL)|M
(PRE) _aTotal[010] := StrZero (Day (SToD (_aTotal[009][2][6])), 2)+StrZero (Month (SToD (_aTotal[009][2][6])), 2)+StrZero (Year (SToD (_aTotal[009][2][6])), 4)
(PRE) _aTotal[011] := StrZero (Day (SToD (_aTotal[009][2][7])), 2)+StrZero (Month (SToD (_aTotal[009][2][7])), 2)+StrZero (Year (SToD (_aTotal[009][2][7])), 4)
(PREREG) "0"$_aTotal[009][2][1]
(PREREG) _aTotal[012,4]++
REG        C 004 0 "0050"
NOME       C 050 0 _aTotal[009][2][2]
CNPJ       C 014 0 Iif(Empty(Val(_aTotal[009][2][3])),"", StrZero (Val (_aTotal[009][2][3]), 14))
CPF        C 011 0 Iif(Empty(Val(_aTotal[009][2][4])),"", StrZero (Val (_aTotal[009][2][4]), 11))
CRC        C 011 0 _aTotal[009][2][5]
DT_INI_SER C 008 0 Iif (_aTotal[010]=="00000000", "", _aTotal[010])
DT_FIM_SER C 008 0 Iif (_aTotal[011]=="00000000", "", _aTotal[011])
END        C 050 0 _aTotal[009][2][9]
NUM        C 006 0 _aTotal[009][2][10]
COMPL      C 020 0 _aTotal[009][2][11]
BAIRRO     C 050 0 _aTotal[009][2][12]
CEP        C 008 0 Iif(Empty(Val(_aTotal[009][2][8])),"", StrZero (Val (_aTotal[009][2][8]), 8))
UF         C 002 0 SM0->M0_ESTENT
CP         C 010 0 Iif(!Empty(Val(_aTotal[009][2][14])), _aTotal[009][2][14], "")
CEP_CP     C 008 0 Iif(!Empty(Val(_aTotal[009][2][13])), StrZero (Val (_aTotal[009][2][13]), 8), "")
FONE       C 012 0 _aTotal[009][2][15]
FAX        C 012 0 _aTotal[009][2][16]
EMAIL      C 050 0 _aTotal[009][2][17]
(CONT) _aTotal[012,1]++

[XXX Registro Tipo 0100 - Dados do tecnico/empresa responsável pela geração do arquivo digital]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"EMP_TEC","NOME EMPRESA/TÉCNICO"},{"CARGO",""},{"DT_INI_SER",""},{"DT_FIM_SER",""},{"CNPJ",""},{"CPF",""},{"FONE",""},{"FAX",""},{"EMAIL","E-MAIL"}}
(DEL)|M
(PRE) _aTotal[010] := StrZero (Day (SToD (_aTotal[009][3][1])), 2)+StrZero (Month (SToD (_aTotal[009][3][1])), 2)+StrZero (Year (SToD (_aTotal[009][3][1])), 4)
(PRE) _aTotal[011] := StrZero (Day (SToD (_aTotal[009][3][2])), 2)+StrZero (Month (SToD (_aTotal[009][3][2])), 2)+StrZero (Year (SToD (_aTotal[009][3][2])), 4)
(PREREG) "0"$_aTotal[009][2][1]
(PREREG) _aTotal[012,5]++
REG        C 004 0 "0100"
EMP_TEC    C 050 0 _aTotal[009][7][1]
CARGO      C 050 0 _aTotal[009][7][2]
DT_INI_SER C 008 0 Iif (_aTotal[010]=="00000000", "", _aTotal[010])
DT_FIM_SER C 008 0 Iif (_aTotal[011]=="00000000", "", _aTotal[011])
CNPJ       C 014 0 Iif (Empty (Val (_aTotal[009][7][3])), "", StrZero (Val (_aTotal[009][7][3]), 14))
CPF        C 011 0 Iif (Empty (Val (_aTotal[009][7][4])), "", StrZero (Val (_aTotal[009][7][4]), 11))
FONE       C 010 0 _aTotal[009][7][5]
FAX        C 010 0 _aTotal[009][7][6]
EMAIL      C 050 0 _aTotal[009][7][7]
(CONT) _aTotal[012,1]++

[XXX Registro Tipo 0990 - Encerramento do bloco 0]
(DEL)|M
(PREREG) _aTotal[012,1]++
REG        C 004 0 "0990"
QTD_LIN_0  N 010 0 _aTotal[012,1]

[XXX Registro Tipo I001 - Abertura do bloco I]
(DEL)|M
(PREREG) "0"$_aTotal[009][6][2]
(PREREG) _aTotal[015,1]++
(PREREG) _aTotal[015,9]++
REG        C 004 0 "I001"
IND_MOV    N 001 0 Iif ("0"$_aTotal[009][4][1], 0, 1)
(POS) CtbTmpAT7(_aTotal[001],_aTotal[002],STOD(_aTotal[009][4][4],4),.F.,_aTotal[009][1][8],_aTotal[009][1][9],.T.)

[XXX Registro Tipo I005 - Identificação da escrituração contábil]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"IND_ESC",""},{"COD_GRP_CT",""}}
(LEG) "Campo(s): I - Indicador do tipo de escrituração."
(DEL)|M
(PREREG) "0"$_aTotal[009][4][1]
(PREREG) "0"$_aTotal[009][6][2]
(PREREG) _aTotal[015,2]++
(PREREG) _aTotal[015,9]++
REG        C 004 0 "I005"
IND_ESC    C 001 0 Iif ("G"$_aTotal[009][4][2], "G", "A")
COD_GRP_CT C 050 0 _aTotal[009][4][3]
(POS) _aTotal[079] := If( Empty(_aTotal[079]), FWCodFil(), _aTotal[079] )

[SI1 Registro Tipo I050 - Plano de contas]
(CONSOLIDADO) {"_aTotal[009][1][8]", "_aTotal[009][1][9]", "COD_GRP_CT","REG#DT_ATUALIZ#IND_NAT#IND_GRP#NIVEL#COD_GRP_CT#COD_GRP_SU#NOME_GRP_C"}
(CHV) "0"$_aTotal[009][4][1]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"DT_ATUALIZ",""},{"IND_NAT","N"},{"IND_GRP","G"},{"NIVEL",""},{"COD_GRP_CT",""},{"COD_GRP_SU",""},{"NOME_GPR_C",""}}
(DEL)|M
(LEG) "Campo(s): N - Indicador da natureza | G - Indicador do tipo de grupo | NI - Nível de contas/grupo de contas."
(PRE) SI1->(dbSetOrder(1))
(PRE) SI1->(dbSeek(xFilial("SI1"),.T.))
(PREREG) "0"$_aTotal[009][4][1]
(PREREG) "0"$_aTotal[009][6][2]
(PREREG) "CON"$GETMV("MV_MCONTAB")
(PREREG) SI1->I1_FILIAL == xFilial("SI1")
(PREREG) SI1->I1_DTEXIS <= _aTotal[002]
(PREREG) If( Empty(SI1->I1_FILIAL) .And. FWCodFil() <> _aTotal[079], .F., .T.)
REG        C 004 0 "I050"
DT_ATUALIZ C 008 0 DataInt(SI1->I1_DTEXIS)
IND_NAT    N 001 0 Val(SI1->I1_INDNAT)
IND_GRP    C 001 0 SI1->I1_CLASSE
NIVEL      N 002 0 Val(SI1->I1_NIVEL)
COD_GRP_CT C 050 0 SI1->I1_CODIGO
COD_GRP_SU C 050 0 SI1->I1_CTASUP
NOME_GRP_C C 050 0 SI1->I1_DESC
(CONT) _aTotal[015,3]++
(CONT) _aTotal[015,9]++

[CT1 Registro Tipo I050 - Plano de contas]
(CONSOLIDADO) {"_aTotal[009][1][8]", "_aTotal[009][1][9]", "COD_GRP_CT","REG#DT_ATUALIZ#IND_NAT#IND_GRP#NIVEL#COD_GRP_CT#COD_GRP_SU#NOME_GRP_C"}
(CHV) "0"$_aTotal[009][4][1]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"DT_ATUALIZ",""},{"IND_NAT",""},{"IND_GRP",""},{"NIVEL",""},{"COD_GRP_CTA",""},{"COD_GRP_SUP",""},{"NOME_GRP_CT",""}}
(DEL)|M
(PRE) CT1->(dbSetOrder(1))
(PRE) CT1->(dbSeek(xFilial("CT1"),.T.))
(CHV) If( Empty(CT1->CT1_FILIAL) .And. FWCodFil() <> _aTotal[079], .F., .T.)
(PREREG) "CTB"$GETMV("MV_MCONTAB")  
(PREREG) _aTotal[089]     := If(CT1->CT1_CTASUP <> _aTotal[086][01], Ascan(_aTotal[090][01],CT1->CT1_CTASUP), 0 )
(PREREG) _aTotal[086][02] := If(CT1->CT1_CTASUP <> _aTotal[086][01], IF(_aTotal[089]==0,CtbNivCta(CT1->CT1_CONTA), _aTotal[090][02][_aTotal[089]]), _aTotal[086][02])
(PREREG) _aTotal[086][01] := If(CT1->CT1_CTASUP <> _aTotal[086][01], CT1->CT1_CTASUP, _aTotal[086][01])
(PREREG) If(CT1->CT1_CTASUP <> _aTotal[086][01] .And. _aTotal[089] == 0, Aadd(_aTotal[090][01],CT1->CT1_CTASUP), .T. )
(PREREG) If(CT1->CT1_CTASUP <> _aTotal[086][01] .And. _aTotal[089] == 0, Aadd(_aTotal[090][02],_aTotal[086][02]), .T. )
(PREREG) "0"$_aTotal[009][4][1]  
(PREREG) "0"$_aTotal[009][6][2]
(PREREG) CT1->CT1_FILIAL == xFilial("CT1")
(PREREG) CT1->CT1_DTEXIS <= _aTotal[002]
(PREREG) If( Empty(CT1->CT1_FILIAL) .And. FWCodFil() <> _aTotal[079], .F., .T.)
REG        C 004 0 "I050"
DT_ATUALIZ C 008 0 DataInt(CT1->CT1_DTEXIS)
IND_NAT    N 001 0 Val(CT1->CT1_INDNAT)
IND_GRP    C 001 0 Iif (CT1->CT1_CLASSE=="1", "S", "A")
NIVEL      N 002 0 _aTotal[086][02]
COD_GRP_CT C 050 0 CT1->CT1_CONTA
COD_GRP_SU C 050 0 CT1->CT1_CTASUP
NOME_GRP_C C 050 0 CT1->CT1_DESC01
(CONT) _aTotal[015,3]++
(CONT) _aTotal[015,9]++

[SI3 Registro Tipo I100 - Centro de custos]
(CONSOLIDADO) {"_aTotal[009][1][8]", "_aTotal[009][1][9]", "COD_CCUS","REG#DT_ATUALIZ#COD_CCUS#NOME_CCUS"}
(CHV) "0"$_aTotal[009][4][1]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"DT_ATUALIZ",""},{"COD_CCUS",""},{"NOME_CCUS",""}}
(DEL)|M
(PRE) SI3->(dbSetOrder(1))
(PRE) SI3->(dbSeek(xFilial("SI3"),.T.))
(PREREG) "0"$_aTotal[009][4][1]  
(PREREG) "0"$_aTotal[009][6][2]
(PREREG) "CON"$GETMV("MV_MCONTAB")
(PREREG) SI3->I3_FILIAL == xFilial("SI3")
(PREREG) !EMPTY(SI3->I3_DESC)
(PREREG) SI3->I3_DTEXIS <= _aTotal[002]
(PREREG) If( Empty(SI3->I3_FILIAL) .And. FWCodFil() <> _aTotal[079], .F., .T.)
REG        C 004 0 "I100"
DT_ATUALIZ C 008 0 DataInt(SI3->I3_DTEXIS)
COD_CCUS   C 050 0 SI3->I3_CUSTO
NOME_CCUS  C 050 0 SI3->I3_DESC
(CONT) _aTotal[015,4]++
(CONT) _aTotal[015,9]++

[CTT Registro Tipo I100 - Centro de custos]
(CONSOLIDADO) {"_aTotal[009][1][8]", "_aTotal[009][1][9]", "COD_CCUS","REG#DT_ATUALIZ#COD_CCUS#NOME_CCUS"}
(CHV) "0"$_aTotal[009][4][1]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"DT_ATUALIZ",""},{"COD_CCUS",""},{"NOME_CCUS",""}}
(DEL)|M
(PRE) CTT->(dbSetOrder(1))
(PRE) CTT->(dbSeek(xFilial("CTT"),.T.))
(PREREG) "0"$_aTotal[009][4][1]  
(PREREG) "0"$_aTotal[009][6][2]
(PREREG) "CTB"$GETMV("MV_MCONTAB")
(PREREG) CTT->CTT_FILIAL == xFilial("CTT")
(PREREG) CTT->CTT_DTEXIS <= _aTotal[002]
(PREREG) If( Empty(CTT->CTT_FILIAL) .and. FWCodFil() <> _aTotal[79], .F., .T.)
REG        C 004 0 "I100"
DT_ATUALIZ C 008 0 DataInt(CTT->CTT_DTEXIS)
COD_CCUS   C 050 0 CTT->CTT_CUSTO
NOME_CCUS  C 050 0 CTT->CTT_DESC01
(CONT) _aTotal[015,4]++
(CONT) _aTotal[015,9]++

[AT7 Registro Tipo I150 - Saldos mensais]
(CHV) "0"$_aTotal[009][4][1]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"COD_GRP_CT",""},{"DT_INI",""},{"VL_SLD_INI",""},{"IND_SLD_IN",""},{"VL_DEB",""},{"VL_CRED",""},{"VL_SLD_FIN",""},{"IND_SLD_FI",""}}
(DEL)|M
(LEG) "Campo(s): I - I - Indicador da situação do saldo Inicial | F - Indicador da situação do saldo final."
(PRE) If( "CON"$GETMV("MV_MCONTAB") .and. ("0" $ _aTotal[009][4][1]) , CtbTmpAT7(_aTotal[001],_aTotal[002],STOD(_aTotal[009][4][4],4),.T.,_aTotal[009][1][8],_aTotal[009][1][9],.T.), NIL)
(PRE) AT7->(dbGoTop())
(PREREG) "0"$_aTotal[009][4][1]  
(PREREG) "0"$_aTotal[009][6][2]
(PREREG) "CON"$GETMV("MV_MCONTAB")
(PREREG) AT7->TIPOCONTA $ "A"
(PREREG) If( Empty(xFilial("SI1")) .And. FWCodFil() <> _aTotal[079], .F., .T.)
REG        C 004 0 "I150"
COD_GRP_CT C 050 0 AT7->CONTA
DT_INI     C 006 0 StrZero(Month(AT7->DATASLD),2)+StrZero(Year(AT7->DATASLD),4)
VL_SLD_INI N 017 2 ABS(AT7->SALDOANT)
IND_SLD_IN C 001 0 DouC(AT7->SALDOANT)
VL_DEB     N 017 2 ABS(AT7->SALDODEB)
VL_CRED    N 017 2 ABS(AT7->SALDOCRD)
VL_SLD_FIN N 017 2 ABS(AT7->SALDOATU)
IND_SLD_FI C 001 0 DouC(AT7->SALDOATU)
(CONT) _aTotal[015,5]++
(CONT) _aTotal[015,9]++

[AT7 Registro Tipo I150 - Saldos mensais]
(CHV) "0"$_aTotal[009][4][1]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"COD_GRP_CT",""},{"DT_INI",""},{"VL_SLD_INI",""},{"IND_SLD_IN","I"},{"VL_DEB",""},{"VL_CRED",""},{"VL_SLD_FIN",""},{"IND_SLD_FI","F"}}
(DEL)|M
(LEG) "Campo(s): I - I - Indicador da situação do saldo Inicial | F - Indicador da situação do saldo final."
(PRE) If( "CTB"$GETMV("MV_MCONTAB") .and. ("0" $ _aTotal[009][4][1]), _aTotal[87] := CtbTmpAT7(_aTotal[001],_aTotal[002],STOD(_aTotal[009][4][4],4),.T.,_aTotal[009][1][8],_aTotal[009][1][9],.T.), NIL )
(PRE) If( "CTB"$GETMV("MV_MCONTAB") .And. IfDefTopCTB() .And. "TMP_"$_aTotal[87], FsQuery( {"AT7",""},1,,"","CONTA,DATASLD",,,"TIPOCONTA,CONTA,DATASLD,SALDOANT,SALDODEB,SALDOCRD,SALDOATU",,_aTotal[87] ), Nil )
(PRE) AT7->(dbGoTop())
(PREREG) "0"$_aTotal[009][4][1]  
(PREREG) "0"$_aTotal[009][6][2]
(PREREG) "CTB"$GETMV("MV_MCONTAB")
(PREREG) AT7->TIPOCONTA $ "2"     
(PREREG) If( Empty(xFilial("CT7")) .And. FWCodFil() <> _aTotal[079], .F., .T.)
(PREREG) IF( ValType(AT7->DATASLD)=="D",DTOS(AT7->DATASLD),AT7->DATASLD) >= CHKDTEXIST(AT7->CONTA)
(PREREG) AT7->SALDOATU != 0 .OR. AT7->SALDODEB > 0 .OR. AT7->SALDOCRD > 0
REG        C 004 0 "I150"
COD_GRP_CT C 050 0 AT7->CONTA
DT_INI     C 006 0 IF( ValType(AT7->DATASLD)=="D", StrZero(Month(AT7->DATASLD),2)+StrZero(Year(AT7->DATASLD),4), SubStr(AT7->DATASLD,5,2)+Left(AT7->DATASLD,4) )
VL_SLD_INI N 017 2 ABS(AT7->SALDOANT)
IND_SLD_IN C 001 0 DouC(AT7->SALDOANT)
VL_DEB     N 017 2 ABS(AT7->SALDODEB)
VL_CRED    N 017 2 ABS(AT7->SALDOCRD)
VL_SLD_FIN N 017 2 ABS(AT7->SALDOATU)
IND_SLD_FI C 001 0 DouC(AT7->SALDOATU)
(CONT) _aTotal[015,5]++
(CONT) _aTotal[015,9]++
(POS) ConAT7Clos("AT7",.T.,_aTotal[87])

[XXX ABERTURA DOS TRBS]
(PRE) _aTotal[99] := {}
(PRE) If( "0"$_aTotal[009][4][1], Processa({|| _aTotal[99] := DadosCTB(.T. , .T.,,,,_aTotal[009][1][8],_aTotal[009][1][9]) }), Processa({|| _aTotal[99] := DadosCTB(.T. , .T.,,,,_aTotal[009][1][8],_aTotal[009][1][9],,,,,.F.) }))
(PRE) If( "CON"$GETMV("MV_MCONTAB"), FsQuery( {"ATI",""},1,,"","DTLANCA,NUMARQ,NUMLANC",,,"DTLANCA,CTAANAL,CCUSTO,CONTPAR,VALLANC,INDICADC,NUMARQ,NUMLANC,INDLANC,HSTCOMPL",,_aTotal[99,1] ), NIL )
(PRE) If( "CTB"$GETMV("MV_MCONTAB") .And. IfDefTopCTB(), FsQuery( {"AT2",""},1,,"","DTLANCA,FILIAL,NUMARQ,DOC,SEQLAN,EMPORI,FILORI,SEQHIS,TIPOLCTO,REGISTRO",,,"DTLANCA,FILIAL,CTAANAL,DOC,SEQLAN,EMPORI,FILORI,SEQHIS,TIPOLCTO,REGISTRO,CCUSTO,CONTPAR,VALLANC,INDICADC,NUMARQ,NUMLANC,INDLANC,HSTCOMPL",,_aTotal[99,2] ), NIL )
(PRE) ATI->(DbGoTop ())
(PRE) AT2->(DbGoTop ())

[ATI Registro Tipo I200 - Lançamento contábil]
(CHV) "0"$_aTotal[009][4][1]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"DTLCTO","DT LANC"},{"CODCTA","CÓDIGO CONTA CONTÁBIL"},{"CODCCUS","CÓDIGO CENTRO DE CUSTO"},{"CODCP","CÓDIGO CONTA CONTRAPARTIDA ANALÍTICA D/C"},{"VLDEBCRE","VALOR D/C"},{"INDDEBCR","N"},{"NUMARQ","CD.ARQUIVAM"},{"NUMLCTO","NLC"},{"INDLCTO","T"}}
(DEL)|M
(LEG) "Campo(s): N - Indicador da natureza do lançamento(C-Crédito/D-Débito) | NLC - Número Lançamento | T - Indicador do tipo do lançamento(N-Normal/E-Encerramento)."
(PREREG) IF( ValType(ATI->DTLANCA)=="D", (ATI->DTLANCA>=_aTotal[001] .and. ATI->DTLANCA<=_aTotal[002]), (ATI->DTLANCA>=DTOS(_aTotal[001]) .and. ATI->DTLANCA<=DTOS(_aTotal[002])) )
(PREREG) "0"$_aTotal[009][4][1]                                        
(PREREG) "0"$_aTotal[009][6][2]                 
(PREREG) "CON"$GETMV("MV_MCONTAB")
(PREREG) _aTotal[015,6]++
(PREREG) _aTotal[015,9]++
REG        C 004 0 "I200"
DTLCTO     C 008 0 IF( ValType(ATI->DTLANCA)=="D", FormatDate(ATI->DTLANCA), Right(ATI->DTLANCA,2)+SubStr(ATI->DTLANCA,5,2)+Left(ATI->DTLANCA,4) )
CODCTA     C 050 0 ATI->CTAANAL
CODCCUS    C 050 0 ATI->CCUSTO
CODCP      C 050 0 ATI->CONTPAR
VLDEBCRE   N 017 2 ATI->VALLANC
INDDEBCR   C 001 0 ATI->INDICADC
NUMARQ     C 012 0 ATI->NUMARQ
NUMLCTO    C 012 0 ATI->NUMLANC
INDLCTO    C 001 0 ATI->INDLANC
HISTLCTO   C 150 0 ATI->HSTCOMPL

[AT2 Registro Tipo I200 - Lançamento contábil]
(CHV) "0"$_aTotal[009][4][1]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"DTLCTO","DT LANC"},{"CODCTA","CÓDIGO CONTA CONTÁBIL"},{"CODCCUS","CÓDIGO CENTRO DE CUSTO"},{"CODCP","CÓDIGO CONTA CONTRAPARTIDA ANALÍTICA D/C"},{"VLDEBCRE","VALOR D/C"},{"INDDEBCR","N"},{"NUMARQ","CD.ARQUIVAM"},{"NUMLCTO","NLC"},{"INDLCTO","T"}}
(DEL)|M                 
(LEG) "Campo(s): N - Indicador da natureza do lançamento(C-Crédito/D-Débito) | NLC - Número Lançamento | T - Indicador do tipo do lançamento(N-Normal/E-Encerramento)."
(PREREG) IF( ValType(AT2->DTLANCA)=="D", (AT2->DTLANCA>=_aTotal[001] .and. AT2->DTLANCA<=_aTotal[002]), (AT2->DTLANCA>=DTOS(_aTotal[001]) .and. AT2->DTLANCA<=DTOS(_aTotal[002])) )
(PREREG) "0"$_aTotal[009][4][1]
(PREREG) "0"$_aTotal[009][6][2]
(PREREG) "CTB"$GETMV("MV_MCONTAB")
(PREREG) _aTotal[015,6]++              
(PREREG) _aTotal[015,9]++
REG        C 004 0 "I200"
DTLCTO     C 008 0 IF( ValType(AT2->DTLANCA)=="D", FormatDate(AT2->DTLANCA), Right(AT2->DTLANCA,2)+SubStr(AT2->DTLANCA,5,2)+Left(AT2->DTLANCA,4) )
CODCTA     C 050 0 AT2->CTAANAL
CODCCUS    C 050 0 AT2->CCUSTO
CODCP      C 050 0 AT2->CONTPAR
VLDEBCRE   N 017 2 AT2->VALLANC
INDDEBCR   C 001 0 AT2->INDICADC
NUMARQ     C 012 0 AT2->NUMARQ
NUMLCTO    C 009 0 AT2->NUMLANC
INDLCTO    C 001 0 AT2->INDLANC
HISTLCTO   C 150 0 AT2->HSTCOMPL
(POS) DadosCTB(.T. , .T.,,,,_aTotal[009][1][8],_aTotal[009][1][9],_aTotal[99])

[M01 Registro Tipo I250 - Saldo das contas de resultado antes do encerramento]
(CHV) "0"$_aTotal[009][4][1]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"DT_RES",""},{"COD_GRP_CT",""},{"VL_GRP",""},{"IND_SLD_FI",""}}
(DEL)|M
(LEG) "Campo(s): I - Indice da situação do saldo final."
(PRE) If( "CON"$GETMV("MV_MCONTAB") , ManadResult(_aTotal[009][4][5],_aTotal[009][4][4],.T.,_aTotal[009][1][8],_aTotal[009][1][9]) , NIL )
(PRE) M01->(dbGotop())
(PREREG) "0"$_aTotal[009][4][1]
(PREREG) "0"$_aTotal[009][6][2]
(PREREG) "CON"$GETMV("MV_MCONTAB")
(PREREG) If( Empty(xFilial("SI1")) .And. FWCodFil() <> _aTotal[079], .F., .T.)
REG        C 004 0 "I250"
DT_RES     C 008 0 DATAINT(STOD(_aTotal[009][4][4],4))
COD_GRP_CT C 050 0 M01->CONTA
VL_GRP     N 017 2 ABS(M01->SALDO)
IND_SLD_FI C 001 0 DouC(M01->SALDO)
(CONT) _aTotal[015,7]++
(CONT) _aTotal[015,9]++
(POS) _aTotal[079] := If( Empty(_aTotal[079]), FWCodFil(),_aTotal[079] )

[M01 Registro Tipo I250 - Saldo das contas de resultado antes do encerramento]
(CHV) "0"$_aTotal[009][4][1]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"DT_RES",""},{"COD_GRP_CT",""},{"VL_GRP",""},{"IND_SLD_FI",""}}
(DEL)|M
(LEG) "Campo(s): I - Indice da situação do saldo final."
(PRE) If( "CTB"$GETMV("MV_MCONTAB") , ManadResult(_aTotal[009][4][5],_aTotal[009][4][4],.T.,_aTotal[009][1][8],_aTotal[009][1][9]) , NIL )
(PRE) M01->(dbGoTop())
(PREREG) "0"$_aTotal[009][4][1]
(PREREG) "0"$_aTotal[009][6][2]
(PREREG) "CTB"$GETMV("MV_MCONTAB")
(PREREG) If( Empty(xFilial("CT7")) .AND. FWCodFil() <> _aTotal[079], .F., .T.)
REG        C 004 0 "I250"
DT_RES     C 008 0 DATAINT(STOD(_aTotal[009][4][4],4))
COD_GRP_CT C 050 0 M01->CONTA
VL_GRP     N 017 2 ABS(M01->SALDO)
IND_SLD_FI C 001 0 DouC(M01->SALDO)
(CONT) _aTotal[015,7]++
(CONT) _aTotal[015,9]++
(POS) _aTotal[079] := If( Empty(_aTotal[079]), FWCodFil(),_aTotal[079] )

[XXX Registro Tipo I990 - Encerramento do bloco I]
(DEL)|M
(PREREG) "0"$_aTotal[009][6][2]
(PREREG) _aTotal[015,8]++
(PREREG) _aTotal[015,9]++
REG        C 004 0 "I990"
QTD_LIN_I  N 010 0 _aTotal[015,9]

[XXX Registro Tipo K001 - Abertura do bloco K]
(DEL)|M
(PRE) _aTotal[058]:= CriaRCZ()
REG        C 004 0 "K001"
IND_MOV    N 001 0 Iif ("0"$_aTotal[009][5][1], 0, 1)
(CONT) _aTotal[075]++

[SRA Registro Tipo K050 - Cadastro de trabalhadores]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"CNPJ",""},{"DT_ATUALIZ",""},{"COD_REG_TR","MATRICULA"},{"CPF",""},{"NIT",""},{"COD_CATEG","CA"},{"NOME_TRAB","NOME"},{"DT_NASC",""},{"DT_ADMISSA","ADMISSAO"},{"DT_DEMISSA","DEMISSAO"},{"IND_VINC",""},{"TIPO_ATO_N",""},{"NM_ATO_NO",""},{"DT_ATO_NO",""}}
(DEL)|M
(LEG) "Campo(s): CA - Código da categoria do trabalhador para fins de GFIP | I - Indicador do tipo do vínculo do trabalhador | T - Indicativo do tipo de nomeação."
(PRE) SRA->(DbGoTop ())
(PRE) SRJ->(DbSetOrder (1))
(PRE) SRE->(DbSetOrder (2))
(PRE) If( ValType( _aTotal[013] ) == "A", .T., (_aTotal[013] := ARRAY(942), AFILL(_aTotal[013],{'   ',"          ",""  }), .T.) )
(PRE) _aTotal[060] := If( substr(MesAno(_aTotal[002]),5,2)=="12",Substr(MesAno(_aTotal[002]),1,4)+"13",MesAno(_aTotal[002]) )
(PRE) _aTotal[059] := CriaSRDTemp(1)
(PRE) _aTotal[067] := "!!"
(PRE) MV_PAR60 := ""
(PRE) If( MV_PAR06 == 1, aEval( aFilsCalc, { |x| MV_PAR60 += x[2] } ), Nil )
(PRE) FsQuery({"SRA",""},1,If(MV_PAR06 == 2, "RA_FILIAL>='"+_aTotal[009][1][8]+"' AND RA_FILIAL<='"+ If(Empty(_aTotal[009][1][9]),Replicate("Z", FWSizeFilial()),_aTotal[009][1][9])	+"'", ""),If(MV_PAR06 == 2, "RA_FILIAL>='"+_aTotal[009][1][8]+"' .AND. RA_FILIAL<='"+ If(Empty(_aTotal[009][1][9]),Replicate("Z", FWSizeFilial()),_aTotal[009][1][9])	+"'", "RA_FILIAL $ MV_PAR60"),"RA_FILIAL+RA_MAT", If( MV_PAR06 == 1, { "RA_FILIAL", "("+fSqlIN( MV_PAR60, FwSizeFilial() ) + ")" }, {}))
(PREREG) !(SRA->RA_CATFUNC $ GetNewPar("MV_CATFUNC","") )
(PREREG) ChkMovto(SRA->RA_FILIAL,SRA->RA_MAT,"SRA->RA_DEMISSA >= _aTotal[001]",_aTotal[001],_aTotal[002])
(PREREG) _aTotal[068] := SRA->RA_ADMISSA
(PREREG) VER_TRANSF()
(PREREG) _aTotal[068] <= _aTotal[002]
(PREREG) If( SRA->RA_FILIAL # _ATOTAL[67], FP_CODFOL (@_aTotal[013], SRA->RA_FILIAL),.T.)
(PREREG) _aTotal[061] := {"SRD",""}
(PREREG) _aTotal[062] := "RD_FILIAL='"+SRA->RA_FILIAL+"' AND RD_MAT ='"+SRA->RA_MAT	+"' AND RD_DATARQ >='"+MesAno(_aTotal[001])+"' AND RD_DATARQ<='"+ _aTotal[060]+"' AND RD_EMPRESA='"+ SPACE(02)+"' AND RD_ROTEIR != 'VEX' AND RD_ROTEIR != 'ADI'"
(PREREG) _aTotal[063] := "RD_FILIAL='"+SRA->RA_FILIAL+"' AND RD_MAT ='"+SRA->RA_MAT	+"' AND RD_DATARQ >='"+MesAno(_aTotal[001])+"' AND RD_DATARQ<='"+ _aTotal[060]+"' AND RD_EMPRESA='"+ SPACE(02)+"' AND RD_ROTEIR != 'VEX' AND RD_ROTEIR != 'ADI'"
(PREREG) _aTotal[064] := "RD_FILIAL+RD_MAT+RD_DATARQ+RD_PD+RD_SEMANA+RD_SEQ+RD_CC"
(PREREG) _aTotal[065] := "('"+_aTotal[013,15,1]+"','"+_aTotal[013, 27,1]+"','"+_aTotal[013, 16,1]+"','"+_aTotal[013, 28,1]+"','"+_aTotal[013,152,1]+"',"
(PREREG) _aTotal[065] := _aTotal[065]+"'"+ _aTotal[013, 13,1]+"','"+_aTotal[013,14, 1]+"','"+_aTotal[013,221, 1]+"','"+_aTotal[013,225, 1]+"','"+_aTotal[013,126, 1]+"','"+_aTotal[013, 29, 1]+"','"+_aTotal[013,100, 1]+"',"
(PREREG) _aTotal[065] := _aTotal[065]+"'"+ _aTotal[013, 19,1]+"','"+_aTotal[013,20, 1]+"','"+_aTotal[013, 18, 1]+"','"+_aTotal[013, 45, 1]+"','"+_aTotal[013,167, 1]+"','"+_aTotal[013,168, 1]+"','"+_aTotal[013,169, 1]+"',"
(PREREG) _aTotal[065] := _aTotal[065]+"'"+ _aTotal[013, 34,1]+"','"+_aTotal[013,59, 1]+"','"+_aTotal[013, 60, 1]+"','"+_aTotal[013, 61, 1]+"','"+_aTotal[013, 62, 1]+"','"+_aTotal[013, 63, 1]+"',"
(PREREG) _aTotal[065] := _aTotal[065]+"'"+ _aTotal[013, 30,1]+"','"+_aTotal[013,43, 1]+"','"+_aTotal[013, 26, 1]+"','"+_aTotal[013, 22, 1]+"','"+_aTotal[013, 218, 1]+"')"
(PREREG) _aTotal[066] := {"RD_PD",_aTotal[065]}
(PREREG) _aTotal[065] := ""
(PREREG) "0"$_aTotal[009][5][1]
(PREREG) SRJ->( MsSeek (If (Empty(xFilial("SRJ")), Space(FWSizeFilial()), xFilial("SRJ",SRA->RA_FILIAL))+SRA->RA_CODFUNC))
(PREREG) _aTotal[014] := 0
(PREREG) _aTotal[091] := SM0->( GetArea() )
(PREREG) SM0->( MsSeek (cEmpAnt+SRA->RA_FILIAL))
(PREREG) FsQuery({"SRD",""},1,_aTotal[62],_aTotal[63],_aTotal[64],)
(PREREG) MontaNewTMP(MesAno(_aTotal[001]),_aTotal[060])
(PREREG) _aTotal[019] := fCateg (_aTotal[014])
REG        C 004 0 "K050"
CNPJ       C 014 0 AllTrim (SM0->M0_CGC)
DT_ATUALIZ C 008 0 DataInt (_aTotal[068])
COD_REG_TR C 050 0 SRA->RA_FILIAL+SRA->RA_MAT
CPF        C 011 0 SRA->RA_CIC
NIT        C 011 0 Iif((SRA->RA_CATFUNC$"E\G"),"",Str(val(SRA->RA_PIS),11))
COD_CATEG  C 002 0 Iif((SRA->RA_CATFUNC$"E\G"),"00",_aTotal[019])
NOME_TRAB  C 050 0 SRA->RA_NOME
DT_NASC    C 008 0 DataInt (SRA->RA_NASC)
DT_ADMISSA C 008 0 DataInt (SRA->RA_ADMISSA)	
DT_DEMISSA C 008 0 If((SRA->RA_CATFUNC != "A") .And. ((SRA->RA_DEMISSA>=_aTotal[001] .And. SRA->RA_DEMISSA<=_aTotal[002]).Or. fLoadReciSRG(SRA->RA_FILIAL,SRA->RA_MAT,_aTotal[001],_aTotal[002])) , DataInt(SRA->RA_DEMISSA),"")
IND_VINC   C 001 0
TIPO_ATO_N C 001 0  
NM_ATO_NOM C 050 0 
DT_ATO_NOM C 008 0 
(POSREG) _aTotal[014] := 0
(POSREG) _aTotal[019] := ""
(POSREG) _aTotal[068] := ""
(POSREG) _aTotal[067] := SRA->RA_FILIAL
(POSREG) FsQuery({"SRD",""},2,_aTotal[62],_aTotal[63],_aTotal[64])
(POSREG) ChkItens(_aTotal[085],_aTotal[001],_aTotal[060] )
(POSREG) _aTotal[085] := ""
(POSREG) RestArea(_aTotal[091])
(POS) FsQuery({"SRA",""},2,"RA_FILIAL>='"+_aTotal[009][1][8]+"' AND RA_FILIAL<='"+ If(Empty(_aTotal[009][1][9]),Replicate("Z", FWSizeFilial() ),_aTotal[009][1][9])	+"'","RA_FILIAL>='"+_aTotal[009][1][8]+"' .AND. RA_FILIAL<='"+ If(Empty(_aTotal[009][1][9]),Replicate("Z", FWSizeFilial()),_aTotal[009][1][9])	+"'","RD_FILIAL+RD_MAT")
(POS) _aTotal[079] := If( Empty(_aTotal[079]), FWCodFil(), _aTotal[079] )
(CONT) _aTotal[016]++

[SI3 Registro Tipo K100 - Cadastro de Lotacao - SIGACON]
(CONSOLIDADO) {"_aTotal[009][1][8]", "_aTotal[009][1][9]", "COD_LTC#CNPJ","REG#DT_ATUALIZ#COD_LTC#CNPJ#DESC_LTC#CEI_TOMAD"}
(IMP) {.T.,1,4,"REG"}
(CMP) {{"DT_ATUALIZ",""},{"COD_LTC","CODIGO"},{"CNPJ",""},{"DESC_LTC","DESCRICAO"}}
(DEL)|M
(PRE) SI3->(DbGoTop ())
(PREREG) "CON"$GETMV("MV_MCONTAB")
(PREREG) "0"$_aTotal[009][5][1]
(PREREG) !EMPTY(SI3->I3_DESC)
(PREREG) SI3->I3_DTEXIS <= _aTotal[002]
(PREREG) If(!empty(SI3->I3_FILIAL),SI3->I3_FILIAL >= _aTotal[009][1][8] .and. SI3->I3_FILIAL <= If(Empty(_aTotal[009][1][9]),Replicate("Z", FWSizeFilial()),_aTotal[009][1][9]) .AND. SI3->I3_FILIAL== FWCodFil(),.t.)
(PREREG) If(empty(SI3->I3_FILIAL) .and. "1"$_aTotal[009][1][6] .and. !empty(_aTotal[009][1][10]) .and. FWCodFil() != _aTotal[079], .F., .T.)
(PREREG) If( MV_PAR06 == 1, aScan( aFilsCalc, { |x| x[2] == FWCodFil() } ) > 0, .T.)
REG        C 004 0 "K100"
DT_ATUALIZ C 008 0 DataInt(SI3->I3_DTEXIS)
COD_LTC    C 020 0 SI3->I3_CUSTO
CNPJ       C 014 0 AllTrim (SM0->M0_CGC)
DESC_LTC   C 050 0 SI3->I3_DESC
CEI_TOMAD  C 014 0 If(SI3->I3_TIPO=="2",substr(AllTrim(SI3->I3_CEI),1,12),If(empty(SI3->I3_CEI),"",SI3->I3_CEI))
(POS) Iif( "1"$_aTotal[009][1][6] .and. !empty(_aTotal[009][1][10]),If(SM0->(DbSeek(cEmpAnt+_aTotal[009][1][10])),_aTotal[078]:= FWCodFil(),"") ,.T.)
(CONT) _aTotal[069]++

[CTT Registro Tipo K100 - Cadastro de lotacao - SIGACTB]
(CONSOLIDADO) {"_aTotal[009][1][8]", "_aTotal[009][1][9]", "COD_LTC#CNPJ","REG#DT_ATUALIZ#COD_LTC#CNPJ#DESC_LTC#CEI_TOMAD"}
(IMP) {.T.,1,4,"REG"}
(CMP) {{"DT_ATUALIZ",""},{"COD_LTC","CODIGO"},{"CNPJ",""},{"DESC_LTC","DESCRICAO"}}
(DEL)|M
(PRE) CTT->(DbGoTop ())
(PREREG) "CTB"$GETMV("MV_MCONTAB")
(PREREG) "0"$_aTotal[009][5][1]
(PREREG) If( !empty(CTT->CTT_FILIAL),CTT->CTT_FILIAL>= xFilial("CTT", _aTotal[009][1][8]) .and. CTT->CTT_FILIAL<=If(Empty(_aTotal[009][1][9]),Replicate("Z", FWSizeFilial()), xFilial("CTT", _aTotal[009][1][9]) ).and. CTT->CTT_FILIAL == xFilial("CTT",FWCodFil()),.t.)
(PREREG) CTT->CTT_DTEXIS <= _aTotal[002]
(PREREG) If(empty(CTT->CTT_FILIAL) .and. "1"$_aTotal[009][1][6] .and. !empty(_aTotal[009][1][10]) .and. FWCodFil() != _aTotal[079], .F., .T.)
(PREREG) If( MV_PAR06 == 1, aScan( aFilsCalc, { |x| x[2] == FWCodFil() } ) > 0, .T.)
REG        C 004 0 "K100"
DT_ATUALIZ C 008 0 DataInt(CTT->CTT_DTEXIS)
COD_LTC    C 020 0 CTT->CTT_CUSTO
CNPJ       C 014 0 AllTrim (SM0->M0_CGC)
DESC_LTC   C 050 0 CTT->CTT_DESC01
CEI_TOMAD  C 014 0 If (CTT->CTT_TIPO=="2",substr(AllTrim(CTT->CTT_CEI),1,12),If(empty(CTT->CTT_CEI),"",CTT->CTT_CEI))	
(POS) Iif( "1"$_aTotal[009][1][6] .and. !empty(_aTotal[009][1][10]),If(SM0->(DbSeek(cEmpAnt+_aTotal[009][1][10])),_aTotal[078]:=  FWCodFil(),"") ,.T.)
(CONT) _aTotal[069]++

[SRV Registro Tipo K150 - Rubricas ]
(CONSOLIDADO) {"_aTotal[009][1][8]", "_aTotal[009][1][9]", "CNPJ#COD_RUBRIC","REG#CNPJ#DT_ATUALIZ#COD_RUBRIC#DESC_RUBRI"}
(IMP) {.T.,1,4,"REG"}
(CMP) {{"CNPJ",""},{"DT_ATUALIZ",""},{"COD_RUBRIC","RUBRICA"},{"DESC_RUBRI","DESCRICAO"}}
(DEL)|M
(PRE) SRV->(DbGoTop ())
(PREREG) fFilManad(SRV->RV_FILIAL)
(PREREG) "0"$_aTotal[009][5][1]
(PREREG) If(empty(SRV->RV_FILIAL) .and. "1"$_aTotal[009][1][6] .and. !empty(_aTotal[009][1][10]) .and. FWCodFil() != _aTotal[079], .F., .T.)
(PREREG) If( MV_PAR06 == 1, aScan( aFilsCalc, { |x| x[2] == FWCodFil() } ) > 0, .T.)
REG        C 004 0 "K150"
CNPJ       C 014 0 AllTrim (SM0->M0_CGC)
DT_ATUALIZ C 008 0 DataInt(MV_PAR01)
COD_RUBRIC C 004 0 SRV->RV_COD
DESC_RUBRI C 050 0 SRV->RV_DESC
(CONT) _aTotal[070]++ 

[RCZ Registro Tipo K200 - Contabilizacao da Folha de Pagamento]
(CONSOLIDADO) {"_aTotal[009][1][8]", "_aTotal[009][1][9]", "DT_DATA#CNPJ#COD_RUBRIC#COD_LTC#COD_CUSTO#COD_CONTA","REG#DT_DATA#CNPJ#COD_RUBRIC#COD_LTC#COD_CUSTO#COD_CONTA"}
(IMP) {.T.,1,4,"REG"}
(CMP) {{"DT_DATA",""},{"CNPJ","CNPJ"},{"COD_RUBRIC","RUBRICA"},{"COD_CUSTO","C.CUSTO"},{"COD_CONTA","CONTA"}}
(DEL)|M
(PRE) RCZ->(DbGoTop ())
(PRE) RCZ->(DbSetOrder (1))
(PREREG) If( !empty(RCZ->RCZ_FILIAL),RCZ->RCZ_FILIAL>=_aTotal[009][1][8] .and. RCZ->RCZ_FILIAL<=If(Empty(_aTotal[009][1][9]),Replicate("Z", FWSizeFilial()),_aTotal[009][1][9]) .and. RCZ->RCZ_FILIAL== FWCodFil(),.T.)
(PREREG) If( MV_PAR06 == 1, aScan( aFilsCalc, { |x| x[2] == RCZ->RCZ_FILIAL } ) > 0, .T.)
(PREREG) RCZ->RCZ_DTATUA<=_aTotal[002]
(PREREG) _aTotal[091] := SM0->( GetArea() )
(PREREG) "0"$_aTotal[009][5][1]
REG        C 004 0 "K200"
DT_DATA    C 008 0 If(RCZ->RCZ_DTATUA<MV_PAR01, DataInt(MV_PAR01),DataInt(RCZ->RCZ_DTATUA) )
CNPJ       C 014 0 AllTrim (SM0->M0_CGC)
COD_RUBRIC C 004 0 RCZ->RCZ_PD
COD_LTC    C 020 0 RCZ->RCZ_CCUSTO
COD_CUSTO  C 020 0 RCZ->RCZ_CCUSTO
COD_CONTA  C 050 0 RCZ->RCZ_CONTA
(POSREG) RestArea(_aTotal[091])
(POS) If(!empty(_aTotal[058]),fErase(_aTotal[058]+GetDBExtension()),.T.)
(POS) If(!empty(_aTotal[058]),fErase(_aTotal[058]+ OrdBagExt()),.T.)
(CONT) _aTotal[071]++

[TMP Registro Tipo K250 - Mestre de folha de pagamento]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"CNPJ",""},{"IND_FL","I"},{"COD_LTC","LOTACAO"},{"COD_REG_TR","MATRICULA"},{"DT_COMP",""},{"DT_PAGTO",""},{"COD_CBO","CBO"},{"DESC_CARGO","CARGO"},{"QTD_DEP_IR","QIR"},{"QTD_DEP_SF","QSF"},{"VL_BASE_IR","BASE IR"},{"VL_BASE_PS","BASE PS"}}
(DEL)|M
(LEG) "Campo(s): I - Indicador do tipo de folha | QIR - Quantidade de dependentes para fins de Imposto de Renda - Pessoal Física | QSF - Qtd. dependentes para fins de Sálario Família."
(PRE) TMP->(DbGoTop())
(PREREG) "0"$_aTotal[009][5][1]
REG        C 004 0 "K250"
CNPJ       C 014 0 TMP->TMP_CNPJ
IND_FL     C 001 0 TMP->TMP_INDFL
COD_LTC    C 020 0 TMP->TMP_LCT
COD_REG_TR C 050 0 TMP->TMP_FILIAL + TMP->TMP_MAT
DT_COMP    C 006 0 SUBSTR(TMP->TMP_COMP,5,2)+ SUBSTR(TMP->TMP_COMP,1,4)
DT_PAGTO   C 008 0 TMP->TMP_PGTO
COD_CBO    C 007 0 TMP->TMP_CBO
COD_OCORR  C 002 0 TMP->TMP_OCORR
DESC_CARGO C 020 0 TMP->TMP_CARGO
QTD_DEP_IR N 003 0 TMP->TMP_DEP_IR
QTD_DEP_SF N 003 0 TMP->TMP_DEP_SF
VL_BASE_IR C 017 0 TMP->TMP_BS_IR
VL_BASE_PS C 017 0 TMP->TMP_BS_PS
(POS) CriaSRDTemp(2)
(POS) _ATotal[092] := If(IfDefTop(),"",CriaSRD_DBF(1))
(POS) If(IfDefTop(),.T.,CriaSRD_DBF(2))
(CONT) _aTotal[072]++

[SRD Registro Tipo K300 - Itens de folha de pagamento ]
(IMP) {.T.,1,4,"REG"}
(CMP) {{"CNPJ",""},{"IND_FL","I"},{"COD_REG_EM","MATRICULA"},{"DT_COMP",""},{"COD_RUBRIC","RUBRICA"},{"VL_PROV_DE","PROV./DESC."},{"IND_PROV_D","P"},{"IND_BASE_I","B"},{"IND_BASE_P","P"}}
(DEL)|M
(LEG) "Campo(s): I - Indicador do tipo de folha | P - Indicação de Provento ou Desconto | B - Indicador de base de cálculo para Imposto de Renda | P - Indicador de base de cálculo para a Previdencia Social."
(PRE) _aTotal[61] := {"SRD",""}
//A verba '318' foi retirada, conforme definicao da equipe: Sustentacao/RH.
(PRE) MV_PAR60 := ""
(PRE) If( MV_PAR06 == 1, aEval( aFilsCalc, { |x| MV_PAR60 += x[2] } ), Nil )
(PRE) _aTotal[62] := If(MV_PAR06 == 2, "RD_FILIAL>='"+_aTotal[009][1][8]	+"' AND RD_FILIAL<='"+ If(Empty(_aTotal[009][1][9]),Replicate("Z", FWSizeFilial()),_aTotal[009][1][9])+"' AND ", "") + "RD_DATARQ >='"+MesAno(_aTotal[001])+"' AND RD_DATARQ<='"+ _aTotal[060]+"' AND RD_EMPRESA='"+ SPACE(02)+"' AND RD_PD <> '"+ _aTotal[013, 106,1] +"' AND RD_PD <> '"+ _aTotal[013, 107,1] +"' AND RD_PD <> '"+ _aTotal[013, 107,1] +"' AND RD_PD <> '"+ _aTotal[013, 318,1] +"' AND RD_ROTEIR != 'VEX' AND RD_ROTEIR != 'ADI' AND " + RetSqlName("SRV") + ".D_E_L_E_T_=' '"
(PRE) _aTotal[80] := {"SRV", If(xFILIAL("SRD")==xFILIAL("SRV"),"RD_FILIAL||RD_PD = RV_FILIAL||RV_COD","RD_PD = RV_COD" )}
(PRE) _aTotal[63] := If(MV_PAR06 == 2, "RD_FILIAL>='"+_aTotal[009][1][8]	+"' AND RD_FILIAL<='"+ If(Empty(_aTotal[009][1][9]),Replicate("Z", FWSizeFilial()),_aTotal[009][1][9])+"' AND ", "RD_FILIAL $ MV_PAR60") + "RD_DATARQ >='"+MesAno(_aTotal[001])+"' AND RD_DATARQ<='"+ _aTotal[060]+"' AND RD_EMPRESA='"+ SPACE(02)+"' AND RD_PD <> '"+ _aTotal[013, 106,1] +"' AND RD_PD <> '"+ _aTotal[013, 107,1] +"' AND RD_PD <> '"+ _aTotal[013, 107,1] +"' AND RD_PD <> '"+ _aTotal[013, 318,1] +"' AND RD_ROTEIR != 'VEX' AND RD_ROTEIR != 'ADI' AND " + RetSqlName("SRV") + ".D_E_L_E_T_=' '"
(PRE) _aTotal[64] := "RD_FILIAL+RD_MAT+RD_DATARQ+RD_PD+"+If(IfDefTop() .AND. TcSrvType()<>"AS/400" ,"","RD_SEMANA+RD_SEQ+")+"RD_CC"
(PRE) _aTotal[83] := "RD_FILIAL,RD_MAT,RD_DATARQ,RD_PD,RD_CC,RD_IR,RD_INSS,SUM(RD_VALOR) AS VALOR,RV_TIPOCOD,RV_IR,RV_INSS,RV_REF13,RV_FGTS,RV_CODFOL,RD_ROTEIR"
(PRE) _aTotal[84] := "RD_FILIAL,RD_MAT,RD_DATARQ,RD_PD,RD_CC,RD_IR,RD_INSS,RV_TIPOCOD,RV_IR,RV_INSS,RV_REF13,RV_FGTS,RV_CODFOL,RD_ROTEIR"             	
(PRE) If(IfDefTop(),FsQuery({"SRD",""},1,_aTotal[62],_aTotal[63],_aTotal[64],If( MV_PAR06 == 1, { "RD_FILIAL", "("+fSqlIN( MV_PAR60, FwSizeFilial() ) + ")" }, {}),_aTotal[80],_aTotal[083],_aTotal[084]),.T.)
(PRE) SRD->(DbGoTop ()) 
(PRE) SRV->(DbSetOrder (1))
(PRE) SRJ->(DbSetOrder (1))
(PREREG) "0"$_aTotal[009][5][1]
(PREREG) SRA->(MsSeek (SRD->RD_FILIAL+SRD->RD_MAT))
(PREREG) !(SRA->RA_CATFUNC $ GetNewPar("MV_CATFUNC","") )
(PREREG) SRJ->(MsSeek (If (Empty(xFilial("SRJ")), Space(FWSizeFilial()), xFilial("SRJ",SRA->RA_FILIAL))+SRA->RA_CODFUNC))
(PREREG) _aTotal[091] := SM0->( GetArea() )
(PREREG) SM0->( MsSeek (cEmpAnt+SRD->RD_FILIAL))
REG        C 004 0 "K300"
CNPJ       C 014 0 AllTrim (SM0->M0_CGC)
IND_FL     C 001 0 fNewTp_Folha(SRD->RD_PD,"MANAD")
COD_LTC    C 020 0 SRD->RD_CC
COD_REG_EM C 050 0 SRD->RD_FILIAL + SRD->RD_MAT
DT_COMP    C 006 0 SUBSTR((SRD->RD_DATARQ),5,2) + SUBSTR((SRD->RD_DATARQ),1,4)
COD_RUBRIC C 004 0 SRD->RD_PD
VL_PROV_DE C 017 0 STRTRAN(TRANSFORM(ABS(fNewValPd(1)),"@R 99999999999999.99"),".",",")
IND_PROV_D C 001 0 VER_PD (SRD->RD_PD,"MANAD")
IND_BASE_I C 001 0 GPEVerTpBase("BIRRF")
IND_BASE_P C 001 0 GPEVerTpBase("BINSS")
(POSREG) RestArea(_aTotal[091])
(POS) If(IfDefTop(),FsQuery({"SRD",""},2,_aTotal[62],_aTotal[63],_aTotal[64]),.T.)
(POS) If(IfDefTop(),.T.,CriaSRD_DBF(3))
(CONT) _aTotal[073]++

[XXX Registro Tipo K990 - Encerramento do bloco K]
(DEL)|M
(PRE) _aTotal[076]++
REG        C 004 0 "K990"
QTD_LIN_K  N 010 0 _aTotal[016]+_aTotal[069]+_aTotal[070]+_aTotal[071]+_aTotal[072]+_aTotal[073]+_aTotal[075]+_aTotal[076]

[XXX Registro Tipo L001 - Abertura do bloco L]
(DEL)|M
(PREREG) ("0"$_aTotal[009][6][1])
(PREREG) ("1"$_aTotal[009][6][2])
(PREREG) _aTotal[017]++
(PREREG) _aTotal[020,1]++
REG        C 004 0 "L001"
IND_MOV    N 001 0 Iif ("0"$_aTotal[009][6][1], 0, 1)

[SA2 Registro Tipo L750 - Fornecedores]
(CONSOLIDADO) {"_aTotal[009][1][8]", "_aTotal[009][1][9]", "EXERC#CODFORN#CNPJ#CPF#", "REG#NOMFORN#TIPFORN#NITFORN#ENDFORN#CIDFORN#UFFORN#CEP#DESCTIPF"}
(IMP) {.T.,1,4,"REG"}
(CMP) {{"EXERC",""},{"CODFORN","CODIGO"},{"NOMFORN","NOME"},{"TIPFORN","T"},{"CNPJ",""},{"NITFORN","NIT"},{"ENDFORN","ENDEREÇO"},{"CIDFORN","CIDADE"},{"UFFORN","UF"},{"CEP",""}}
(DEL)|M
(LEG) "Campo(s): T - Tipificação dos fornecedores."
(PRE) SA2->(DbGoTop ())
(PRE) SA2->(DbSeek (xFilial ("SA2")))
(PREREG) xFilial ("SA2")==SA2->A2_FILIAL
(PREREG) (SA2->A2_ULTCOM >= _aTotal[001] .And. SA2->A2_ULTCOM <= _aTotal[002])
(PREREG) "0"$_aTotal[009][6][1]
(PREREG) "1"$_aTotal[009][6][2]
(PREREG) _aTotal[017]++
(PREREG) _aTotal[020,2]++
REG        C 004 0 "L750"
EXERC      C 004 0 STRZERO(YEAR(mv_par01),4)
CODFORN    C 024 0 SA2->A2_COD+SA2->A2_LOJA
NOMFORN    C 040 0 SA2->A2_NOME
TIPFORN    N 001 0 Iif ("F"$SA2->A2_TIPO, 1, 2)
CNPJ       C 014 0 Iif ("F"$SA2->A2_TIPO, "", AllTrim (SA2->A2_CGC))
CPF        C 014 0 Iif ("F"$SA2->A2_TIPO, AllTrim (SA2->A2_CGC), "")
NITFORN    N 011 0 0
ENDFORN    C 040 0 SA2->A2_END
CIDFORN    C 020 0 SA2->A2_MUN
UFFORN     C 002 0 SA2->A2_EST
CEP        C 008 0 SA2->A2_CEP
DESCTIPF   C 200 0 ""

[XXX Registro Tipo L990 - Encerramento do bloco L]
(DEL)|M
(PREREG) "0"$_aTotal[009][6][1]
(PREREG) "1"$_aTotal[009][6][2]
(PREREG) _aTotal[017]++
(PREREG) _aTotal[020,3]++
REG        C 004 0 "L990"
QTD_LIN_L  N 010 0 _aTotal[017]

[XXX Registro Tipo 9001 - Controle e encerramento do arquivo digital - bloco 9]
(DEL)|M
(PREREG) _aTotal[018]++
REG        C 004 0 Iif("02"$_aTotal[009][1][5],"9000","9001")
IND_MOV    N 001 0 Iif (_aTotal[012,1]+_aTotal[015,9]+_aTotal[016]+_aTotal[017]>0, 0, 1)

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++   
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "0000"
IND_MOV    N 010 0 _aTotal[082]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++      
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "0001"
IND_MOV    N 010 0 1

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++      
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "0050"
IND_MOV    N 010 0 _aTotal[012,4]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++    
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "0100"
IND_MOV    N 010 0 _aTotal[012,5]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++ 
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "0990"
IND_MOV    N 010 0 _aTotal[012,3]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++ 
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "I001"
IND_MOV    N 010 0 _aTotal[015,1]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++ 
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "I005"
IND_MOV    N 010 0 _aTotal[015,2]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++    
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "I050"
IND_MOV    N 010 0 _aTotal[015,3]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++       
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "I100"
IND_MOV    N 010 0 _aTotal[015,4]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++    
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "I150"
IND_MOV    N 010 0 _aTotal[015,5]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++    
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "I200"
IND_MOV    N 010 0 _aTotal[015,6]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++ 
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "I250"
IND_MOV    N 010 0 _aTotal[015,7]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++    
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "I990"
IND_MOV    N 010 0 _aTotal[015,8]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[015,9] > 0
(PREREG) _aTotal[018]++ 
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "K001"
IND_MOV    N 010 0 1

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[015,9] > 0
(PREREG) _aTotal[018]++
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "K050"
IND_MOV    N 010 0 _aTotal[016]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[015,9] > 0
(PREREG) _aTotal[018]++ 
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "K100"
IND_MOV    N 010 0 _aTotal[069]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[015,9] > 0
(PREREG) _aTotal[018]++    
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "K150"
IND_MOV    N 010 0 _aTotal[070]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[015,9] > 0
(PREREG) _aTotal[018]++              
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "K200"
IND_MOV    N 010 0 _aTotal[071]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[015,9] > 0
(PREREG) _aTotal[018]++     
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "K250"
IND_MOV    N 010 0 _aTotal[072]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[015,9] > 0
(PREREG) _aTotal[018]++               
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "K300"
IND_MOV    N 010 0 _aTotal[073]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[015,9] > 0
(PREREG) _aTotal[018]++          
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "K990"
IND_MOV    N 010 0 1

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++     
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "L001"
IND_MOV    N 010 0 _aTotal[020,1]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++   
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "L750"
IND_MOV    N 010 0 _aTotal[020,2]

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++ 
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "L990"
IND_MOV    N 010 0 _aTotal[020,3]

//atualização
[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++ 
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 Iif("02"$_aTotal[009][1][5],"9000","9001")
IND_MOV    N 010 0 1

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++ 
(PREREG) _aTotal[093]++
REG        C 004 0 "9900"
REG_BLC    C 004 0 "9900"
IND_MOV    N 010 0 _aTotal[093]+2

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++ 
REG        C 004 0 "9900"
REG_BLC    C 004 0 "9990"
IND_MOV    N 010 0 1

[XXX Registro Tipo 9900 - Registro dos blocos]
(DEL)|M
(PREREG) _aTotal[012,1]>0
(PREREG) _aTotal[018]++ 
REG        C 004 0 "9900"
REG_BLC    C 004 0 "9999"
IND_MOV    N 010 0 1
//fim atualização

[XXX Registro Tipo 9900 - Encerramento do bloco 9]
(DEL)|M
(PREREG) _aTotal[018]++  
(PREREG) _aTotal[093]++
REG        C 004 0 "9990"
QTD_LIN_9  N 010 0 _aTotal[018]+1

[XXX Registro Tipo 9999 - Encerramento do arquivo digital]
(DEL)|M
REG        C 004 0 "9999"
QTD_LIN    N 010 0 _aTotal[012,1]+ _aTotal[015,9] +_aTotal[016]+_aTotal[017]+_aTotal[018]+_aTotal[069]+_aTotal[070]+_aTotal[071]+_aTotal[072]+_aTotal[073]+_aTotal[075]+_aTotal[076]+1

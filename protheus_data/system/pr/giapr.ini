?{"Nome do Arquivo INI","GIAPR.INI"}
?{"Descrição Completa do Arquivo Magnético","Guia de Informação e Apuração de ICMS do Estado do Paraná."}
?{"A Quem se Destina","Todos os contribuintes inscritos nos Regimes Normal de Apuração, Substituição Tributária e Especiais celebrados com a SEFA"}
?{"Objetivo","Gerar um arquivo magnético pré-formatado para a importação da GIA-ICMS."}
?{"Prazo de Entrega","O prazo de entrega e de acordo com o CNPJ do contribuinte. Maiores informacoes no site http://www.fazenda.pr.gov .br/"}
?{"Aplicativo Disponibilizado pelo Fisco","GIAPR"}
?{"Versão do Aplicativo Contemplada pela Microsiga","1.8"}
?{"Comentários",""}
[XXX PERGUNTAS]
(PRE) _aTotal[001] := MV_PAR01
(PRE) _aTotal[002] := MV_PAR02

(PRE) SX1->(DbSetOrder (1))
(PRE) Iif (SX1->(DbSeek ("GIAPR     06").And. "NAOVAZIO"$SX1->X1_VALID), (SX1->(RecLock ("SX1",.F.)), SX1->(DbDelete ()), SX1->(MsUnLock ())),.T.)
(PRE) _aTotal[003] := {"Valor dos produtos primarios"}
(PRE) aAdd (_aTotal[003], "adquiridos de contribuintes")
(PRE) aAdd (_aTotal[003], "nao inscritos.")
(PRE) _aTotal[004] := {}
(PRE) _aTotal[005] := {}
(PRE) PutSx1("GIAPR ", "06", "Vlr produtos ?", "Vlr produtos ?", "Vlr produtos ?", "mv_ch6", "N", 15, 2, 0, "G", "", "", "", "", "MV_PAR06", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _aTotal[003], _aTotal[004], _aTotal[005])
(PRE) PutSx1("GIAPR ", "08", "Considera valores do SISCRED ?", "Considera valores do SISCRED ?", "Considera valores do SISCRED ?", "mv_ch8", "N", 1, 0, 1, "C", "", "", "", "", "mv_par08", "Sim", "Si", "Yes", "", "Nao", "No", "No", "", "", "", "", "", "", "", "", "", {"Indica se serão considerados os valores ", "do SISCRED na geração da GIA. ", "Afeta os registros 59, 69 e 63."})
(PRE) Pergunte ("GIAPR ", .T.)
                                                       
[XXX Inicializacoes variaveis do ini]
(PRE) _aTotal[019] := 0
(PRE) _aTotal[099] := "{|| Iif (aScan(_aTotal[100], SF3->F3_CFO)<>0, .T., (aAdd(_aTotal[100], SF3->F3_CFO), .T.))}"
(PRE) _aTotal[100] := {}    
(PRE) _aTotal[101] := {}
(PRE) _aTotal[102] := 0
(PRE) FsEstInv ({"GLO",""}, 1,,,,.T.)

[GLO ************************************************ INVENTARIO ****************************************************]
(PRE) dbGoTop()
(PRE) _aTotal[006] := 0
(PREREG) _aTotal[006] += GLO->CUSTO
(POS) FsEstInv ({"GLO",""}, 2,,,,.T.)
      
[XXX ************************************************ ENTRADAS ******************************************************]
(PRE) _aTotal[010] := {"SF3", ""}
(PRE) FsQuery (_aTotal[010], 1, "F3_FILIAL='"+xFilial("SF3")+"' AND F3_ENTRADA>='"+DTOS (_aTotal[001])+"' AND F3_ENTRADA<='"+DTOS (_aTotal[002]) + "' AND F3_CFO NOT IN ('1601','1602','1605','5601','5602','5605')  OR ( F3_CFO IN ('1601','1602','1605','5601','5602','5605') AND F3_ENTRADA>='"+DTOS (_aTotal[001]+10)+"' AND F3_ENTRADA<='"+DTOS (_aTotal[002]+11) +"') AND SUBSTRING(F3_CFO,1,1)<'5' AND F3_DTCANC='' AND F3_TIPO <> 'S' ", "F3_FILIAL=='"+xFilial ("SF3")+"' .AND. DTOS (F3_ENTRADA)>='"+DTOS (_aTotal[001])+"' .AND. DTOS (F3_ENTRADA)<='"+DTOS (_aTotal[002])+"' .AND. SUBS (F3_CFO, 1, 1)<'5' .And. Empty(F3_DTCANC) .And. F3_TIPO <> 'S' ", SF3->(IndexKey ()))
(PRE) SF3->(DbGotop ())

[SF3 VALORES FISCAIS]
(PRE) _aTotal[020] := 0
(PRE) _aTotal[021] := 0
(PRE) _aTotal[022] := 0
(PRE) _aTotal[023] := 0
(PRE) _aTotal[024] := 0
(PRE) _aTotal[025] := 0
(PRE) _aTotal[026] := 0
(PRE) _aTotal[027] := 0
(PRE) _aTotal[028] := 0
(PRE) _aTotal[029] := 0
(PRE) _aTotal[030] := 0
(PRE) _aTotal[031] := 0                       
(PRE) _aTotal[032] := 0
(PRE) _aTotal[033] := 0
(PRE) _aTotal[034] := 0
(PRE) _aTotal[035] := 0 
(PRE) _aTotal[055] := 0
(PRE) _aTotal[065] := 0
(PREREG) Iif ((AllTrim (SF3->F3_CFO)$"#1101#1102#1111#1113#1116#1117#1118#1120#1121#1122#1124#1125#1126#1151#1152#1154#1201#1202#1203#1204#1206#1208#1209#1501#1503#1504#1651#1658#1660#1932#" .Or. (AllTrim (SF3->F3_CFO)>="1351" .And. AllTrim (SF3->F3_CFO)<="1356")) .And. SF3->F3_ICMSRET==0, (_aTotal[020] += SF3->F3_VALCONT, Eval (&(_aTotal[099])),.T.),.T.)
(PREREG) Iif ((AllTrim (SF3->F3_CFO)$"#1101#1102#1111#1113#1116#1117#1118#1120#1121#1122#1124#1125#1126#1151#1152#1154#1201#1202#1203#1204#1206#1208#1209#1501#1503#1504#1651#1658#1660#1932#" .Or. (AllTrim (SF3->F3_CFO)>="1351" .And. AllTrim (SF3->F3_CFO)<="1356")) .And. SF3->F3_ICMSRET==0, (_aTotal[021] += SF3->F3_BASEICM, Eval (&(_aTotal[099])),.T.),.T.)
(PREREG) Iif ((AllTrim (SF3->F3_CFO)$"#2101#2102#2111#2113#2116#2117#2118#2124#2125#2126#2151#2152#2154#2201#2202#2203#2204#2206#2208#2209#2501#2503#2504#2651#2658#2660#2932#" .Or. (AllTrim (SF3->F3_CFO)>="2120" .And. AllTrim (SF3->F3_CFO)<="2122") .Or. (AllTrim (SF3->F3_CFO)>="2351" .And. AllTrim (SF3->F3_CFO)<="2356")) .And. SF3->F3_ICMSRET==0, (_aTotal[022] += SF3->F3_VALCONT, Eval (&(_aTotal[099])), .T.), .T.)
(PREREG) Iif ((AllTrim (SF3->F3_CFO)$"#2101#2102#2111#2113#2116#2117#2118#2124#2125#2126#2151#2152#2154#2201#2202#2203#2204#2206#2208#2209#2501#2503#2504#2651#2658#2660#2932#" .Or. (AllTrim (SF3->F3_CFO)>="2120" .And. AllTrim (SF3->F3_CFO)<="2122") .Or. (AllTrim (SF3->F3_CFO)>="2351" .And. AllTrim (SF3->F3_CFO)<="2356")) .And. SF3->F3_ICMSRET==0, (_aTotal[023] += SF3->F3_BASEICM, Eval (&(_aTotal[099])), .T.), .T.)
(PREREG) Iif (AllTrim  (SF3->F3_CFO)$"#3101#3102#3126#3127#3201#3202#3206#3211#3503#3651#3930#3949#" .Or. (AllTrim (SF3->F3_CFO)>="3351" .And. AllTrim (SF3->F3_CFO)<="3356"), (_aTotal[024] += SF3->F3_VALCONT, Eval (&(_aTotal[099])), .T.), .T.)
(PREREG) Iif (AllTrim  (SF3->F3_CFO)$"#3101#3102#3126#3127#3201#3202#3206#3211#3503#3651#3930#3949#" .Or. (AllTrim (SF3->F3_CFO)>="3351" .And. AllTrim (SF3->F3_CFO)<="3356"), (_aTotal[025] += SF3->F3_BASEICM, Eval (&(_aTotal[099])), .T.), .T.)
(PREREG) Iif ((AllTrim (SF3->F3_CFO)$"#1401#1403#1414#1415#1652#1653#1659#1661#1662#2401#2403#2414#2415#2652#2653#2659#2661#2662#3652#3653#" .Or. (AllTrim (SF3->F3_CFO)>="1406" .And. AllTrim (SF3->F3_CFO)<="1411").Or. (AllTrim (SF3->F3_CFO)>="2406" .And. AllTrim (SF3->F3_CFO)<="2411")),(_aTotal[026] += SF3->F3_VALCONT, Eval (&(_aTotal[099])), .T.), .T.)
(PREREG) Iif ((AllTrim (SF3->F3_CFO)$"#1401#1403#1414#1415#1652#1653#1659#1661#1662#2401#2403#2414#2415#2652#2653#2659#2661#2662#3652#3653#" .Or. (AllTrim (SF3->F3_CFO)>="1406" .And. AllTrim (SF3->F3_CFO)<="1411").Or. (AllTrim (SF3->F3_CFO)>="2406" .And. AllTrim (SF3->F3_CFO)<="2411")) .And. SF3->F3_ICMSRET<>0, (_aTotal[027] += SF3->F3_BASERET, Eval (&(_aTotal[099])), .T.), .T.)
(PREREG) Iif (AllTrim  (SF3->F3_CFO)$"#3551#3553#3556#" .Or. (AllTrim (SF3->F3_CFO)>="1551" .And. AllTrim (SF3->F3_CFO)<="1557") .Or. (AllTrim (SF3->F3_CFO)>="2551" .And. AllTrim (SF3->F3_CFO)<="2557"), (_aTotal[028] += SF3->F3_VALCONT, _aTotal[029] += SF3->F3_BASEICM, Eval (&(_aTotal[099])), .T.), .T.)
(PREREG) Iif (AllTrim  (SF3->F3_CFO)$"#1153#1207#2153#2207#3207#3251" .Or. (AllTrim (SF3->F3_CFO)>="1251" .And. AllTrim (SF3->F3_CFO)<="1257") .Or. (AllTrim (SF3->F3_CFO)>="2251" .And. AllTrim (SF3->F3_CFO)<="2257"), (_aTotal[030] += SF3->F3_VALCONT, _aTotal[031] += SF3->F3_BASEICM, Eval (&(_aTotal[099])), .T.), .T.)
(PREREG) Iif (AllTrim  (SF3->F3_CFO)$"#1205#2205#3205#3301#" .Or. (AllTrim (SF3->F3_CFO)>="1301" .And. AllTrim (SF3->F3_CFO)<="1306") .Or. (AllTrim (SF3->F3_CFO)>="2301" .And. AllTrim (SF3->F3_CFO)<="2306"), (_aTotal[032] += SF3->F3_VALCONT, _aTotal[033] += SF3->F3_BASEICM, Eval (&(_aTotal[099])), .T.), .T.)
(PREREG) Iif (aScan(_aTotal[100], SF3->F3_CFO)==0, (_aTotal[034] += SF3->F3_VALCONT, _aTotal[035] += SF3->F3_BASEICM, .T.), .T.)
(PREREG) Iif (AllTrim  (SF3->F3_CFO)$"#1605#", (_aTotal[055] += SF3->F3_TRFICM, _aTotal[055] += 0, Eval (&(_aTotal[099])), .T.), .T.)
(PREREG) Iif (AllTrim  (SF3->F3_CFO)$"#1602#", (_aTotal[065] += SF3->F3_TRFICM, _aTotal[065] += 0, Eval (&(_aTotal[099])), .T.), .T.)
(POS) _aTotal[019] += Iif (_aTotal[020]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[021]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[022]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[023]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[024]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[025]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[026]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[027]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[028]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[029]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[030]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[031]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[032]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[033]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[034]<>0, 1, 0)                                                                        
(POS) _aTotal[019] += Iif (_aTotal[035]<>0, 1, 0)
(POS) FsQuery (_aTotal[010], 2)

[XXX ************************************************** SAIDAS ******************************************************]
(PRE) _aTotal[010] := {"SF3", ""}
(PRE) FsQuery (_aTotal[010], 1, "F3_FILIAL='"+xFilial("SF3")+"' AND F3_ENTRADA>='"+DTOS (_aTotal[001])+"' AND F3_ENTRADA<='"+DTOS (_aTotal[002]) + "' AND F3_CFO NOT IN ('1601','1602','1605','5601','5602','5605')  OR ( F3_CFO IN ('1601','1602','1605','5601','5602','5605') AND F3_ENTRADA>='"+DTOS (_aTotal[001]+10)+"' AND F3_ENTRADA<='"+DTOS (_aTotal[002]+11) + "') AND SUBSTRING(F3_CFO,1,1)>='5' AND F3_DTCANC='' AND F3_TIPO <> 'S' ", "F3_FILIAL=='"+xFilial ("SF3")+"' .AND. DTOS (F3_ENTRADA)>='"+DTOS (_aTotal[001])+"' .AND. DTOS (F3_ENTRADA)<='"+DTOS (_aTotal[002])+"' .AND. SUBS (F3_CFO, 1, 1)>='5' .And. Empty(F3_DTCANC) .And. F3_TIPO <> 'S' ", SF3->(IndexKey ()))
(PRE) _aTotal[100] := {}
(PRE) SF3->(DbGotop ())
                                                               
[SF3 VALORES FISCAIS]
(PRE) _aTotal[036] := 0
(PRE) _aTotal[037] := 0
(PRE) _aTotal[038] := 0
(PRE) _aTotal[039] := 0
(PRE) _aTotal[040] := 0
(PRE) _aTotal[041] := 0
(PRE) _aTotal[042] := 0
(PRE) _aTotal[043] := 0
(PRE) _aTotal[044] := 0
(PRE) _aTotal[045] := 0
(PRE) _aTotal[046] := 0
(PRE) _aTotal[047] := 0    
(PRE) _aTotal[066] := 0

//campo31
(PREREG) Iif ((AllTrim (SF3->F3_CFO)$"#5122#5123#5124#5125#5151#5152#5153#5155#5156#5201#5202#5359#5501#5502#5503#5651#5658#5660#5932#" .Or. (AllTrim (SF3->F3_CFO)>="5101" .And. AllTrim (SF3->F3_CFO)<="5106") .Or. (AllTrim (SF3->F3_CFO)>="5109" .And. AllTrim (SF3->F3_CFO)<="5120") .Or. (AllTrim (SF3->F3_CFO)>="5205" .And. AllTrim (SF3->F3_CFO)<="5210") .Or. (AllTrim (SF3->F3_CFO)>="5251" .And. AllTrim (SF3->F3_CFO)<="5258") .Or. (AllTrim (SF3->F3_CFO)>="5301" .And. AllTrim (SF3->F3_CFO)<="5307") .Or. (AllTrim (SF3->F3_CFO)>="5351" .And. AllTrim (SF3->F3_CFO)<="5357")) .And. SF3->F3_ICMSRET==0, (_aTotal[036] += SF3->F3_VALCONT, Eval (&(_aTotal[099])), .T.), .T.)
//campo 41
(PREREG) Iif ((AllTrim (SF3->F3_CFO)$"#5122#5123#5124#5125#5151#5152#5153#5155#5156#5201#5202#5359#5501#5502#5503#5651#5658#5660#5932#" .Or. (AllTrim (SF3->F3_CFO)>="5101" .And. AllTrim (SF3->F3_CFO)<="5106") .Or. (AllTrim (SF3->F3_CFO)>="5109" .And. AllTrim (SF3->F3_CFO)<="5120") .Or. (AllTrim (SF3->F3_CFO)>="5205" .And. AllTrim (SF3->F3_CFO)<="5210") .Or. (AllTrim (SF3->F3_CFO)>="5251" .And. AllTrim (SF3->F3_CFO)<="5258") .Or. (AllTrim (SF3->F3_CFO)>="5301" .And. AllTrim (SF3->F3_CFO)<="5307") .Or. (AllTrim (SF3->F3_CFO)>="5351" .And. AllTrim (SF3->F3_CFO)<="5357")) .And. SF3->F3_ICMSRET==0, (_aTotal[037] += SF3->F3_BASEICM, Eval (&(_aTotal[099])), .T.), .T.)
//campo 33
(PREREG) Iif ((AllTrim (SF3->F3_CFO)$"#6122#6123#6124#6125#6151#6152#6153#6155#6156#6201#6202#6359#6501#6502#6503#6651#6658#6660#6932#" .Or. (AllTrim (SF3->F3_CFO)>="6101" .And. AllTrim (SF3->F3_CFO)<="6120") .Or. (AllTrim (SF3->F3_CFO)>="6205" .And. AllTrim (SF3->F3_CFO)<="6210") .Or. (AllTrim (SF3->F3_CFO)>="6251" .And. AllTrim (SF3->F3_CFO)<="6258") .Or. (AllTrim (SF3->F3_CFO)>="6301" .And. AllTrim (SF3->F3_CFO)<="6307") .Or. (AllTrim (SF3->F3_CFO)>="6351" .And. AllTrim (SF3->F3_CFO)<="6357"))  .And. SF3->F3_ICMSRET==0, (_aTotal[038] += SF3->F3_VALCONT, Eval (&(_aTotal[099])), .T.), .T.)
// campo 43
(PREREG) Iif ((AllTrim (SF3->F3_CFO)$"#6122#6123#6124#6125#6151#6152#6153#6155#6156#6201#6202#6359#6501#6502#6503#6651#6658#6660#6932#" .Or. (AllTrim (SF3->F3_CFO)>="6101" .And. AllTrim (SF3->F3_CFO)<="6120") .Or. (AllTrim (SF3->F3_CFO)>="6205" .And. AllTrim (SF3->F3_CFO)<="6210") .Or. (AllTrim (SF3->F3_CFO)>="6251" .And. AllTrim (SF3->F3_CFO)<="6258") .Or. (AllTrim (SF3->F3_CFO)>="6301" .And. AllTrim (SF3->F3_CFO)<="6307") .Or. (AllTrim (SF3->F3_CFO)>="6351" .And. AllTrim (SF3->F3_CFO)<="6357"))  .And. SF3->F3_ICMSRET==0, (_aTotal[039] += SF3->F3_BASEICM, Eval (&(_aTotal[099])), .T.), .T.)
//campo34
(PREREG) Iif (AllTrim (SF3->F3_CFO)$"#7101#7102#7105#7106#7127#7201#7202#7205#7206#7207#7210#7211#7251#7301#7358#7501#7651#7654#7930#7949#", (_aTotal[040] += SF3->F3_VALCONT, Eval (&(_aTotal[099])), .T.), .T.)
// campo 44
(PREREG) Iif (AllTrim (SF3->F3_CFO)$"#7101#7102#7105#7106#7127#7201#7202#7205#7206#7207#7210#7211#7251#7301#7358#7501#7651#7654#7930#7949#", (_aTotal[041] += SF3->F3_BASEICM, Eval (&(_aTotal[099])), .T.), .T.)
//campo35
(PREREG) Iif ((AllTrim (SF3->F3_CFO)$"#5401#5402#5403#5405#5659#5661#5662#6401#6402#6403#6404#6659#6661#6662#" .Or. (AllTrim (SF3->F3_CFO)>="5408" .And. AllTrim (SF3->F3_CFO)<="5415") .Or. (AllTrim (SF3->F3_CFO)>="5652" .And. AllTrim (SF3->F3_CFO)<="5657") .Or. (AllTrim (SF3->F3_CFO)>="6408" .And. AllTrim (SF3->F3_CFO)<="6415") .Or. (AllTrim (SF3->F3_CFO)>="6652" .And. AllTrim (SF3->F3_CFO)<="6657")) .And. SF3->F3_ICMSRET<>0, (_aTotal[042] += SF3->F3_VALCONT, Eval (&(_aTotal[099])), .T.), .T.)
//campo 45
(PREREG) Iif ((AllTrim (SF3->F3_CFO)$"#5401#5402#5403#5405#5659#5661#5662#6401#6402#6403#6404#6659#6661#6662#" .Or. (AllTrim (SF3->F3_CFO)>="5408" .And. AllTrim (SF3->F3_CFO)<="5415") .Or. (AllTrim (SF3->F3_CFO)>="5652" .And. AllTrim (SF3->F3_CFO)<="5657") .Or. (AllTrim (SF3->F3_CFO)>="6408" .And. AllTrim (SF3->F3_CFO)<="6415") .Or. (AllTrim (SF3->F3_CFO)>="6652" .And. AllTrim (SF3->F3_CFO)<="6657")) .And. SF3->F3_ICMSRET<>0, (_aTotal[043] += SF3->F3_BASERET, Eval (&(_aTotal[099])), .T.), .T.)
//campo 36 e 46
(PREREG) Iif (AllTrim (SF3->F3_CFO)$"#7551#7553#7556#" .Or. (AllTrim (SF3->F3_CFO)>="5551" .And. AllTrim (SF3->F3_CFO)<="5557") .Or. (AllTrim (SF3->F3_CFO)>="6551" .And. AllTrim (SF3->F3_CFO)<="6557"), (_aTotal[044] += SF3->F3_VALCONT, _aTotal[045] += SF3->F3_BASEICM, Eval (&(_aTotal[099])), .T.), .T.)
//campo 55
(PREREG) Iif (AllTrim (SF3->F3_CFO)$"#5602#", (_aTotal[055] += SF3->F3_TRFICM, _aTotal[055] += 0, Eval (&(_aTotal[099])), .T.), .T.)
//campo 65
(PREREG) Iif (AllTrim (SF3->F3_CFO)$"#5605#", (_aTotal[065] += SF3->F3_TRFICM, _aTotal[065] += 0, Eval (&(_aTotal[099])), .T.), .T.)
(PREREG) Iif (aScan (_aTotal[100], SF3->F3_CFO)==0, (_aTotal[046] += SF3->F3_VALCONT, _aTotal[047] += SF3->F3_BASEICM, .T.), .T.)
(POS) _aTotal[019] += Iif (_aTotal[036]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[037]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[038]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[039]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[040]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[041]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[042]<>0, 1, 0)                                                                        
(POS) _aTotal[019] += Iif (_aTotal[043]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[044]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[045]<>0, 1, 0)
(POS) _aTotal[019] += Iif (_aTotal[046]<>0, 1, 0)                                                                        
(POS) _aTotal[019] += Iif (_aTotal[047]<>0, 1, 0)
(POS) FsQuery (_aTotal[010], 2)

[XXX ******************************************** APURACAO DE ICMS/ST ************************************************]
(PRE) _aTotal[050] := FisApur ("IC", Val (SubStr (DToS (_aTotal[001]), 1, 4)), Val (SubStr (DToS (_aTotal[001]), 5, 2)), 2, 0, "*", .F., {}, 1, .F., "")
[XXX DEBITOS DE ICMS - TRANSPORTAR DO RAICMS]
(PRE) _aTotal[051] := Iif (aScan (_aTotal[050], {|a| a[1]=="001"})<>0, _aTotal[050][aScan (_aTotal[050], {|a| a[1]=="001"})][3], 0)
(PRE) _aTotal[019] += Iif (_aTotal[051]<>0, 1, 0)
(PRE) _aTotal[052] := Iif (aScan (_aTotal[050], {|a| a[4]=="002.07" .Or. a[4]=="002.00" })<>0, _aTotal[050][aScan (_aTotal[050], {|a| a[4]=="002.07" .Or. a[4]=="002.00"})][3], 0)
(PRE) _aTotal[019] += Iif (_aTotal[052]<>0, 1, 0)
(PRE) _aTotal[053] := Iif (aScan (_aTotal[050], {|a| a[1]=="003"})<>0, _aTotal[050][aScan (_aTotal[050], {|a| a[1]=="003"})][3], 0)
(PRE) _aTotal[019] += Iif (_aTotal[053]<>0, 1, 0)
(PRE) _aTotal[054] := Iif (aScan (_aTotal[050], {|a| a[1]=="016"})<>0, _aTotal[050][aScan (_aTotal[050], {|a| a[1]=="016"})][3], 0)
(PRE) _aTotal[019] += Iif (_aTotal[054]<>0, 1, 0)
(PRE) _aTotal[019] += Iif (_aTotal[055]<>0, 1, 0)
(PRE) _aTotal[056] := 0
(PRE) _aTotal[019] += Iif (_aTotal[056]<>0, 1, 0)
(PRE) _aTotal[057] := 0
(PRE) _aTotal[019] += Iif (_aTotal[057]<>0, 1, 0)
(PRE) _aTotal[058] := 0
(PRE) _aTotal[019] += Iif (_aTotal[058]<>0, 1, 0)
(PRE) _aTotal[059] := Iif (MV_PAR08==1 .And. aScan (_aTotal[050], {|a| a[1]=="021"})<>0, _aTotal[050][aScan (_aTotal[050], {|a| a[1]=="021"})][3], 0)
(PRE) _aTotal[019] += Iif (_aTotal[059]<>0, 1, 0)
(PRE) _aTotal[060] := _aTotal[051]+_aTotal[052]+_aTotal[053]+_aTotal[054]+_aTotal[055]+_aTotal[056]+_aTotal[057]+_aTotal[058]+_aTotal[059]
(PRE) _aTotal[019] += Iif (_aTotal[060]<>0, 1, 0)

[SD1 CREDITOS DEVIDO PELA QUISICAO DE BENS DE CONSUMO - 67 ]
(PRE) _aTotal[067] := 0 
(PRE) _aTotal[010] := {"SD1", ""}
(PRE) FsQuery (_aTotal[010], 1, "D1_FILIAL='"+xFilial("SD1")+"' AND D1_EMISSAO>='"+DTOS (_aTotal[001])+"' AND D1_EMISSAO<='"+DTOS (_aTotal[002])+"' AND SUBSTRING(D1_CF,1,1)<'4' AND D1_VALICM>0", "D1_FILIAL=='"+xFilial ("SD1")+"' .AND. DTOS (D1_EMISSAO)>='"+DTOS (_aTotal[001])+"' .AND. DTOS (D1_EMISSAO)<='"+DTOS (_aTotal[002])+"' .AND. SUBSTR (D1_CF, 1, 1)<'4' .And. D1_VALICM>0", SD1->(IndexKey ()))
(PRE) SD1->(DbGotop ())
(PREREG) SF4->(dbSeek(xFilial("SF4")+SD1->D1_TES)) .And. If(!Empty(SD1->D1_CODISS),.T.,SF4->F4_LFICM<>'N')
(PREREG) _aTotal[067] += IIF(SF4->F4_CREDICM=="N" .And. SF4->F4_CONSUMO=="S" .And. Year (_aTotal[001])>=2007, SD1->D1_VALICM,0)
(POS) FsQuery (_aTotal[010], 2)

[XXX CREDITOS DE ICMS - TRANSPORTAR DO RAICMS] 
(PRE) _aTotal[101] := {"CDH", ""}
(PRE) FsQuery (_aTotal[101], 1, "CDH_FILIAL='"+xFilial("CDH")+"' AND CDH_DTINI>='"+DTOS (_aTotal[001])+"' AND CDH_DTFIM<='"+DTOS (_aTotal[002])+"' AND CDH_CODLAN = 'PR020021' ", "CDH_FILIAL=='"+xFilial ("CDH")+"' .AND. DTOS (CDH_DTINI)>='"+DTOS (_aTotal[001])+"' .AND. DTOS (CDH_DTFIM)<='"+DTOS (_aTotal[002])+"' AND CDH_CODLAN = 'PR020021' ", CDH->(IndexKey ()))
(PRE) CDH->(DbGotop ()) 
(PRE) _aTotal[102]:= IIF(CDH_VALOR <> 0, CDH_VALOR, 0)  
(PRE) _aTotal[066] :=_aTotal[102] 
(PRE) _aTotal[061] := Iif (aScan (_aTotal[050], {|a| a[1]=="009"})<>0, _aTotal[050][aScan (_aTotal[050], {|a| a[1]=="009"})][3], 0)
(PRE) _aTotal[019] += Iif (_aTotal[061]<>0, 1, 0)
(PRE) _aTotal[062] := Iif (aScan (_aTotal[050], {|a| a[1]=="005"})<>0, _aTotal[050][aScan (_aTotal[050], {|a| a[1]=="005"})][3], 0)
(PRE) _aTotal[019] += Iif (_aTotal[062]<>0, 1, 0)    
(PRE) _aTotal[063] := GIAPRREG63(MV_PAR08 == 1)
(PRE) _aTotal[019] += Iif (_aTotal[063]<>0, 1, 0)
(PRE) _aTotal[064] := Iif (aScan (_aTotal[050], {|a| a[1]=="007"})<>0, _aTotal[050][aScan (_aTotal[050], {|a| a[1]=="007"})][3], 0)
(PRE) _aTotal[019] += Iif (_aTotal[064]<>0, 1, 0)
(PRE) _aTotal[019] += Iif (_aTotal[065]<>0, 1, 0)
(PRE) _aTotal[010] := {"SF3", ""}
(PRE) FsQuery (_aTotal[010], 1, "F3_FILIAL='"+xFilial("SF3")+"' AND F3_ENTRADA>='"+DTOS (_aTotal[001])+"' AND F3_ENTRADA<='"+DTOS (_aTotal[002])+"' AND SUBSTRING(F3_CFO,1,1)<'4' AND F3_VALICM>0 AND F3_TIPO <> 'S' ", "F3_FILIAL=='"+xFilial ("SF3")+"' .AND. DTOS (F3_ENTRADA)>='"+DTOS (_aTotal[001])+"' .AND. DTOS (F3_ENTRADA)<='"+DTOS (_aTotal[002])+"' .AND. SUBSTR (F3_CFO, 1, 1)<'4' .And. F3_VALICM>0 .And. F3_TIPO <> 'S' ", SF3->(IndexKey ()))
(PRE) SF3->(DbGotop ())   
(PRE) IIF(SubStr(AllTrim (F3_CFO), 2, 3)$'1604' .And. Year (_aTotal[001])>=2003 .And. F3_VALICM> 0, _aTotal[066]+= F3_VALICM, _aTotal[066]+=0)
(PRE) _aTotal[019] += Iif (_aTotal[066]<>0, 1, 0)
(PRE) FsQuery (_aTotal[010], 2)
(PRE) _aTotal[019] += Iif (_aTotal[067]<>0, 1, 0)
(PRE) FsQuery (_aTotal[010], 2)
(PRE) _aTotal[068] := 0
(PRE) _aTotal[019] += Iif (_aTotal[068]<>0, 1, 0)
(PRE) _aTotal[069] := Iif (MV_PAR08 == 1 .And. aScan (_aTotal[050], {|a| a[1]=="021"})<>0, _aTotal[050][aScan (_aTotal[050], {|a| a[1]=="021"})][3], 0)
(PRE) _aTotal[019] += Iif (_aTotal[069]<>0, 1, 0)
(PRE) _aTotal[070] := _aTotal[061]+_aTotal[062]+_aTotal[063]+_aTotal[064]+_aTotal[065]+_aTotal[066]+_aTotal[067]+_aTotal[068]+_aTotal[069]
(PRE) _aTotal[019] += Iif (_aTotal[070]<>0, 1, 0)
(PRE) _aTotal[080] := Iif ((_aTotal[070]-_aTotal[060])<0, 0, _aTotal[070]-_aTotal[060])
(PRE) _aTotal[019] += Iif (_aTotal[080]<>0, 1, 0)
(PRE) _aTotal[090] := Iif ((_aTotal[060]-_aTotal[070])<0, 0, _aTotal[060]-_aTotal[070])
(PRE) _aTotal[019] += Iif (_aTotal[090]<>0, 1, 0)

[XXX ATUALIZANDO VARIAVEL DE SOMA DAS LINHAS DO QUADRO 2 PARA O QUADRO 1 QUE NAO ENTRARAM NA CONTAGEM ACIMA]
(PRE) _aTotal[019] += Iif (MV_PAR05<>0, 1, 0)
(PRE) _aTotal[019] += Iif (MV_PAR06<>0, 1, 0)
(PRE) _aTotal[019] += Iif (MV_PAR07<>0, 1, 0)
(PRE) _aTotal[019] += Iif ((MV_PAR05+MV_PAR06+MV_PAR07)<>0, 1, 0)
(PRE) _aTotal[019] += Iif ((_aTotal[020]+_aTotal[022]+_aTotal[024]+_aTotal[026]+_aTotal[028]+_aTotal[030]+_aTotal[032]+_aTotal[034])<>0, 1, 0)
(PRE) _aTotal[019] += Iif ((_aTotal[021]+_aTotal[023]+_aTotal[025]+_aTotal[027]+_aTotal[029]+_aTotal[031]+_aTotal[033]+_aTotal[035])<>0, 1, 0)
(PRE) _aTotal[019] += Iif ((_aTotal[036]+_aTotal[038]+_aTotal[040]+_aTotal[042]+_aTotal[044]+_aTotal[046])<>0, 1, 0)
(PRE) _aTotal[019] += Iif ((_aTotal[037]+_aTotal[039]+_aTotal[041]+_aTotal[043]+_aTotal[045]+_aTotal[047])<>0, 1, 0)

[XXX Registro tipo 1]
TIPO       N 001 0 1
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
CRC        C 010 0 MV_PAR02
ESTOQUE    N 015 2 _aTotal[006]
QTDFUNC    N 005 0 MV_PAR03
VLRFOLHA   N 015 2 MV_PAR04
QTDTIPO2   N 002 0 _aTotal[019]
                     
[XXX Registro tipo 2 - 2]
(PREREG) !(MV_PAR05==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 2
VLRLINHA   N 015 2 MV_PAR05
                           
[XXX Registro tipo 2 - 4]
(PREREG) !(MV_PAR06==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 4
VLRLINHA   N 015 2 MV_PAR06

[XXX Registro tipo 2 - 6]
(PREREG) !(MV_PAR07==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 6
VLRLINHA   N 015 2 MV_PAR07

[XXX Registro tipo 2 - 10]
(PREREG) !((MV_PAR05+MV_PAR06+MV_PAR07)==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 10
VLRLINHA   N 015 2 MV_PAR05+MV_PAR06+MV_PAR07

[XXX Registro tipo 2 - 11]
(PREREG) !(_aTotal[020]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 11
VLRLINHA   N 015 2 _aTotal[020]

[XXX Registro tipo 2 - 13]
(PREREG) !(_aTotal[022]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 13
VLRLINHA   N 015 2 _aTotal[022]

[XXX Registro tipo 2 - 14]
(PREREG) !(_aTotal[024]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 14
VLRLINHA   N 015 2 _aTotal[024]

[XXX Registro tipo 2 - 15]
(PREREG) !(_aTotal[026]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 15
VLRLINHA   N 015 2 _aTotal[026]

[XXX Registro tipo 2 - 16]
(PREREG) !(_aTotal[028]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 16
VLRLINHA   N 015 2 _aTotal[028]

[XXX Registro tipo 2 - 17]
(PREREG) !(_aTotal[030]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 17
VLRLINHA   N 015 2 _aTotal[030]

[XXX Registro tipo 2 - 18]
(PREREG) !(_aTotal[032]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 18
VLRLINHA   N 015 2 _aTotal[032]

[XXX Registro tipo 2 - 19]
(PREREG) !(_aTotal[034]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 19
VLRLINHA   N 015 2 _aTotal[034]

[XXX Registro tipo 2 - 20]
(PREREG) !((_aTotal[020]+_aTotal[022]+_aTotal[024]+_aTotal[026]+_aTotal[028]+_aTotal[030]+_aTotal[032]+_aTotal[034])==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 20
VLRLINHA   N 015 2 _aTotal[020]+_aTotal[022]+_aTotal[024]+_aTotal[026]+_aTotal[028]+_aTotal[030]+_aTotal[032]+_aTotal[034]

[XXX Registro tipo 2 - 21]
(PREREG) !(_aTotal[021]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 21
VLRLINHA   N 015 2 _aTotal[021]

[XXX Registro tipo 2 - 23]
(PREREG) !(_aTotal[023]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 23
VLRLINHA   N 015 2 _aTotal[023]

[XXX Registro tipo 2 - 24]
(PREREG) !(_aTotal[025]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 24
VLRLINHA   N 015 2 _aTotal[025]

[XXX Registro tipo 2 - 25]
(PREREG) !(_aTotal[027]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 25
VLRLINHA   N 015 2 _aTotal[027]

[XXX Registro tipo 2 - 26]
(PREREG) !(_aTotal[029]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 26
VLRLINHA   N 015 2 _aTotal[029]

[XXX Registro tipo 2 - 27]
(PREREG) !(_aTotal[031]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 27
VLRLINHA   N 015 2 _aTotal[031]

[XXX Registro tipo 2 - 28]
(PREREG) !(_aTotal[033]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 28
VLRLINHA   N 015 2 _aTotal[033]

[XXX Registro tipo 2 - 29]
(PREREG) !(_aTotal[035]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 29
VLRLINHA   N 015 2 _aTotal[035]

[XXX Registro tipo 2 - 30]
(PREREG) !((_aTotal[021]+_aTotal[023]+_aTotal[025]+_aTotal[027]+_aTotal[029]+_aTotal[031]+_aTotal[033]+_aTotal[035])==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 30
VLRLINHA   N 015 2 _aTotal[021]+_aTotal[023]+_aTotal[025]+_aTotal[027]+_aTotal[029]+_aTotal[031]+_aTotal[033]+_aTotal[035]

[XXX Registro tipo 2 - 31]
(PREREG) !(_aTotal[036]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 31
VLRLINHA   N 015 2 _aTotal[036]

[XXX Registro tipo 2 - 33]
(PREREG) !(_aTotal[038]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 33
VLRLINHA   N 015 2 _aTotal[038]
                              
[XXX Registro tipo 2 - 34]
(PREREG) !(_aTotal[040]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 34
VLRLINHA   N 015 2 _aTotal[040]
                              
[XXX Registro tipo 2 - 35]
(PREREG) !(_aTotal[042]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 35
VLRLINHA   N 015 2 _aTotal[042]

[XXX Registro tipo 2 - 36]
(PREREG) !(_aTotal[044]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 36
VLRLINHA   N 015 2 _aTotal[044]

[XXX Registro tipo 2 - 39]
(PREREG) !(_aTotal[046]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 39
VLRLINHA   N 015 2 _aTotal[046]

[XXX Registro tipo 2 - 40]
(PREREG) !((_aTotal[036]+_aTotal[038]+_aTotal[040]+_aTotal[042]+_aTotal[044]+_aTotal[046])==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 40
VLRLINHA   N 015 2 _aTotal[036]+_aTotal[038]+_aTotal[040]+_aTotal[042]+_aTotal[044]+_aTotal[046]

[XXX Registro tipo 2 - 41]
(PREREG) !(_aTotal[037]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 41
VLRLINHA   N 015 2 _aTotal[037]

[XXX Registro tipo 2 - 43]
(PREREG) !(_aTotal[039]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 43
VLRLINHA   N 015 2 _aTotal[039]
                              
[XXX Registro tipo 2 - 44]
(PREREG) !(_aTotal[041]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 44
VLRLINHA   N 015 2 _aTotal[041]
                              
[XXX Registro tipo 2 - 45]
(PREREG) !(_aTotal[043]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 45
VLRLINHA   N 015 2 _aTotal[043]

[XXX Registro tipo 2 - 46]
(PREREG) !(_aTotal[045]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 46
VLRLINHA   N 015 2 _aTotal[045]

[XXX Registro tipo 2 - 49]
(PREREG) !(_aTotal[047]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 49
VLRLINHA   N 015 2 _aTotal[047]

[XXX Registro tipo 2 - 50]
(PREREG) !((_aTotal[037]+_aTotal[039]+_aTotal[041]+_aTotal[043]+_aTotal[045]+_aTotal[047])==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 50
VLRLINHA   N 015 2 _aTotal[037]+_aTotal[039]+_aTotal[041]+_aTotal[043]+_aTotal[045]+_aTotal[047]

[XXX Registro tipo 2 - 51]
(PREREG) !(_aTotal[051]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 51
VLRLINHA   N 015 2 _aTotal[051]

[XXX Registro tipo 2 - 52]
(PREREG) !(_aTotal[052]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 52
VLRLINHA   N 015 2 _aTotal[052]

[XXX Registro tipo 2 - 53]
(PREREG) !(_aTotal[053]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 53
VLRLINHA   N 015 2 _aTotal[053]

[XXX Registro tipo 2 - 54]
(PREREG) !(_aTotal[054]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 54
VLRLINHA   N 015 2 _aTotal[054]

[XXX Registro tipo 2 - 55]
(PREREG) !(_aTotal[055]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 55
VLRLINHA   N 015 2 _aTotal[055]

[XXX Registro tipo 2 - 56]
(PREREG) !(_aTotal[056]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 56
VLRLINHA   N 015 2 _aTotal[056]

[XXX Registro tipo 2 - 57]
(PREREG) !(_aTotal[057]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 57
VLRLINHA   N 015 2 _aTotal[057]

[XXX Registro tipo 2 - 58]
(PREREG) !(_aTotal[058]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 58
VLRLINHA   N 015 2 _aTotal[058]

[XXX Registro tipo 2 - 59]
(PREREG) !(_aTotal[059]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 59
VLRLINHA   N 015 2 _aTotal[059]

[XXX Registro tipo 2 - 60]
(PREREG) !(_aTotal[060]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 60
VLRLINHA   N 015 2 _aTotal[060]

[XXX Registro tipo 2 - 61]
(PREREG) !(_aTotal[061]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 61
VLRLINHA   N 015 2 _aTotal[061]

[XXX Registro tipo 2 - 62]
(PREREG) !(_aTotal[062]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 62
VLRLINHA   N 015 2 _aTotal[062]

[XXX Registro tipo 2 - 63]
(PREREG) !(_aTotal[063]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 63
VLRLINHA   N 015 2 _aTotal[063]

[XXX Registro tipo 2 - 64]
(PREREG) !(_aTotal[064]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 64
VLRLINHA   N 015 2 _aTotal[064]

[XXX Registro tipo 2 - 65]
(PREREG) !(_aTotal[065]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 65
VLRLINHA   N 015 2 _aTotal[065]

[XXX Registro tipo 2 - 66]
(PREREG) !(_aTotal[066]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 66
VLRLINHA   N 015 2 _aTotal[066]

[XXX Registro tipo 2 - 67]
(PREREG) !(_aTotal[067]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 67
VLRLINHA   N 015 2 _aTotal[067]

[XXX Registro tipo 2 - 68]
(PREREG) !(_aTotal[068]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 68
VLRLINHA   N 015 2 _aTotal[068]

[XXX Registro tipo 2 - 69]
(PREREG) !(_aTotal[069]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 69
VLRLINHA   N 015 2 _aTotal[069]

[XXX Registro tipo 2 - 70]
(PREREG) !(_aTotal[070]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 70
VLRLINHA   N 015 2 _aTotal[070]

[XXX Registro tipo 2 - 80]
(PREREG) !(_aTotal[080]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 80
VLRLINHA   N 015 2 _aTotal[080]

[XXX Registro tipo 2 - 90]
(PREREG) !(_aTotal[090]==0)
TIPO       N 001 0 2
IE         C 010 0 SUBS(ALLTRIM(SM0->M0_INSC),1,10)
AAAAMMREF  N 006 0 Val (Left (DToS (_aTotal[001]), 6))
TIPOGIA    N 002 0 Iif (MV_PAR01==1, 43, 51)
NUMLINHA   N 002 0 90
VLRLINHA   N 015 2 _aTotal[090]


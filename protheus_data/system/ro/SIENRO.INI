?{"Nome do Arquivo INI","SIENRO.INI"} 
?{"Conhecendo o SIEN","O Sistema de Entrada de Notas - SIEN foi desenvolvido de acordo com a Resolução  Conjunta nº 04/2002/CRE/SEFIN  de 16 de abril de 2002, que estabelece a obrigatoriedade de apresentação das Entradas de Produtos Primários e Declaração Anual de Rateio, por meio de formulário próprio."}
?{"Descrição Completa do Arquivo Magnético","Geração de Arquivo para SIEN - Sistema de Entrada de Notas Fiscais - RO"}
?{"A Quem se Destina","A todas as empresas que efetuarem compras/vendas de produtos primários de origem no território do Estado de Rondônia."}
?{"Objetivo","As empresas que efetuarem compras/vendas de produtos primários de origem no território do Estado de Rondônia, para fins de comercialização e/ou industrialização, ficam obrigadas a apresentar, anualmente, a Declaração de Entradas de Produtos Primários, por Municipio de Origem, utilizando-se do Sistema de Entrada de Notas - SIEN."}
?{"Prazo de Entrega","Anual, sempre referente ao exercício social imediatamente anterior ao da declaração."}
?{"Aplicativo Disponibilizado pelo Fisco","SIEN - Sistema de Entrada de Notas Fiscais"}
?{"Versão do Aplicativo Contemplada pela Microsiga","Versão 5.1.1.3"}
?{"Comentários","Para efetuar download do Programa SIEN, Acesse: http://www.sefin.ro.gov.br e vá em Downloads > Módulo do Contribuinte > e clique no último item desta seção em Módulo de Digitação de Notas."}

[XXX Inicializacao]      
(PRE) _aTotal[1] := 0
(PRE) _aTotal[2] := ""
(PRE) _aTotal[3] := ""
(PRE) _aTotal[4] := ""
(PRE) _aTotal[5] := MV_PAR01
(PRE) _aTotal[6] := MV_PAR02
(PRE) _aTotal[7] := ""
(PRE) _aTotal[8] := FWCodFil() 
(PRE) _aTotal[9] := AllTrim(SM0->M0_INSC)

(PRE) _aTotal[010] := {}
(PRE) _aTotal[011] := {}
(PRE) _aTotal[012] := {}

[XXX Painel]
(PRE) aAdd (_aTotal[010],"Geração de Arquivo magnético para SIEN")
(PRE) aAdd (_aTotal[010],"")
(PRE) aAdd (_aTotal[010], "Preencha corretamente as informações solicitadas.")
(PRE) aAdd (_aTotal[010], "Digite o ANO de exercício e o Código do Município SINAFE. Lembre-se que as NF devem ter sido criadas como NFP - Nota Fiscal de Produtor")

(PRE) aAdd (_aTotal[011], {})
(PRE) aAdd (_aTotal[011][1], "SIEN - Rondônia")
(PRE) aAdd (_aTotal[011][1], "Entre com as informações corretas")
(PRE) aAdd (_aTotal[011][1],{}) 

(PRE) aAdd (_aTotal[011][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[011][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[011][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[011][1][3], {0,"",,,,,,})
                                                     
(PRE) aAdd (_aTotal[011][1][3], {1,"Entre com o ANO do Exercício:",,,,,,})
(PRE) aAdd (_aTotal[011][1][3], {1,"Entre com o Código do Município SINAFE:",,,,,,})
(PRE) aAdd (_aTotal[011][1][3], {2,,"9999",1,,,,4})
(PRE) aAdd (_aTotal[011][1][3], {2,,"999999",1,,,,6})
(PRE) aAdd (_aTotal[011][1][3], {0,"",,,,,,})
(PRE) aAdd (_aTotal[011][1][3], {0,"",,,,,,})

(PRE) aAdd (_aTotal[011][1][3], {1,"Aglutina por CNPJ+I.E.?",,,,,,}) 
(PRE) aAdd (_aTotal[011][1][3], {3,,,1,,{"N=Não", "S=Sim"},,})

(PRE) xMagWizard(_aTotal[010],_aTotal[011],"SIENN")
(PRE) xMagLeWiz ("SIENN", @_aTotal[012], .T.)

(PRE) ApurSienRO()

[TMP Importação SIEN - RO]
(PRE) TMP->(dbGoTop())  

(PREREG) (_aTotal[4] := substr(AllTrim(str(TMP->F1_VALBRUT,14,2)),1,len(AllTrim(str(TMP->F1_VALBRUT,14,2)))-3) + substr(AllTrim(str(TMP->F1_VALBRUT,14,2)),len(AllTrim(str(TMP->F1_VALBRUT,14,2)))-1,2),.T.)
(PREREG) (_aTotal[7] := AModNot(TMP->F1_ESPECIE),.T.)

//NFs devem ser com espécie NFP - Nota Fiscal de Produtor ou da espécie SPED e Fornecedor Produtor Rural
(PREREG) AllTrim(_aTotal[7]) == "04" .Or. (AllTrim(_aTotal[7]) == "55" .And. !Empty(TMP->A2_TIPORUR))

SEQ01      C 014 0 replicate("0",14-len(Alltrim(_aTotal[9]))) + Alltrim(_aTotal[9])
SEQ02      C 004 0 _aTotal[012][1][1]
SEQ03      C 006 0 _aTotal[012][1][2]
SEQ04      C 010 0 replicate("0",10-len(Alltrim(TMP->F1_DOC))) + Alltrim(TMP->F1_DOC)
SEQ05      C 002 0 "NA"
SEQ06      C 001 0 "1"
SEQ07      C 008 0 DataInt(TMP->F1_EMISSAO)
SEQ08      C 015 0 replicate("0",15-len(_aTotal[4])) + _aTotal[4]
SEQ09      C 001 0 "1"
SEQ10      C 014 0 replicate("0",14-len(_aTotal[9])) + _aTotal[9]
SEQ11      C 002 0 "NA"
SEQ12      C 010 0 replicate("0",10-len(Alltrim(TMP->F1_DOC))) + Alltrim(TMP->F1_DOC)
SEQ13      C 008 0 DataInt(TMP->F1_EMISSAO)
SEQ14      C 015 0 replicate("0",15-len(_aTotal[4])) + _aTotal[4]
SEQ15      C 006 0 _aTotal[012][1][2]
(POS)
